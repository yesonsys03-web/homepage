{"version":3,"sources":["../src/registry/constants.ts","../src/registry/env.ts","../src/registry/errors.ts","../src/registry/parser.ts","../src/utils/frameworks.ts","../src/utils/highlighter.ts","../src/utils/resolve-import.ts","../src/utils/get-config.ts","../src/utils/get-package-info.ts","../src/utils/get-project-info.ts","../src/utils/compare.ts","../src/utils/env-helpers.ts","../src/utils/logger.ts","../src/utils/spinner.ts","../src/utils/transformers/transform-import.ts","../src/utils/transformers/transform-jsx.ts","../src/utils/transformers/transform-rsc.ts","../src/utils/transformers/transform-cleanup.ts","../src/utils/transformers/transform-tw-prefix.ts","../src/utils/transformers/index.ts","../src/utils/transformers/transform-aschild.ts","../src/utils/transformers/transform-next.ts","../src/utils/updaters/update-files.ts","../src/registry/utils.ts","../src/registry/config.ts","../src/registry/context.ts","../src/registry/validator.ts","../src/registry/builder.ts","../src/registry/fetcher.ts","../src/utils/updaters/update-tailwind-config.ts","../src/registry/resolver.ts","../src/utils/handle-error.ts","../src/registry/api.ts","../src/registry/search.ts"],"names":["REGISTRY_URL","FALLBACK_STYLE","BASE_COLORS","BUILTIN_REGISTRIES","DEPRECATED_COMPONENTS","expandEnvVars","value","_match","key","extractEnvVars","vars","regex","match","RegistryErrorCode","RegistryError","message","options","RegistryNotFoundError","url","cause","RegistryUnauthorizedError","RegistryForbiddenError","RegistryFetchError","statusCode","responseBody","baseMessage","suggestion","RegistryNotConfiguredError","registryName","RegistryLocalFileError","filePath","RegistryParseError","item","parseError","z","e","RegistryMissingEnvironmentVariablesError","missingVars","v","RegistryInvalidNamespaceError","name","ConfigParseError","cwd","RegistriesIndexParseError","invalidNamespaces","arr","REGISTRY_PATTERN","parseRegistryAndItemFromString","FRAMEWORKS","highlighter","red","yellow","cyan","green","resolveImport","importPath","config","createMatchPath","DEFAULT_COMPONENTS","DEFAULT_UTILS","DEFAULT_TAILWIND_CSS","DEFAULT_TAILWIND_CONFIG","explorer","cosmiconfig","getConfig","getRawConfig","resolveConfigPaths","tsConfig","loadConfig","configSchema","path","configResult","rawConfigSchema","error","componentPath","getWorkspaceConfig","resolvedAliases","isAliasKey","resolvedPath","packageRoot","findPackageRoot","result","workspaceConfigSchema","commonRoot","findCommonRoot","relativePath","matchingPackageRoot","fg","pkgPath","pkgDir","parts1","parts2","commonParts","getTargetStyleFromConfig","fallback","getProjectInfo","createConfig","partial","defaultConfig","getPackageInfo","shouldThrow","packageJsonPath","fs","PROJECT_SHARED_IGNORE","configFiles","isSrcDir","isTsx","tailwindConfigFile","tailwindCssFile","tailwindVersion","aliasPrefix","packageJson","isTypeScriptProject","getTailwindConfigFile","getTailwindCssFile","getTailwindVersion","getTsConfigAliasPrefix","isUsingAppDir","type","file","getFrameworkVersion","dep","appConfig","framework","version","versionMatch","rangeMatch","packageInfo","files","contents","alias","paths","getProjectConfig","defaultProjectInfo","existingConfig","projectInfo","getProjectTailwindVersionFromConfig","isContentSame","existingContent","newContent","ignoreImports","normalizedExisting","normalizedNew","importRegex","normalizeImports","content","prefix","suffix","parts","lastPart","existingNormalized","newNormalized","isEnvFile","fileName","findExistingEnvFile","targetDir","variants","variant","existsSync","parseEnvContent","lines","env","line","trimmed","equalIndex","getNewEnvKeys","existingEnv","newEnv","newKeys","mergeEnvContent","logger","args","spinner","text","ora","transformImport","sourceFile","isRemote","utilsAlias","utilsImport","specifier","updated","updateImportAliases","SyntaxKind","namedImport","moduleSpecifier","PARSE_OPTIONS","transformJsx","output","ast","code","parse","transformFromAstSync","transformTypescript","directiveRegex","transformRsc","first","CN_MARKER_REGEX","CN_MARKER_REGEX_GLOBAL","stripCnMarkers","className","processStringLiteral","node","currentValue","newValue","processStringLiterals","stringLit","templateLit","applyCleanup","attributesToRemove","attr","attrName","initializer","call","arg","transformCleanup","transformTwPrefixes","defaultClassNames","applyPrefix","classNames","callExpression","input","modifier","splitClassName","project","Project","createTempSourceFile","filename","dir","tmpdir","transform","opts","transformers","transformCssVars","transformRtl","transformIcons","tempFile","ScriptKind","transformer","ELEMENTS_REQUIRING_NATIVE_BUTTON_FALSE","transformAsChild","MAX_ITERATIONS","i","asChildElements","el","leafElements","d","transformations","jsxElement","openingElement","asChildAttr","parentTagName","childElement","child","childTagName","childProps","childChildren","selfClosing","jsxChild","openingEl","c","needsNativeButton","info","existingAttrs","renderValue","newAttrs","newChildren","newElementText","transformNext","func","variable","exportDecl","namedExport","updateFiles","filesCreatedSpinner","baseColor","getRegistryBaseColor","filesCreated","filesUpdated","filesSkipped","envVarsAdded","envFile","index","resolveFilePath","f","basename","alternativeEnvFile","existingFile","statSync","isUniversalItemFile","transformMenu","_isNext16Middleware","existingFileContent","overwrite","prompts","mergedContent","allFiles","updatedFiles","resolveImports","target","resolvePageTarget","resolveFileTargetDirectory","resolveNestedFilePath","needle","normalizedPaths","p","normalizedNeedle","needleDir","needleSegments","testPath","normalizedFilePath","normalizedTargetDir","fileSegments","targetSegments","lastTargetSegment","commonDirIndex","segment","filePaths","filepath","importDeclarations","importDeclaration","probableImportFilePath","resolvedImportFilePath","resolveModuleByProbablePath","newImport","toAliasedImport","extensions","relativeFiles","fileSet","extInPath","hasExt","absBase","relBase","tryExts","candidates","absCand","relCand","absIdx","relIdx","a","b","aExt","bExt","ord","aStrong","bStrong","abs","matches","root","aliasKey","rootDir","rel","ext","keepExt","noExt","aliasBase","isRootMiddleware","isNextJs","majorVersion","FILE_EXTENSIONS_FOR_LOOKUP","FILE_PATH_SKIP_LIST","DEPENDENCY_SKIP_LIST","getDependencyFromModuleSpecifier","pattern","recursivelyResolveFileImports","processedFiles","resolvedFilePath","P","relativeRegistryFilePath","fileExtension","dependencies","fileType","determineFileType","originalFile","importStatements","importStatement","isRelativeImport","dependency","pathWithExt","nestedRelativeRegistryFilePath","nestedResults","uniqueFiles","isUrl","isLocalFile","isUniversalRegistryItem","registryItem","deduplicateFilesByTarget","filesArrays","canDeduplicateFiles","registryItemFileSchema","targetMap","resolveStyleFromConfig","configWithDefaults","baseConfig","deepmerge","context","setRegistryHeaders","headers","getRegistryHeadersFromContext","clearRegistryContext","extractEnvVarsFromRegistryConfig","validateRegistryConfig","missing","validateRegistryConfigForItems","items","buildUrlAndHeadersForRegistryItem","NAME_PLACEHOLDER","STYLE_PLACEHOLDER","ENV_VAR_PATTERN","QUERY_PARAM_SEPARATOR","QUERY_PARAM_DELIMITER","isLocalPath","registry","registryConfig","buildUrlFromRegistryConfig","buildHeadersFromRegistryConfig","baseUrl","appendQueryParams","expandedValue","shouldIncludeHeader","params","urlParams","queryString","separator","originalValue","trimmedExpanded","templateWithoutVars","resolveRegistryUrl","pathOrUrl","agent","HttpsProxyAgent","registryCache","fetchRegistry","fetchPromise","response","fetch","messageFromServer","json","parsed","fetchRegistryLocal","expandedPath","homedir","registryItemSchema","updateTailwindConfig","tailwindConfig","tailwindFileRelativePath","tailwindSpinner","raw","transformTailwindConfig","_createSourceFile","configObject","property","quoteChar","_getQuoteChar","addTailwindConfigProperty","plugin","addTailwindConfigPlugin","addTailwindConfigTheme","existingProperty","newProperty","initializerText","element","theme","nestSpreadProperties","themeInitializer","themeObjectString","themeObject","parseObjectLiteral","dst","src","resultString","objectToString","unnestSpreadProperties","existingPlugins","QuoteKind","obj","properties","prop","spreadAssignment","spreadText","nestSpreadElements","elements","j","propAssignment","unsetSpreadElements","spreadTest","objectLiteralString","statement","parseObjectLiteralExpression","parseArrayLiteralExpression","parseValue","buildTailwindThemeColorsFromCssVars","cssVars","colorName","subType","resolveRegistryItemsFromRegistries","registryHeaders","resolvedItems","resolved","fetchRegistryItems","registryItemCommonSchema","registryItemTypeSchema","registryItemFontSchema","resolveRegistryTree","names","payload","allDependencyItems","allDependencyRegistryNames","uniqueNames","results","resultMap","sourceName","itemWithSource","resolvedDependencies","namespacedDeps","registryNames","resolveDependenciesRecursively","uniqueRegistryNames","nonNamespacedItems","namespacedDepItems","depResults","getShadcnRegistryIndex","registryUrls","itemDependencies","resolveRegistryDependencies","uniqueUrls","registryPayload","registryGetTheme","sourceMap","source","topologicalSortRegistryItems","tailwind","css","docs","envVars","deduplicatedFiles","fonts","registryResolvedItemsTreeSchema","visited","resolvedDeps","nested","style","urls","computeItemHash","identifier","hash","createHash","extractItemIdentifierFromDependency","pathname","itemMap","hashToItem","inDegree","adjacencyList","depToHashes","itemSource","itemHash","depHash","exactMatches","nameMatches","queue","sorted","degree","currentHash","dependentHash","newDegree","sortedHashes","handleError","getRegistry","useCache","registrySchema","urlAndHeaders","getRegistryItems","resolveRegistryItems","getRegistriesConfig","registriesConfig","registryConfigSchema","registryIndexSchema","getRegistryStyles","stylesSchema","getRegistryIcons","iconsSchema","getRegistryBaseColors","registryBaseColorSchema","resolveTree","tree","entry","component","self","fetchTree","getItemTargetPath","override","parent","getRegistries","data","registriesSchema","getRegistriesIndex","registries","getPresets","configJsonSchema","getPreset","preset","searchRegistries","query","limit","offset","allItems","itemsWithRegistry","buildRegistryItemNameFromRegistry","searchItems","paginationOffset","paginationLimit","totalItems","searchResultsSchema","searchableItemSchema","fuzzysort","string","protocolEnd","hostEnd","queryStart","beforeQuery","updatedQuery","hostPart","pathAndQuery","pathEnd","pathOnly","queryAndAfter","lastIndex","updatedPath"],"mappings":"q+BAGO,IAAMA,EAAAA,CACX,QAAQ,GAAA,CAAI,YAAA,EAAgB,yBAAA,CAEjBC,EAAAA,CAAiB,aAAA,CAEjBC,EAAAA,CAAc,CACzB,CACE,IAAA,CAAM,SAAA,CACN,KAAA,CAAO,SACT,CAAA,CACA,CACE,IAAA,CAAM,MAAA,CACN,KAAA,CAAO,MACT,CAAA,CACA,CACE,KAAM,MAAA,CACN,KAAA,CAAO,MACT,CAAA,CACA,CACE,IAAA,CAAM,QACN,KAAA,CAAO,OACT,CAAA,CACA,CACE,IAAA,CAAM,OAAA,CACN,MAAO,OACT,CACF,CAAA,CAGaC,CAAAA,CAA2D,CACtE,SAAA,CAAW,GAAGH,EAAY,CAAA,2BAAA,CAC5B,EA8HO,IAAMI,EAAAA,CAAwB,CACnC,CACE,IAAA,CAAM,OAAA,CACN,YAAA,CAAc,QAAA,CACd,OAAA,CACE,sEACJ,EACA,CACE,IAAA,CAAM,SAAA,CACN,YAAA,CAAc,QAAA,CACd,OAAA,CACE,wEACJ,CACF,EC7KO,SAASC,EAAAA,CAAcC,CAAAA,CAAe,CAC3C,OAAOA,CAAAA,CAAM,OAAA,CAAQ,YAAA,CAAc,CAACC,CAAAA,CAAQC,CAAAA,GAAQ,QAAQ,GAAA,CAAIA,CAAG,CAAA,EAAK,EAAE,CAC5E,CAEO,SAASC,EAAAA,CAAeH,CAAAA,CAAe,CAC5C,IAAMI,CAAAA,CAAiB,GACjBC,CAAAA,CAAQ,YAAA,CACVC,CAAAA,CAEJ,KAAA,CAAQA,CAAAA,CAAQD,CAAAA,CAAM,KAAKL,CAAK,CAAA,IAAO,IAAA,EACrCI,CAAAA,CAAK,IAAA,CAAKE,CAAAA,CAAM,CAAC,CAAC,CAAA,CAGpB,OAAOF,CACT,CCXO,IAAMG,CAAAA,CAAoB,CAG/B,SAAA,CAAW,WAAA,CACX,YAAA,CAAc,cAAA,CACd,SAAA,CAAW,WAAA,CACX,YAAa,aAAA,CAGb,cAAA,CAAgB,gBAAA,CAChB,cAAA,CAAgB,gBAAA,CAChB,gBAAA,CAAkB,mBAGlB,gBAAA,CAAkB,kBAAA,CAGlB,WAAA,CAAa,aAAA,CACb,gBAAA,CAAkB,kBAAA,CAGlB,cAAe,eACjB,CAAA,CAKaC,CAAAA,CAAN,cAA4B,KAAM,CACvB,KACA,UAAA,CACA,OAAA,CACA,UAAA,CACA,SAAA,CACA,KAAA,CAEhB,WAAA,CACEC,EACAC,CAAAA,CAMI,EAAC,CACL,CACA,KAAA,CAAMD,CAAO,EACb,IAAA,CAAK,IAAA,CAAO,eAAA,CACZ,IAAA,CAAK,IAAA,CAAOC,CAAAA,CAAQ,MAAQH,CAAAA,CAAkB,aAAA,CAC9C,IAAA,CAAK,UAAA,CAAaG,CAAAA,CAAQ,UAAA,CAC1B,KAAK,KAAA,CAAQA,CAAAA,CAAQ,KAAA,CACrB,IAAA,CAAK,OAAA,CAAUA,CAAAA,CAAQ,QACvB,IAAA,CAAK,UAAA,CAAaA,CAAAA,CAAQ,UAAA,CAC1B,IAAA,CAAK,SAAA,CAAY,IAAI,IAAA,CAEjB,KAAA,CAAM,iBAAA,EACR,KAAA,CAAM,iBAAA,CAAkB,IAAA,CAAM,KAAK,WAAW,EAElD,CAEA,MAAA,EAAS,CACP,OAAO,CACL,IAAA,CAAM,IAAA,CAAK,IAAA,CACX,OAAA,CAAS,IAAA,CAAK,OAAA,CACd,KAAM,IAAA,CAAK,IAAA,CACX,UAAA,CAAY,IAAA,CAAK,UAAA,CACjB,OAAA,CAAS,KAAK,OAAA,CACd,UAAA,CAAY,KAAK,UAAA,CACjB,SAAA,CAAW,KAAK,SAAA,CAChB,KAAA,CAAO,IAAA,CAAK,KACd,CACF,CACF,EAEaC,CAAAA,CAAN,cAAoCH,CAAc,CACvD,WAAA,CAA4BI,CAAAA,CAAaC,EAAiB,CACxD,IAAMJ,CAAAA,CAAU,CAAA,YAAA,EAAeG,CAAG,CAAA,iDAAA,CAAA,CAElC,MAAMH,CAAAA,CAAS,CACb,IAAA,CAAMF,CAAAA,CAAkB,SAAA,CACxB,UAAA,CAAY,IACZ,KAAA,CAAAM,CAAAA,CACA,OAAA,CAAS,CAAE,GAAA,CAAAD,CAAI,EACf,UAAA,CACE,uEACJ,CAAC,CAAA,CAVyB,IAAA,CAAA,GAAA,CAAAA,CAAAA,CAW1B,KAAK,IAAA,CAAO,wBACd,CACF,CAAA,CAEaE,EAAAA,CAAN,cAAwCN,CAAc,CAC3D,WAAA,CAA4BI,CAAAA,CAAaC,CAAAA,CAAiB,CACxD,IAAMJ,EAAU,CAAA,6CAAA,EAAgDG,CAAG,CAAA,6DAAA,CAAA,CAEnE,KAAA,CAAMH,CAAAA,CAAS,CACb,KAAMF,CAAAA,CAAkB,YAAA,CACxB,UAAA,CAAY,GAAA,CACZ,KAAA,CAAAM,CAAAA,CACA,QAAS,CAAE,GAAA,CAAAD,CAAI,CAAA,CACf,UAAA,CACE,kEACJ,CAAC,CAAA,CAVyB,IAAA,CAAA,GAAA,CAAAA,CAAAA,CAW1B,IAAA,CAAK,IAAA,CAAO,4BACd,CACF,CAAA,CAEaG,EAAAA,CAAN,cAAqCP,CAAc,CACxD,WAAA,CAA4BI,EAAaC,CAAAA,CAAiB,CACxD,IAAMJ,CAAAA,CAAU,CAAA,6CAAA,EAAgDG,CAAG,gEAEnE,KAAA,CAAMH,CAAAA,CAAS,CACb,IAAA,CAAMF,CAAAA,CAAkB,SAAA,CACxB,WAAY,GAAA,CACZ,KAAA,CAAAM,CAAAA,CACA,OAAA,CAAS,CAAE,GAAA,CAAAD,CAAI,CAAA,CACf,UAAA,CACE,kEACJ,CAAC,CAAA,CAVyB,IAAA,CAAA,GAAA,CAAAA,EAW1B,IAAA,CAAK,IAAA,CAAO,yBACd,CACF,CAAA,CAEaI,EAAAA,CAAN,cAAiCR,CAAc,CACpD,WAAA,CACkBI,CAAAA,CAChBK,CAAAA,CACgBC,CAAAA,CAChBL,EACA,CAEA,IAAMM,CAAAA,CAAcF,CAAAA,CAChB,CAAA,+BAAA,EAAkCA,CAAU,MAAML,CAAG,CAAA,CAAA,CACrD,CAAA,+BAAA,EAAkCA,CAAG,CAAA,CAAA,CAEnCH,CAAAA,CACJ,OAAOI,CAAAA,EAAU,QAAA,EAAYA,CAAAA,CACzB,CAAA,EAAGM,CAAW,CAAA,GAAA,EAAMN,CAAK,CAAA,CAAA,CACzBM,CAAAA,CAEFC,CAAAA,CAAa,8CAAA,CACbH,CAAAA,GAAe,GAAA,CACjBG,EACE,mEAAA,CACOH,CAAAA,GAAe,GAAA,CACxBG,CAAAA,CAAa,4DAAA,CACJH,CAAAA,EAAcA,GAAc,GAAA,EAAOA,CAAAA,CAAa,GAAA,GACzDG,CAAAA,CAAa,0DAAA,CAAA,CAGf,KAAA,CAAMX,EAAS,CACb,IAAA,CAAMF,CAAAA,CAAkB,WAAA,CACxB,UAAA,CAAAU,CAAAA,CACA,MAAAJ,CAAAA,CACA,OAAA,CAAS,CAAE,GAAA,CAAAD,CAAAA,CAAK,YAAA,CAAAM,CAAa,CAAA,CAC7B,UAAA,CAAAE,CACF,CAAC,CAAA,CA/Be,IAAA,CAAA,GAAA,CAAAR,EAEA,IAAA,CAAA,YAAA,CAAAM,CAAAA,CA8BhB,IAAA,CAAK,IAAA,CAAO,qBACd,CACF,EAEaG,CAAAA,CAAN,cAAyCb,CAAc,CAC5D,WAAA,CAA4Bc,CAAAA,CAA6B,CACvD,IAAMb,CAAAA,CAAUa,CAAAA,CACZ,CAAA,kBAAA,EAAqBA,CAAY,CAAA;AAAA;AAAA;AAAA,KAAA,EAGlCA,CAAY,CAAA;AAAA;AAAA,CAAA,CAAA,CAGX,kFAAA,CAEJ,KAAA,CAAMb,CAAAA,CAAS,CACb,KAAMF,CAAAA,CAAkB,cAAA,CACxB,OAAA,CAAS,CAAE,aAAAe,CAAa,CAAA,CACxB,UAAA,CACE,yHACJ,CAAC,CAAA,CAfyB,IAAA,CAAA,YAAA,CAAAA,CAAAA,CAgB1B,IAAA,CAAK,KAAO,6BACd,CACF,CAAA,CAEaC,EAAAA,CAAN,cAAqCf,CAAc,CACxD,WAAA,CAA4BgB,CAAAA,CAAkBX,EAAiB,CAC7D,KAAA,CAAM,CAAA,oCAAA,EAAuCW,CAAQ,GAAI,CACvD,IAAA,CAAMjB,CAAAA,CAAkB,gBAAA,CACxB,MAAAM,CAAAA,CACA,OAAA,CAAS,CAAE,QAAA,CAAAW,CAAS,CAAA,CACpB,UAAA,CAAY,yDACd,CAAC,EANyB,IAAA,CAAA,QAAA,CAAAA,CAAAA,CAO1B,IAAA,CAAK,IAAA,CAAO,yBACd,CACF,CAAA,CAEaC,CAAAA,CAAN,cAAiCjB,CAAc,CAGpD,WAAA,CAA4BkB,CAAAA,CAAcC,CAAAA,CAAqB,CAC7D,IAAIlB,CAAAA,CAAU,CAAA,+BAAA,EAAkCiB,CAAI,GAEhDC,CAAAA,YAAsBC,CAAAA,CAAE,QAAA,GAC1BnB,CAAAA,CAAU,kCAAkCiB,CAAI;AAAA,EAAKC,CAAAA,CAAW,MAAA,CAC7D,GAAA,CAAKE,CAAAA,EAAM,OAAOA,CAAAA,CAAE,IAAA,CAAK,IAAA,CAAK,GAAG,CAAC,CAAA,EAAA,EAAKA,CAAAA,CAAE,OAAO,CAAA,CAAE,EAClD,IAAA,CAAK;AAAA,CAAI,CAAC,CAAA,CAAA,CAAA,CAGf,KAAA,CAAMpB,EAAS,CACb,IAAA,CAAMF,EAAkB,WAAA,CACxB,KAAA,CAAOoB,CAAAA,CACP,OAAA,CAAS,CAAE,IAAA,CAAAD,CAAK,EAChB,UAAA,CACE,qKACJ,CAAC,CAAA,CAfyB,IAAA,CAAA,IAAA,CAAAA,CAAAA,CAiB1B,IAAA,CAAK,WAAaC,CAAAA,CAClB,IAAA,CAAK,KAAO,qBACd,CArBgB,UAsBlB,CAAA,CAEaG,EAAAA,CAAN,cAAuDtB,CAAc,CAC1E,YACkBc,CAAAA,CACAS,CAAAA,CAChB,CACA,IAAMtB,CAAAA,CACJ,aAAaa,CAAY,CAAA;;AAAA,CAAA,CACzBS,EAAY,GAAA,CAAKC,CAAAA,EAAM,YAAOA,CAAC,CAAA,CAAE,EAAE,IAAA,CAAK;AAAA,CAAI,EAE9C,KAAA,CAAMvB,CAAAA,CAAS,CACb,IAAA,CAAMF,EAAkB,gBAAA,CACxB,OAAA,CAAS,CAAE,YAAA,CAAAe,EAAc,WAAA,CAAAS,CAAY,EACrC,UAAA,CACE,yEACJ,CAAC,CAAA,CAZe,IAAA,CAAA,YAAA,CAAAT,CAAAA,CACA,IAAA,CAAA,WAAA,CAAAS,EAYhB,IAAA,CAAK,IAAA,CAAO,2CACd,CACF,EAEaE,EAAAA,CAAN,cAA4CzB,CAAc,CAC/D,YAA4B0B,CAAAA,CAAc,CACxC,IAAMzB,CAAAA,CAAU,CAAA,6BAAA,EAAgCyB,CAAI,CAAA,yDAAA,CAAA,CAEpD,KAAA,CAAMzB,CAAAA,CAAS,CACb,KAAMF,CAAAA,CAAkB,gBAAA,CACxB,OAAA,CAAS,CAAE,KAAA2B,CAAK,CAAA,CAChB,UAAA,CACE,oFACJ,CAAC,CAAA,CARyB,IAAA,CAAA,IAAA,CAAAA,EAS1B,IAAA,CAAK,IAAA,CAAO,gCACd,CACF,EAgBO,IAAMC,EAAAA,CAAN,cAA+B3B,CAAc,CAClD,WAAA,CAA4B4B,CAAAA,CAAaT,EAAqB,CAC5D,IAAIlB,CAAAA,CAAU,CAAA,yCAAA,EAA4C2B,CAAG,CAAA,CAAA,CAAA,CAEzDT,CAAAA,YAAsBC,EAAE,QAAA,GAC1BnB,CAAAA,CAAU,4CAA4C2B,CAAG,CAAA;AAAA,EAAMT,CAAAA,CAAW,MAAA,CACvE,GAAA,CAAKE,CAAAA,EAAM,OAAOA,CAAAA,CAAE,IAAA,CAAK,IAAA,CAAK,GAAG,CAAC,CAAA,EAAA,EAAKA,CAAAA,CAAE,OAAO,CAAA,CAAE,EAClD,IAAA,CAAK;AAAA,CAAI,CAAC,CAAA,CAAA,CAAA,CAGf,KAAA,CAAMpB,CAAAA,CAAS,CACb,KAAMF,CAAAA,CAAkB,cAAA,CACxB,KAAA,CAAOoB,CAAAA,CACP,QAAS,CAAE,GAAA,CAAAS,CAAI,CAAA,CACf,UAAA,CACE,+IACJ,CAAC,CAAA,CAfyB,IAAA,CAAA,GAAA,CAAAA,CAAAA,CAgB1B,KAAK,IAAA,CAAO,mBACd,CACF,CAAA,CAEaC,GAAN,cAAwC7B,CAAc,CAC3C,UAAA,CAEhB,YAAYmB,CAAAA,CAAqB,CAC/B,IAAIlB,CAAAA,CAAU,kCAAA,CAEd,GAAIkB,CAAAA,YAAsBC,CAAAA,CAAE,QAAA,CAAU,CACpC,IAAMU,CAAAA,CAAoBX,CAAAA,CAAW,MAAA,CAClC,MAAA,CAAQE,GAAMA,CAAAA,CAAE,IAAA,CAAK,MAAA,CAAS,CAAC,EAC/B,GAAA,CAAKA,CAAAA,EAAM,IAAIA,CAAAA,CAAE,IAAA,CAAK,CAAC,CAAC,CAAA,CAAA,CAAG,CAAA,CAC3B,MAAA,CAAO,CAACG,CAAAA,CAAG,CAAA,CAAGO,IAAQA,CAAAA,CAAI,OAAA,CAAQP,CAAC,CAAA,GAAM,CAAC,CAAA,CAEzCM,CAAAA,CAAkB,OAAS,CAAA,CAC7B7B,CAAAA,CAAU,oEAAoE6B,CAAAA,CAAkB,IAAA,CAC9F,IACF,CAAC;AAAA,EAAKX,CAAAA,CAAW,MAAA,CACd,GAAA,CAAKE,CAAAA,EAAM,OAAOA,CAAAA,CAAE,IAAA,CAAK,IAAA,CAAK,GAAG,CAAC,CAAA,EAAA,EAAKA,CAAAA,CAAE,OAAO,CAAA,CAAE,EAClD,IAAA,CAAK;AAAA,CAAI,CAAC,GAEbpB,CAAAA,CAAU,CAAA;AAAA,EAAsCkB,CAAAA,CAAW,MAAA,CACxD,GAAA,CAAKE,CAAAA,EAAM,OAAOA,CAAAA,CAAE,IAAA,CAAK,IAAA,CAAK,GAAG,CAAC,CAAA,EAAA,EAAKA,CAAAA,CAAE,OAAO,CAAA,CAAE,EAClD,IAAA,CAAK;AAAA,CAAI,CAAC,GAEjB,CAEA,KAAA,CAAMpB,EAAS,CACb,IAAA,CAAMF,CAAAA,CAAkB,WAAA,CACxB,KAAA,CAAOoB,CAAAA,CACP,QAAS,CAAE,UAAA,CAAAA,CAAW,CAAA,CACtB,UAAA,CACE,8IACJ,CAAC,CAAA,CAED,IAAA,CAAK,UAAA,CAAaA,CAAAA,CAClB,IAAA,CAAK,IAAA,CAAO,4BACd,CACF,ECnUA,IAAMa,EAAAA,CAAmB,sDAAA,CAElB,SAASC,GAA+BP,CAAAA,CAAc,CAC3D,GAAI,CAACA,CAAAA,CAAK,UAAA,CAAW,GAAG,CAAA,CACtB,OAAO,CACL,QAAA,CAAU,IAAA,CACV,IAAA,CAAMA,CACR,CAAA,CAGF,IAAM5B,CAAAA,CAAQ4B,CAAAA,CAAK,KAAA,CAAMM,EAAgB,EACzC,OAAIlC,CAAAA,CACK,CACL,QAAA,CAAUA,CAAAA,CAAM,CAAC,EACjB,IAAA,CAAMA,CAAAA,CAAM,CAAC,CACf,CAAA,CAGK,CACL,SAAU,IAAA,CACV,IAAA,CAAM4B,CACR,CACF,CCvBO,IAAMQ,CAAAA,CAAa,CACxB,UAAA,CAAY,CACV,IAAA,CAAM,UAAA,CACN,KAAA,CAAO,SAAA,CACP,MAAO,CACL,YAAA,CAAc,8CAAA,CACd,QAAA,CAAU,4CACZ,CACF,EACA,YAAA,CAAc,CACZ,IAAA,CAAM,YAAA,CACN,KAAA,CAAO,SAAA,CACP,MAAO,CACL,YAAA,CAAc,8CAAA,CACd,QAAA,CAAU,4CACZ,CACF,EACA,KAAA,CAAO,CACL,IAAA,CAAM,OAAA,CACN,KAAA,CAAO,OAAA,CACP,MAAO,CACL,YAAA,CAAc,+CAAA,CACd,QAAA,CAAU,2CACZ,CACF,EACA,cAAA,CAAgB,CACd,IAAA,CAAM,cAAA,CACN,KAAA,CAAO,cAAA,CACP,MAAO,CACL,YAAA,CAAc,sDAAA,CACd,QAAA,CACE,yEACJ,CACF,EACA,IAAA,CAAM,CACJ,IAAA,CAAM,MAAA,CACN,KAAA,CAAO,MAAA,CACP,MAAO,CACL,YAAA,CAAc,8CAAA,CACd,QAAA,CAAU,0CACZ,CACF,EACA,KAAA,CAAO,CACL,IAAA,CAAM,OAAA,CACN,KAAA,CAAO,OAAA,CACP,MAAO,CACL,YAAA,CAAc,+CAAA,CACd,QAAA,CAAU,2CACZ,CACF,EACA,OAAA,CAAS,CACP,IAAA,CAAM,SAAA,CACN,KAAA,CAAO,SAAA,CACP,MAAO,CACL,YAAA,CAAc,iDAAA,CACd,QAAA,CAAU,6CACZ,CACF,EACA,gBAAA,CAAkB,CAChB,IAAA,CAAM,gBAAA,CACN,KAAA,CAAO,gBAAA,CACP,MAAO,CACL,YAAA,CAAc,kDAAA,CACd,QAAA,CAAU,yDACZ,CACF,EACA,MAAA,CAAQ,CACN,IAAA,CAAM,QAAA,CACN,KAAA,CAAO,QAAA,CACP,MAAO,CACL,YAAA,CAAc,gDAAA,CACd,QAAA,CAAU,4CACZ,CACF,EACA,IAAA,CAAM,CACJ,IAAA,CAAM,MAAA,CACN,KAAA,CAAO,MAAA,CACP,MAAO,CACL,YAAA,CAAc,+CACd,QAAA,CAAU,8DACZ,CACF,CAAA,CACA,MAAA,CAAQ,CACN,IAAA,CAAM,QAAA,CACN,KAAA,CAAO,SACP,KAAA,CAAO,CACL,YAAA,CAAc,gDAAA,CACd,QAAA,CAAU,2CACZ,CACF,CACF,CAAA,CCxFO,IAAMC,CAAAA,CAAc,CACzB,KAAA,CAAOC,GAAAA,CACP,KAAMC,MAAAA,CACN,IAAA,CAAMC,IAAAA,CACN,OAAA,CAASC,KACX,ECLA,eAAsBC,CAAAA,CACpBC,CAAAA,CACAC,EACA,CACA,OAAOC,eAAAA,CAAgBD,CAAAA,CAAO,eAAA,CAAiBA,CAAAA,CAAO,KAAK,CAAA,CACzDD,CAAAA,CACA,MAAA,CACA,IAAM,IAAA,CACN,CAAC,MAAO,MAAA,CAAQ,MAAA,CAAQ,KAAA,CAAO,MAAM,CACvC,CACF,CCIO,IAAMG,EAAAA,CAAqB,eACrBC,EAAAA,CAAgB,aAAA,CAChBC,EAAAA,CAAuB,iBAAA,CACvBC,EAAAA,CAA0B,qBAKhC,IAAMC,EAAAA,CAAWC,WAAAA,CAAY,YAAA,CAAc,CAChD,YAAA,CAAc,CAAC,iBAAiB,CAClC,CAAC,CAAA,CAID,eAAsBC,EAAAA,CAAUtB,CAAAA,CAAa,CAC3C,IAAMc,CAAAA,CAAS,MAAMS,EAAAA,CAAavB,CAAG,CAAA,CAErC,OAAKc,CAAAA,EAKAA,CAAAA,CAAO,WAAA,GACVA,CAAAA,CAAO,WAAA,CAAcA,CAAAA,CAAO,QAAU,UAAA,CAAa,OAAA,CAAU,QAAA,CAAA,CAGxD,MAAMU,EAAAA,CAAmBxB,CAAAA,CAAKc,CAAM,CAAA,EARlC,IASX,CAEA,eAAsBU,EAAAA,CACpBxB,CAAAA,CACAc,EACA,CAEAA,CAAAA,CAAO,UAAA,CAAa,CAClB,GAAGrD,CAAAA,CACH,GAAIqD,CAAAA,CAAO,UAAA,EAAc,EAC3B,CAAA,CAGA,IAAMW,EAAW,MAAMC,UAAAA,CAAW1B,CAAG,CAAA,CAErC,GAAIyB,CAAAA,CAAS,aAAe,QAAA,CAC1B,MAAM,IAAI,KAAA,CACR,CAAA,eAAA,EAAkBX,CAAAA,CAAO,IAAM,UAAA,CAAa,UAAU,CAAA,OAAA,EACpDW,CAAAA,CAAS,OAAA,EAAW,EACtB,GAAG,IAAA,EACL,CAAA,CAGF,OAAOE,GAAAA,CAAa,KAAA,CAAM,CACxB,GAAGb,CAAAA,CACH,aAAA,CAAe,CACb,GAAA,CAAAd,CAAAA,CACA,eAAgBc,CAAAA,CAAO,QAAA,CAAS,MAAA,CAC5Bc,UAAAA,CAAK,OAAA,CAAQ5B,CAAAA,CAAKc,EAAO,QAAA,CAAS,MAAM,CAAA,CACxC,EAAA,CACJ,WAAA,CAAac,UAAAA,CAAK,QAAQ5B,CAAAA,CAAKc,CAAAA,CAAO,QAAA,CAAS,GAAG,CAAA,CAClD,KAAA,CAAO,MAAMF,CAAAA,CAAcE,CAAAA,CAAO,OAAA,CAAQ,KAAA,CAAUW,CAAQ,CAAA,CAC5D,WAAY,MAAMb,CAAAA,CAAcE,CAAAA,CAAO,OAAA,CAAQ,UAAA,CAAeW,CAAQ,EACtE,EAAA,CAAIX,CAAAA,CAAO,QAAQ,EAAA,CACf,MAAMF,EAAcE,CAAAA,CAAO,OAAA,CAAQ,EAAA,CAAOW,CAAQ,CAAA,CAClDG,UAAAA,CAAK,QACF,MAAMhB,CAAAA,CAAcE,CAAAA,CAAO,OAAA,CAAQ,UAAA,CAAeW,CAAQ,GACzDzB,CAAAA,CACF,IACF,CAAA,CAGJ,GAAA,CAAKc,CAAAA,CAAO,OAAA,CAAQ,IAChB,MAAMF,CAAAA,CAAcE,CAAAA,CAAO,OAAA,CAAQ,GAAA,CAAQW,CAAQ,EACnDG,UAAAA,CAAK,OAAA,CACF,MAAMhB,CAAAA,CAAcE,CAAAA,CAAO,OAAA,CAAQ,MAAUW,CAAQ,CAAA,EAAMzB,CAAAA,CAC5D,IACF,CAAA,CACJ,KAAA,CAAOc,EAAO,OAAA,CAAQ,KAAA,CAClB,MAAMF,CAAAA,CAAcE,CAAAA,CAAO,OAAA,CAAQ,MAAUW,CAAQ,CAAA,CACrDG,UAAAA,CAAK,OAAA,CACF,MAAMhB,CAAAA,CAAcE,EAAO,OAAA,CAAQ,UAAA,CAAeW,CAAQ,CAAA,EACzDzB,CAAAA,CACF,IAAA,CACA,OACF,CACN,CACF,CAAC,CACH,CAEA,eAAsBuB,GACpBvB,CAAAA,CACiD,CACjD,GAAI,CACF,IAAM6B,CAAAA,CAAe,MAAMT,EAAAA,CAAS,MAAA,CAAOpB,CAAG,CAAA,CAE9C,GAAI,CAAC6B,EACH,OAAO,IAAA,CAGT,IAAMf,CAAAA,CAASgB,GAAAA,CAAgB,KAAA,CAAMD,EAAa,MAAM,CAAA,CAGxD,GAAIf,CAAAA,CAAO,UAAA,CAAA,CACT,IAAA,IAAW5B,KAAgB,MAAA,CAAO,IAAA,CAAK4B,CAAAA,CAAO,UAAU,CAAA,CACtD,GAAI5B,KAAgBzB,CAAAA,CAClB,MAAM,IAAI,KAAA,CACR,CAAA,CAAA,EAAIyB,CAAY,oDAClB,CAAA,CAKN,OAAO4B,CACT,CAAA,MAASiB,CAAAA,CAAO,CACd,IAAMC,CAAAA,CAAgB,CAAA,EAAGhC,CAAG,CAAA,gBAAA,CAAA,CAC5B,MAAI+B,CAAAA,YAAiB,OAASA,CAAAA,CAAM,OAAA,CAAQ,QAAA,CAAS,mBAAmB,CAAA,CAChEA,CAAAA,CAEF,IAAI,KAAA,CACR,CAAA,+BAAA,EAAkCxB,CAAAA,CAAY,IAAA,CAAKyB,CAAa,CAAC,GACnE,CACF,CACF,CAKA,eAAsBC,EAAAA,CAAmBnB,GAAAA,CAAgB,CACvD,IAAIoB,CAAAA,CAAuB,EAAC,CAE5B,IAAA,IAAWpE,CAAAA,IAAO,OAAO,IAAA,CAAKgD,GAAAA,CAAO,OAAO,CAAA,CAAG,CAC7C,GAAI,CAACqB,EAAAA,CAAWrE,CAAAA,CAAKgD,GAAM,CAAA,CACzB,SAGF,IAAMsB,EAAetB,GAAAA,CAAO,aAAA,CAAchD,CAAG,CAAA,CACvCuE,CAAAA,CAAc,MAAMC,GACxBxB,GAAAA,CAAO,aAAA,CAAc,GAAA,CACrBsB,CACF,CAAA,CAEA,GAAI,CAACC,CAAAA,CAAa,CAChBH,CAAAA,CAAgBpE,CAAG,CAAA,CAAIgD,GAAAA,CACvB,QACF,CAEAoB,CAAAA,CAAgBpE,CAAG,CAAA,CAAI,MAAMwD,EAAAA,CAAUe,CAAW,EACpD,CAEA,IAAME,CAAAA,CAASC,CAAAA,CAAsB,SAAA,CAAUN,CAAe,CAAA,CAC9D,OAAKK,CAAAA,CAAO,OAAA,CAILA,CAAAA,CAAO,IAAA,CAHL,IAIX,CAEA,eAAsBD,EAAAA,CAAgBtC,CAAAA,CAAaoC,CAAAA,CAAsB,CACvE,IAAMK,CAAAA,CAAaC,EAAAA,CAAe1C,CAAAA,CAAKoC,CAAY,CAAA,CAC7CO,CAAAA,CAAef,WAAK,QAAA,CAASa,CAAAA,CAAYL,CAAY,CAAA,CAQrDQ,CAAAA,CAAAA,CANe,MAAMC,GAAG,IAAA,CAAK,iBAAA,CAAmB,CACpD,GAAA,CAAKJ,CAAAA,CACL,IAAA,CAAM,EACN,MAAA,CAAQ,CAAC,oBAAA,CAAsB,YAAA,CAAc,aAAA,CAAe,cAAc,CAC5E,CAAC,CAAA,EAGE,GAAA,CAAKK,CAAAA,EAAYlB,UAAAA,CAAK,OAAA,CAAQkB,CAAO,CAAC,CAAA,CACtC,IAAA,CAAMC,CAAAA,EAAWJ,CAAAA,CAAa,UAAA,CAAWI,CAAM,CAAC,CAAA,CAEnD,OAAOH,CAAAA,CAAsBhB,UAAAA,CAAK,IAAA,CAAKa,EAAYG,CAAmB,CAAA,CAAI,IAC5E,CAEA,SAAST,EAAAA,CACPrE,EACAgD,CAAAA,CACgC,CAChC,OAAO,MAAA,CAAO,IAAA,CAAKA,CAAAA,CAAO,aAAa,CAAA,CACpC,MAAA,CAAQhD,CAAAA,EAAQA,CAAAA,GAAQ,OAAO,CAAA,CAC/B,SAASA,CAAG,CACjB,CAEO,SAAS4E,EAAAA,CAAe1C,CAAAA,CAAaoC,EAAsB,CAChE,IAAMY,CAAAA,CAAShD,CAAAA,CAAI,KAAA,CAAM4B,UAAAA,CAAK,GAAG,CAAA,CAC3BqB,CAAAA,CAASb,CAAAA,CAAa,KAAA,CAAMR,UAAAA,CAAK,GAAG,EACpCsB,CAAAA,CAAc,EAAC,CAErB,IAAA,IAAS,CAAA,CAAI,CAAA,CAAG,EAAI,IAAA,CAAK,GAAA,CAAIF,CAAAA,CAAO,MAAA,CAAQC,CAAAA,CAAO,MAAM,GACnDD,CAAAA,CAAO,CAAC,CAAA,GAAMC,CAAAA,CAAO,CAAC,CAAA,CADgC,IAI1DC,CAAAA,CAAY,IAAA,CAAKF,CAAAA,CAAO,CAAC,CAAC,CAAA,CAG5B,OAAOE,CAAAA,CAAY,IAAA,CAAKtB,UAAAA,CAAK,GAAG,CAClC,CAGA,eAAsBuB,EAAAA,CAAyBnD,CAAAA,CAAaoD,CAAAA,CAAkB,CAE5E,OAAA,CADoB,MAAMC,EAAerD,CAAG,CAAA,GACxB,eAAA,GAAoB,IAAA,CAAO,aAAA,CAAgBoD,CACjE,CAaO,SAASE,EAAAA,CAAaC,CAAAA,CAAuC,CAClE,IAAMC,CAAAA,CAAwB,CAC5B,aAAA,CAAe,CACb,GAAA,CAAK,OAAA,CAAQ,GAAA,EAAI,CACjB,eAAgB,EAAA,CAChB,WAAA,CAAa,EAAA,CACb,KAAA,CAAO,EAAA,CACP,UAAA,CAAY,GACZ,EAAA,CAAI,EAAA,CACJ,GAAA,CAAK,EAAA,CACL,KAAA,CAAO,EACT,EACA,KAAA,CAAO,EAAA,CACP,QAAA,CAAU,CACR,MAAA,CAAQ,EAAA,CACR,IAAK,EAAA,CACL,SAAA,CAAW,EAAA,CACX,YAAA,CAAc,KAChB,CAAA,CACA,IAAK,KAAA,CACL,GAAA,CAAK,IAAA,CACL,OAAA,CAAS,CACP,UAAA,CAAY,GACZ,KAAA,CAAO,EACT,CAAA,CACA,UAAA,CAAY,CACV,GAAG/F,CACL,CACF,CAAA,CAGA,OAAI8F,CAAAA,CACK,CACL,GAAGC,EACH,GAAGD,CAAAA,CACH,aAAA,CAAe,CACb,GAAGC,CAAAA,CAAc,cACjB,GAAID,CAAAA,CAAQ,aAAA,EAAiB,EAC/B,CAAA,CACA,SAAU,CACR,GAAGC,CAAAA,CAAc,QAAA,CACjB,GAAID,CAAAA,CAAQ,UAAY,EAC1B,EACA,OAAA,CAAS,CACP,GAAGC,CAAAA,CAAc,OAAA,CACjB,GAAID,CAAAA,CAAQ,OAAA,EAAW,EACzB,CAAA,CACA,UAAA,CAAY,CACV,GAAGC,CAAAA,CAAc,UAAA,CACjB,GAAID,CAAAA,CAAQ,UAAA,EAAc,EAC5B,CACF,CAAA,CAGKC,CACT,CCxRO,SAASC,EAAAA,CACdzD,CAAAA,CAAc,EAAA,CACd0D,CAAAA,CAAuB,IAAA,CACH,CACpB,IAAMC,CAAAA,CAAkB/B,UAAAA,CAAK,IAAA,CAAK5B,CAAAA,CAAK,cAAc,EAErD,OAAO4D,EAAAA,CAAG,YAAA,CAAaD,CAAAA,CAAiB,CACtC,MAAA,CAAQD,CACV,CAAC,CACH,CCWA,IAAMG,EAAAA,CAAwB,CAC5B,qBACA,OAAA,CACA,QAAA,CACA,MAAA,CACA,OACF,CAAA,CAEyBrE,EAAE,MAAA,CAAO,CAChC,eAAA,CAAiBA,CAAAA,CAAE,MAAA,CAAO,CACxB,MAAOA,CAAAA,CAAE,MAAA,CAAOA,CAAAA,CAAE,MAAA,EAAO,CAAE,EAAA,CAAGA,EAAE,KAAA,CAAMA,CAAAA,CAAE,MAAA,EAAQ,CAAC,CAAC,CACpD,CAAC,CACH,CAAC,EAED,eAAsB6D,CAAAA,CAAerD,EAA0C,CAC7E,GAAM,CACJ8D,CAAAA,CACAC,CAAAA,CACAC,CAAAA,CACAC,EACAC,CAAAA,CACAC,CAAAA,CACAC,CAAAA,CACAC,CACF,CAAA,CAAI,MAAM,QAAQ,GAAA,CAAI,CACpBxB,EAAAA,CAAG,IAAA,CACD,uFAAA,CACA,CACE,IAAA7C,CAAAA,CACA,IAAA,CAAM,CAAA,CACN,MAAA,CAAQ6D,EACV,CACF,EACAD,EAAAA,CAAG,UAAA,CAAWhC,UAAAA,CAAK,OAAA,CAAQ5B,CAAAA,CAAK,KAAK,CAAC,CAAA,CACtCsE,EAAAA,CAAoBtE,CAAG,CAAA,CACvBuE,EAAAA,CAAsBvE,CAAG,EACzBwE,EAAAA,CAAmBxE,CAAG,CAAA,CACtByE,EAAAA,CAAmBzE,CAAG,CAAA,CACtB0E,GAAuB1E,CAAG,CAAA,CAC1ByD,EAAAA,CAAezD,CAAAA,CAAK,KAAK,CAC3B,CAAC,CAAA,CAEK2E,CAAAA,CAAgB,MAAMf,EAAAA,CAAG,UAAA,CAC7BhC,UAAAA,CAAK,QAAQ5B,CAAAA,CAAK,CAAA,EAAG+D,CAAAA,CAAW,MAAA,CAAS,EAAE,CAAA,GAAA,CAAK,CAClD,CAAA,CAEMa,CAAAA,CAAoB,CACxB,SAAA,CAAWtE,CAAAA,CAAW,MAAA,CACtB,SAAAyD,CAAAA,CACA,KAAA,CAAO,KAAA,CACP,KAAA,CAAAC,CAAAA,CACA,kBAAA,CAAAC,EACA,eAAA,CAAAC,CAAAA,CACA,eAAA,CAAAC,CAAAA,CACA,gBAAA,CAAkB,IAAA,CAClB,YAAAC,CACF,CAAA,CAGA,GAAIN,CAAAA,CAAY,IAAA,CAAMe,CAAAA,EAASA,EAAK,UAAA,CAAW,cAAc,CAAC,CAAA,EAAG,MAAA,CAC/D,OAAAD,EAAK,SAAA,CAAYD,CAAAA,CACbrE,CAAAA,CAAW,UAAU,CAAA,CACrBA,CAAAA,CAAW,YAAY,CAAA,CAC3BsE,CAAAA,CAAK,KAAA,CAAQD,CAAAA,CACbC,CAAAA,CAAK,gBAAA,CAAmB,MAAME,EAAAA,CAC5BF,CAAAA,CAAK,SAAA,CACLP,CACF,CAAA,CACOO,CAAAA,CAIT,GAAId,CAAAA,CAAY,IAAA,CAAMe,CAAAA,EAASA,CAAAA,CAAK,UAAA,CAAW,eAAe,CAAC,CAAA,EAAG,MAAA,CAChE,OAAAD,CAAAA,CAAK,SAAA,CAAYtE,CAAAA,CAAW,MACrBsE,CAAAA,CAIT,GAAId,CAAAA,CAAY,IAAA,CAAMe,CAAAA,EAASA,CAAAA,CAAK,WAAW,gBAAgB,CAAC,CAAA,EAAG,MAAA,CACjE,OAAAD,CAAAA,CAAK,UAAYtE,CAAAA,CAAW,MAAA,CACrBsE,CAAAA,CAIT,GAAId,CAAAA,CAAY,IAAA,CAAMe,GAASA,CAAAA,CAAK,UAAA,CAAW,eAAe,CAAC,CAAA,EAAG,MAAA,CAChE,OAAAD,CAAAA,CAAK,SAAA,CAAYtE,CAAAA,CAAW,OAAA,CACrBsE,CAAAA,CAIT,GACE,OAAO,IAAA,CAAKP,CAAAA,EAAa,YAAA,EAAgB,EAAE,CAAA,CAAE,KAAMU,CAAAA,EACjDA,CAAAA,CAAI,UAAA,CAAW,aAAa,CAC9B,CAAA,CAEA,OAAAH,CAAAA,CAAK,SAAA,CAAYtE,CAAAA,CAAW,KAAA,CACrBsE,CAAAA,CAIT,GACE,CACE,GAAG,MAAA,CAAO,IAAA,CAAKP,CAAAA,EAAa,YAAA,EAAgB,EAAE,CAAA,CAC9C,GAAG,MAAA,CAAO,IAAA,CAAKA,CAAAA,EAAa,eAAA,EAAmB,EAAE,CACnD,CAAA,CAAE,IAAA,CAAMU,CAAAA,EAAQA,CAAAA,CAAI,WAAW,uBAAuB,CAAC,CAAA,CAEvD,OAAAH,CAAAA,CAAK,SAAA,CAAYtE,EAAW,gBAAgB,CAAA,CACrCsE,CAAAA,CAIT,GACEd,CAAAA,CAAY,IAAA,CAAMe,GAASA,CAAAA,CAAK,UAAA,CAAW,sBAAsB,CAAC,CAAA,EAAG,MAAA,CAErE,OAAAD,CAAAA,CAAK,SAAA,CAAYtE,CAAAA,CAAW,cAAc,CAAA,CACnCsE,CAAAA,CAMT,GAAId,CAAAA,CAAY,IAAA,CAAMe,CAAAA,EAASA,CAAAA,CAAK,UAAA,CAAW,cAAc,CAAC,CAAA,EAAG,MAAA,CAC/D,OAAAD,CAAAA,CAAK,SAAA,CAAYtE,CAAAA,CAAW,KACrBsE,CAAAA,CAKT,IAAMI,CAAAA,CAAYlB,CAAAA,CAAY,IAAA,CAAMe,CAAAA,EAASA,EAAK,UAAA,CAAW,YAAY,CAAC,CAAA,CAC1E,OAAIG,CAAAA,EAAW,SACa,MAAMpB,EAAAA,CAAG,QAAA,CACjChC,UAAAA,CAAK,OAAA,CAAQ5B,CAAAA,CAAKgF,CAAS,CAAA,CAC3B,MACF,CAAA,EACsB,QAAA,CAAS,cAAc,CAAA,EAC3CJ,EAAK,SAAA,CAAYtE,CAAAA,CAAW,IAAA,CACrBsE,CAAAA,GAKPP,CAAAA,EAAa,YAAA,EAAc,OAC7BO,CAAAA,CAAK,SAAA,CAAYtE,CAAAA,CAAW,IAAA,CAAA,CACrBsE,CAAAA,CAIX,CAEA,eAAsBE,EAAAA,CACpBG,CAAAA,CACAZ,CAAAA,CACA,CAMA,GALI,CAACA,GAKD,CAAC,CAAC,UAAA,CAAY,YAAY,CAAA,CAAE,QAAA,CAASY,EAAU,IAAI,CAAA,CACrD,OAAO,IAAA,CAGT,IAAMC,CAAAA,CACJb,EAAY,YAAA,EAAc,IAAA,EAAQA,CAAAA,CAAY,eAAA,EAAiB,IAAA,CAEjE,GAAI,CAACa,CAAAA,CACH,OAAO,IAAA,CAIT,IAAMC,CAAAA,CAAeD,CAAAA,CAAQ,MAAM,wBAAwB,CAAA,CAC3D,GAAIC,CAAAA,CACF,OAAOA,EAAa,CAAC,CAAA,CAIvB,IAAMC,CAAAA,CAAaF,CAAAA,CAAQ,KAAA,CAAM,iBAAiB,CAAA,CAClD,OAAIE,CAAAA,CACKA,CAAAA,CAAW,CAAC,CAAA,CAIdF,CACT,CAEA,eAAsBT,EAAAA,CACpBzE,CAAAA,CACyC,CACzC,GAAM,CAACqF,CAAAA,CAAavE,CAAM,CAAA,CAAI,MAAM,OAAA,CAAQ,GAAA,CAAI,CAC9C2C,EAAAA,CAAezD,CAAAA,CAAK,KAAK,CAAA,CACzBsB,EAAAA,CAAUtB,CAAG,CACf,CAAC,CAAA,CAGD,OAAIc,CAAAA,EAAQ,QAAA,EAAU,MAAA,GAAW,GACxB,IAAA,CAIP,CAACuE,CAAAA,EAAa,YAAA,EAAc,WAAA,EAC5B,CAACA,GAAa,eAAA,EAAiB,WAAA,CAExB,IAAA,CAIP,gCAAA,CAAiC,IAAA,CAC/BA,CAAAA,EAAa,cAAc,WAAA,EACzBA,CAAAA,EAAa,eAAA,EAAiB,WAAA,EAC9B,EACJ,CAAA,CAEO,KAGF,IACT,CAEA,eAAsBb,EAAAA,CAAmBxE,CAAAA,CAAa,CACpD,GAAM,CAACsF,CAAAA,CAAOnB,CAAe,CAAA,CAAI,MAAM,OAAA,CAAQ,IAAI,CACjDtB,EAAAA,CAAG,IAAA,CAAK,CAAC,UAAA,CAAY,WAAW,EAAG,CACjC,GAAA,CAAA7C,CAAAA,CACA,IAAA,CAAM,CAAA,CACN,MAAA,CAAQ6D,EACV,CAAC,CAAA,CACDY,EAAAA,CAAmBzE,CAAG,CACxB,CAAC,EAED,GAAI,CAACsF,CAAAA,CAAM,MAAA,CACT,OAAO,IAAA,CAKT,IAAA,IAAWT,KAAQS,CAAAA,CAAO,CACxB,IAAMC,CAAAA,CAAW,MAAM3B,EAAAA,CAAG,SAAShC,UAAAA,CAAK,OAAA,CAAQ5B,CAAAA,CAAK6E,CAAI,CAAA,CAAG,MAAM,EAClE,GACEU,CAAAA,CAAS,QAAA,CAAS,uBAAuB,CAAA,EACzCA,CAAAA,CAAS,SAAS,uBAAuB,CAAA,EACzCA,CAAAA,CAAS,QAAA,CAAS,gBAAgB,CAAA,CAElC,OAAOV,CAEX,CAEA,OAAO,IACT,CAEA,eAAsBN,GAAsBvE,CAAAA,CAAa,CACvD,IAAMsF,CAAAA,CAAQ,MAAMzC,EAAAA,CAAG,KAAK,mBAAA,CAAqB,CAC/C,GAAA,CAAA7C,CAAAA,CACA,IAAA,CAAM,CAAA,CACN,OAAQ6D,EACV,CAAC,CAAA,CAED,OAAKyB,CAAAA,CAAM,MAAA,CAIJA,EAAM,CAAC,CAAA,CAHL,IAIX,CAEA,eAAsBZ,EAAAA,CAAuB1E,EAAa,CACxD,IAAMyB,CAAAA,CAAW,MAAMC,UAAAA,CAAW1B,CAAG,EAErC,GACEyB,CAAAA,EAAU,UAAA,GAAe,QAAA,EACzB,CAAC,MAAA,CAAO,QAAQA,CAAAA,EAAU,KAAK,CAAA,CAAE,MAAA,CAEjC,OAAO,IAAA,CAIT,OAAW,CAAC+D,CAAAA,CAAOC,CAAK,CAAA,GAAK,MAAA,CAAO,OAAA,CAAQhE,EAAS,KAAK,CAAA,CACxD,GACEgE,CAAAA,CAAM,QAAA,CAAS,KAAK,GACpBA,CAAAA,CAAM,QAAA,CAAS,SAAS,CAAA,EACxBA,CAAAA,CAAM,QAAA,CAAS,SAAS,CAAA,EACxBA,CAAAA,CAAM,QAAA,CAAS,kBAAkB,CAAA,CAEjC,OAAOD,EAAM,OAAA,CAAQ,OAAA,CAAS,EAAE,CAAA,EAAK,IAAA,CAKzC,OAAO,OAAO,IAAA,CAAK/D,CAAAA,EAAU,KAAK,CAAA,GAAI,CAAC,CAAA,CAAE,QAAQ,OAAA,CAAS,EAAE,CAAA,EAAK,IACnE,CAEA,eAAsB6C,GAAoBtE,CAAAA,CAAa,CAOrD,OAAA,CANc,MAAM6C,EAAAA,CAAG,IAAA,CAAK,aAAc,CACxC,GAAA,CAAA7C,CAAAA,CACA,IAAA,CAAM,CAAA,CACN,MAAA,CAAQ6D,EACV,CAAC,CAAA,EAEY,MAAA,CAAS,CACxB,CA4BA,eAAsB6B,GACpB1F,CAAAA,CACA2F,CAAAA,CAAyC,IAAA,CACjB,CAExB,GAAM,CAACC,EAAgBC,CAAW,CAAA,CAAI,MAAM,OAAA,CAAQ,GAAA,CAAI,CACtDvE,GAAUtB,CAAG,CAAA,CACZ2F,CAAAA,CAEG,OAAA,CAAQ,OAAA,CAAQA,CAAkB,EADlCtC,CAAAA,CAAerD,CAAG,CAExB,CAAC,CAAA,CAED,GAAI4F,EACF,OAAOA,CAAAA,CAGT,GACE,CAACC,CAAAA,EACD,CAACA,EAAY,eAAA,EACZA,CAAAA,CAAY,eAAA,GAAoB,IAAA,EAAQ,CAACA,CAAAA,CAAY,mBAEtD,OAAO,IAAA,CAGT,IAAM/E,CAAAA,CAA0C,CAC9C,OAAA,CAAS,oCACT,GAAA,CAAK+E,CAAAA,CAAY,KAAA,CACjB,GAAA,CAAKA,CAAAA,CAAY,KAAA,CACjB,MAAO,UAAA,CACP,QAAA,CAAU,CACR,MAAA,CAAQA,CAAAA,CAAY,kBAAA,EAAsB,GAC1C,SAAA,CAAW,MAAA,CACX,GAAA,CAAKA,CAAAA,CAAY,eAAA,CACjB,YAAA,CAAc,KACd,MAAA,CAAQ,EACV,CAAA,CACA,WAAA,CAAa,QAAA,CACb,OAAA,CAAS,CACP,UAAA,CAAY,CAAA,EAAGA,CAAAA,CAAY,WAAW,CAAA,WAAA,CAAA,CACtC,EAAA,CAAI,GAAGA,CAAAA,CAAY,WAAW,CAAA,cAAA,CAAA,CAC9B,KAAA,CAAO,CAAA,EAAGA,CAAAA,CAAY,WAAW,CAAA,MAAA,CAAA,CACjC,GAAA,CAAK,CAAA,EAAGA,CAAAA,CAAY,WAAW,CAAA,IAAA,CAAA,CAC/B,MAAO,CAAA,EAAGA,CAAAA,CAAY,WAAW,CAAA,UAAA,CACnC,CACF,CAAA,CAEA,OAAO,MAAMrE,EAAAA,CAAmBxB,CAAAA,CAAKc,CAAM,CAC7C,CAEA,eAAsBgF,EAAAA,CAAoChF,CAAAA,CAE7B,CAC3B,GAAI,CAACA,CAAAA,CAAO,eAAe,GAAA,CACzB,OAAO,IAAA,CAGT,IAAM+E,CAAAA,CAAc,MAAMxC,EAAevC,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CAEjE,OAAK+E,CAAAA,EAAa,gBAIXA,CAAAA,CAAY,eAAA,CAHV,IAIX,CC3ZO,SAASE,EAAAA,CACdC,CAAAA,CACAC,CAAAA,CACA3H,CAAAA,CAEI,GACJ,CACA,GAAM,CAAE,aAAA,CAAA4H,CAAAA,CAAgB,KAAM,EAAI5H,CAAAA,CAG5B6H,CAAAA,CAAqBH,CAAAA,CAAgB,OAAA,CAAQ,OAAA,CAAS;AAAA,CAAI,EAAE,IAAA,EAAK,CACjEI,CAAAA,CAAgBH,CAAAA,CAAW,QAAQ,OAAA,CAAS;AAAA,CAAI,CAAA,CAAE,IAAA,EAAK,CAG7D,GAAIE,CAAAA,GAAuBC,CAAAA,CACzB,OAAO,KAAA,CAIT,GAAI,CAACF,CAAAA,CACH,OAAO,OAYT,IAAMG,CAAAA,CACJ,qHAAA,CAGIC,CAAAA,CAAoBC,CAAAA,EACjBA,CAAAA,CAAQ,OAAA,CACbF,CAAAA,CACA,CAACxI,CAAAA,CAAQ2I,CAAAA,CAAQ3F,CAAAA,CAAY4F,CAAAA,GAAW,CAEtC,GAAI5F,CAAAA,CAAW,UAAA,CAAW,GAAG,CAAA,CAC3B,OAAO,CAAA,EAAG2F,CAAM,CAAA,EAAG3F,CAAU,CAAA,EAAG4F,CAAM,CAAA,CAAA,CAKxC,IAAMC,CAAAA,CAAQ7F,CAAAA,CAAW,KAAA,CAAM,GAAG,CAAA,CAC5B8F,CAAAA,CAAWD,EAAMA,CAAAA,CAAM,MAAA,CAAS,CAAC,CAAA,CAGvC,OAAO,CAAA,EAAGF,CAAM,CAAA,YAAA,EAAeG,CAAQ,CAAA,EAAGF,CAAM,CAAA,CAClD,CACF,CAAA,CAGIG,CAAAA,CAAqBN,CAAAA,CAAiBH,CAAkB,EACxDU,CAAAA,CAAgBP,CAAAA,CAAiBF,CAAa,CAAA,CAEpD,OAAOQ,CAAAA,GAAuBC,CAChC,CCzDO,SAASC,EAAU1H,CAAAA,CAAkB,CAC1C,IAAM2H,CAAAA,CAAWnF,UAAAA,CAAK,QAAA,CAASxC,CAAQ,CAAA,CACvC,OAAO,cAAA,CAAe,IAAA,CAAK2H,CAAQ,CACrC,CAMO,SAASC,EAAAA,CAAoBC,CAAAA,CAAmB,CACrD,IAAMC,CAAAA,CAAW,CACf,YAAA,CACA,MAAA,CACA,wBAAA,CACA,kBACF,CAAA,CAEA,QAAWC,CAAAA,IAAWD,CAAAA,CAAU,CAC9B,IAAM9H,CAAAA,CAAWwC,UAAAA,CAAK,IAAA,CAAKqF,CAAAA,CAAWE,CAAO,CAAA,CAC7C,GAAIC,UAAAA,CAAWhI,CAAQ,CAAA,CACrB,OAAOA,CAEX,CAEA,OAAO,IACT,CAKO,SAASiI,EAAAA,CAAgBd,CAAAA,CAAiB,CAC/C,IAAMe,CAAAA,CAAQf,EAAQ,KAAA,CAAM;AAAA,CAAI,CAAA,CAC1BgB,CAAAA,CAA8B,EAAC,CAErC,IAAA,IAAWC,KAAQF,CAAAA,CAAO,CACxB,IAAMG,CAAAA,CAAUD,CAAAA,CAAK,IAAA,GAErB,GAAI,CAACC,CAAAA,EAAWA,CAAAA,CAAQ,UAAA,CAAW,GAAG,CAAA,CACpC,SAIF,IAAMC,CAAAA,CAAaD,CAAAA,CAAQ,OAAA,CAAQ,GAAG,CAAA,CACtC,GAAIC,CAAAA,GAAe,EAAA,CACjB,SAGF,IAAM5J,CAAAA,CAAM2J,CAAAA,CAAQ,SAAA,CAAU,CAAA,CAAGC,CAAU,CAAA,CAAE,IAAA,EAAK,CAC5C9J,CAAAA,CAAQ6J,CAAAA,CAAQ,UAAUC,CAAAA,CAAa,CAAC,CAAA,CAAE,IAAA,EAAK,CAEjD5J,CAAAA,GACFyJ,CAAAA,CAAIzJ,CAAG,CAAA,CAAIF,CAAAA,CAAM,OAAA,CAAQ,cAAA,CAAgB,EAAE,CAAA,EAE/C,CAEA,OAAO2J,CACT,CAKO,SAASI,EAAAA,CAAc3B,CAAAA,CAAyBC,EAAoB,CACzE,IAAM2B,CAAAA,CAAcP,EAAAA,CAAgBrB,CAAe,CAAA,CAC7C6B,EAASR,EAAAA,CAAgBpB,CAAU,CAAA,CAEnC6B,CAAAA,CAAU,EAAC,CACjB,IAAA,IAAWhK,CAAAA,IAAO,MAAA,CAAO,IAAA,CAAK+J,CAAM,CAAA,CAC5B/J,CAAAA,IAAO8J,CAAAA,EACXE,EAAQ,IAAA,CAAKhK,CAAG,CAAA,CAIpB,OAAOgK,CACT,CAMO,SAASC,EAAAA,CAAgB/B,CAAAA,CAAyBC,CAAAA,CAAoB,CAC3E,IAAM2B,CAAAA,CAAcP,EAAAA,CAAgBrB,CAAe,CAAA,CAC7C6B,CAAAA,CAASR,EAAAA,CAAgBpB,CAAU,CAAA,CAErC1D,CAAAA,CAASyD,CAAAA,CAAgB,OAAA,EAAQ,CACjCzD,CAAAA,EAAU,CAACA,CAAAA,CAAO,QAAA,CAAS;AAAA,CAAI,IACjCA,CAAAA,EAAU;AAAA,CAAA,CAAA,CAGZ,IAAMuF,CAAAA,CAAoB,EAAC,CAC3B,IAAA,GAAW,CAAChK,CAAAA,CAAKF,CAAK,CAAA,GAAK,MAAA,CAAO,OAAA,CAAQiK,CAAM,CAAA,CACxC/J,CAAAA,IAAO8J,CAAAA,EACXE,CAAAA,CAAQ,IAAA,CAAK,CAAA,EAAGhK,CAAG,CAAA,CAAA,EAAIF,CAAK,CAAA,CAAE,CAAA,CAIlC,OAAIkK,CAAAA,CAAQ,MAAA,CAAS,CAAA,EACfvF,CAAAA,GACFA,CAAAA,EAAU;AAAA,CAAA,CAAA,CAEZA,CAAAA,EAAUuF,EAAQ,IAAA,CAAK;AAAA,CAAI,EACpBvF,CAAAA,CAAS;AAAA,CAAA,EAIdA,CAAAA,EAAU,CAACA,CAAAA,CAAO,QAAA,CAAS;AAAA,CAAI,EAC1BA,CAAAA,CAAS;AAAA,CAAA,CAGXA,CACT,CC9GO,IAAMyF,CAAAA,CAAS,CACpB,SAASC,CAAAA,CAAiB,CACxB,OAAA,CAAQ,GAAA,CAAI1H,CAAAA,CAAY,KAAA,CAAM0H,EAAK,IAAA,CAAK,GAAG,CAAC,CAAC,EAC/C,CAAA,CACA,QAAQA,CAAAA,CAAiB,CACvB,OAAA,CAAQ,GAAA,CAAI1H,CAAAA,CAAY,IAAA,CAAK0H,EAAK,IAAA,CAAK,GAAG,CAAC,CAAC,EAC9C,CAAA,CACA,QAAQA,CAAAA,CAAiB,CACvB,OAAA,CAAQ,GAAA,CAAI1H,CAAAA,CAAY,IAAA,CAAK0H,EAAK,IAAA,CAAK,GAAG,CAAC,CAAC,EAC9C,CAAA,CACA,WAAWA,CAAAA,CAAiB,CAC1B,OAAA,CAAQ,GAAA,CAAI1H,CAAAA,CAAY,OAAA,CAAQ0H,EAAK,IAAA,CAAK,GAAG,CAAC,CAAC,EACjD,CAAA,CACA,OAAOA,CAAAA,CAAiB,CACtB,OAAA,CAAQ,GAAA,CAAIA,CAAAA,CAAK,IAAA,CAAK,GAAG,CAAC,EAC5B,CAAA,CACA,KAAA,EAAQ,CACN,OAAA,CAAQ,IAAI,EAAE,EAChB,CACF,ECnBO,SAASC,CAAAA,CACdC,CAAAA,CACA7J,CAAAA,CAGA,CACA,OAAO8J,GAAI,CACT,IAAA,CAAAD,CAAAA,CACA,QAAA,CAAU7J,CAAAA,EAAS,MACrB,CAAC,CACH,CCRO,IAAM+J,EAAAA,CAA+B,MAAO,CACjD,WAAAC,CAAAA,CACA,MAAA,CAAAxH,CAAAA,CACA,QAAA,CAAAyH,CACF,CAAA,GAAM,CACJ,IAAMC,CAAAA,CAAa1H,CAAAA,CAAO,OAAA,EAAS,KAAA,CAK7B2H,CAAAA,CAAc,GAHlB,OAAOD,CAAAA,EAAe,QAAA,EAAYA,CAAAA,CAAW,QAAA,CAAS,GAAG,EACrDA,CAAAA,CAAW,KAAA,CAAM,GAAG,CAAA,CAAE,CAAC,CAAA,CACvB,GAC+B,CAAA,UAAA,CAAA,CAErC,GAAI,CAAC,CAAC,MAAA,CAAQ,KAAA,CAAO,OAAQ,KAAK,CAAA,CAAE,QAAA,CAASF,CAAAA,CAAW,YAAA,EAAc,EACpE,OAAOA,CAAAA,CAGT,IAAA,IAAWI,CAAAA,IAAaJ,CAAAA,CAAW,uBAAA,GAA2B,CAC5D,IAAMK,CAAAA,CAAUC,EAAAA,CACdF,CAAAA,CAAU,eAAA,GACV5H,CAAAA,CACAyH,CACF,CAAA,CAIA,GAHAG,CAAAA,CAAU,eAAA,CAAgBC,CAAO,CAAA,CAG7BF,CAAAA,GAAgBE,CAAAA,EAAWA,CAAAA,GAAY,aAAA,CAAe,CAQxD,GAAI,CAPsBD,CAAAA,CAAU,sBAAA,CAClCG,UAAAA,CAAW,iBACb,CAAA,EAEI,iBAAgB,CACjB,IAAA,CAAMC,CAAAA,EAAgBA,CAAAA,CAAY,OAAA,EAAQ,GAAM,IAAI,CAAA,EAEpC,CAAChI,CAAAA,CAAO,OAAA,CAAQ,KAAA,CACjC,SAGF4H,EAAU,eAAA,CACRD,CAAAA,GAAgBE,CAAAA,CACZA,CAAAA,CAAQ,OAAA,CAAQF,CAAAA,CAAa3H,CAAAA,CAAO,OAAA,CAAQ,KAAK,CAAA,CACjDA,CAAAA,CAAO,OAAA,CAAQ,KACrB,EACF,CACF,CAEA,OAAOwH,CACT,CAAA,CAEA,SAASM,EAAAA,CACPG,EACAjI,CAAAA,CACAyH,CAAAA,CAAoB,KAAA,CACpB,CAEA,GAAI,CAACQ,EAAgB,UAAA,CAAW,IAAI,CAAA,EAAK,CAACR,CAAAA,CACxC,OAAOQ,EAST,GALIR,CAAAA,EAAYQ,CAAAA,CAAgB,UAAA,CAAW,IAAI,CAAA,GAC7CA,EAAkBA,CAAAA,CAAgB,OAAA,CAAQ,MAAA,CAAQ,sBAAsB,CAAA,CAAA,CAItE,CAACA,EAAgB,UAAA,CAAW,aAAa,CAAA,CAAG,CAE9C,IAAMvD,CAAAA,CAAQ1E,EAAO,OAAA,CAAQ,UAAA,CAAW,KAAA,CAAM,GAAG,CAAA,CAAE,CAAC,EACpD,OAAOiI,CAAAA,CAAgB,OAAA,CAAQ,MAAA,CAAQ,CAAA,EAAGvD,CAAK,GAAG,CACpD,CAEA,OAAIuD,CAAAA,CAAgB,KAAA,CAAM,wBAAwB,EACzCA,CAAAA,CAAgB,OAAA,CACrB,wBAAA,CACAjI,CAAAA,CAAO,OAAA,CAAQ,EAAA,EAAM,GAAGA,CAAAA,CAAO,OAAA,CAAQ,UAAU,CAAA,GAAA,CACnD,CAAA,CAIAA,CAAAA,CAAO,QAAQ,UAAA,EACfiI,CAAAA,CAAgB,KAAA,CAAM,gCAAgC,CAAA,CAE/CA,CAAAA,CAAgB,QACrB,gCAAA,CACAjI,CAAAA,CAAO,OAAA,CAAQ,UACjB,CAAA,CAGEA,CAAAA,CAAO,QAAQ,GAAA,EAAOiI,CAAAA,CAAgB,KAAA,CAAM,yBAAyB,CAAA,CAChEA,CAAAA,CAAgB,QACrB,yBAAA,CACAjI,CAAAA,CAAO,OAAA,CAAQ,GACjB,CAAA,CAIAA,CAAAA,CAAO,OAAA,CAAQ,KAAA,EACfiI,CAAAA,CAAgB,KAAA,CAAM,2BAA2B,CAAA,CAE1CA,CAAAA,CAAgB,OAAA,CACrB,4BACAjI,CAAAA,CAAO,OAAA,CAAQ,KACjB,CAAA,CAGKiI,CAAAA,CAAgB,OAAA,CACrB,sBACAjI,CAAAA,CAAO,OAAA,CAAQ,UACjB,CACF,CCjGA,IAAMkI,GAA+B,CACnC,UAAA,CAAY,QAAA,CACZ,2BAAA,CAA6B,IAAA,CAC7B,0BAAA,CAA4B,KAC5B,SAAA,CAAW,CAAA,CACX,MAAA,CAAQ,IAAA,CACR,OAAA,CAAS,CACP,kBACA,QAAA,CACA,qBAAA,CACA,wBAAA,CACA,iBAAA,CACA,kBAAA,CACA,SAAA,CACA,oBACA,eAAA,CACA,eAAA,CACA,mBAAA,CACA,qBAAA,CACA,cAAA,CACA,cAAA,CACA,mBACA,YAAA,CACA,2BAAA,CACA,kBAAA,CACA,kBAAA,CACA,sBAAA,CACA,kBAAA,CACA,CACE,kBAAA,CACA,CACE,QAAA,CAAU,SACZ,CACF,CAAA,CACA,CACE,gBAAA,CACA,CACE,UAAA,CAAY,MACd,CACF,CAAA,CACA,mBACA,eAAA,CACA,aAAA,CACA,YAAA,CACA,KACF,CACF,CAAA,CAEaC,GAAoC,MAAO,CACtD,UAAA,CAAAX,CAAAA,CACA,MAAA,CAAAxH,CACF,IAAM,CACJ,IAAMoI,CAAAA,CAASZ,CAAAA,CAAW,WAAA,EAAY,CAEtC,GAAIxH,CAAAA,CAAO,GAAA,CACT,OAAOoI,CAAAA,CAGT,IAAMC,CAAAA,CAAa,EAAA,CAAA,KAAA,CAAMD,CAAAA,CAAQ,CAC/B,MAAA,CAAQ,CACN,KAAA,CAAQE,CAAAA,EACCC,KAAAA,CAAMD,EAAMJ,EAAa,CAEpC,CACF,CAAC,CAAA,CAEKzG,CAAAA,CAAS+G,qBAAqBH,CAAAA,CAAKD,CAAAA,CAAQ,CAC/C,aAAA,CAAe,KAAA,CACf,IAAA,CAAM,MACN,GAAA,CAAK,IAAA,CACL,OAAA,CAAS,CAACK,EAAmB,CAAA,CAC7B,WAAY,KACd,CAAC,CAAA,CAED,GAAI,CAAChH,CAAAA,EAAU,CAACA,CAAAA,CAAO,GAAA,CACrB,MAAM,IAAI,KAAA,CAAM,yBAAyB,EAG3C,OAAc,EAAA,CAAA,KAAA,CAAMA,CAAAA,CAAO,GAAG,CAAA,CAAE,IAClC,EC3FA,IAAMiH,EAAAA,CAAiB,wBAEVC,EAAAA,CAA4B,MAAO,CAAE,UAAA,CAAAnB,CAAAA,CAAY,MAAA,CAAAxH,CAAO,CAAA,GAAM,CACzE,GAAIA,CAAAA,CAAO,GAAA,CACT,OAAOwH,EAIT,IAAMoB,CAAAA,CAAQpB,CAAAA,CAAW,mBAAA,CAAoBO,UAAAA,CAAW,mBAAmB,EAC3E,OAAIa,CAAAA,EAASF,EAAAA,CAAe,IAAA,CAAKE,CAAAA,CAAM,OAAA,EAAS,CAAA,EAC9CA,CAAAA,CAAM,MAAA,EAAO,CAGRpB,CACT,CAAA,CCLA,IAAMqB,EAAAA,CAAkB,gBAAA,CAClBC,EAAAA,CAAyB,iBAAA,CAGxB,SAASC,EAAAA,CAAeC,CAAAA,CAAmB,CAChD,OAAOA,CAAAA,CACJ,OAAA,CAAQF,EAAAA,CAAwB,EAAE,CAAA,CAClC,QAAQ,MAAA,CAAQ,GAAG,CAAA,CACnB,IAAA,EACL,CAKA,SAASG,EAAAA,CAAqBC,CAAAA,CAAyB,CACrD,IAAMC,CAAAA,CAAeD,CAAAA,CAAK,iBAAgB,CAC1C,GAAI,CAACL,EAAAA,CAAgB,IAAA,CAAKM,CAAY,EACpC,OAGF,IAAMC,CAAAA,CAAWL,EAAAA,CAAeI,CAAY,CAAA,CACxCC,IAAaD,CAAAA,EACfD,CAAAA,CAAK,eAAA,CAAgBE,CAAQ,EAEjC,CAEA,SAASC,EAAAA,CAAsBH,CAAAA,CAAY,CACzC,IAAA,IAAWI,CAAAA,IAAaJ,CAAAA,CAAK,qBAAqBnB,UAAAA,CAAW,aAAa,CAAA,CACxEkB,EAAAA,CAAqBK,CAAS,CAAA,CAGhC,QAAWC,CAAAA,IAAeL,CAAAA,CAAK,oBAAA,CAC7BnB,UAAAA,CAAW,6BACb,CAAA,CACEkB,GAAqBM,CAAW,EAEpC,CAGO,SAASC,EAAAA,CAAahC,CAAAA,CAAwB,CAEnD,IAAMiC,CAAAA,CAEF,EAAC,CAGL,IAAA,IAAWC,CAAAA,IAAQlC,EAAW,oBAAA,CAAqBO,UAAAA,CAAW,YAAY,CAAA,CAAG,CAC3E,IAAM4B,EAAWD,CAAAA,CAAK,WAAA,EAAY,CAAE,OAAA,EAAQ,CAC5C,GAAIC,IAAa,WAAA,EAAeA,CAAAA,GAAa,YAAA,CAC3C,SAGF,IAAMC,CAAAA,CAAcF,EAAK,cAAA,EAAe,CAGxC,GAAIE,CAAAA,EAAa,MAAA,CAAO7B,UAAAA,CAAW,aAAa,CAAA,CAAG,CACjD,IAAMoB,CAAAA,CAAeS,CAAAA,CAAY,eAAA,EAAgB,CACjD,GAAIf,EAAAA,CAAgB,IAAA,CAAKM,CAAY,CAAA,CAAG,CACtC,IAAMC,EAAWL,EAAAA,CAAeI,CAAY,CAAA,CACxCC,CAAAA,GAAa,EAAA,CAEfK,CAAAA,CAAmB,KAAKC,CAAI,CAAA,CACnBN,CAAAA,GAAaD,CAAAA,EACtBS,CAAAA,CAAY,eAAA,CAAgBR,CAAQ,EAExC,CACF,CAGIQ,CAAAA,EAAa,MAAA,CAAO7B,UAAAA,CAAW,aAAa,CAAA,EAC9CsB,EAAAA,CAAsBO,CAAW,EAErC,CAGA,IAAA,IAAWF,KAAQD,CAAAA,CACjBC,CAAAA,CAAK,MAAA,EAAO,CAId,IAAA,IAAWG,CAAAA,IAAQrC,EAAW,oBAAA,CAC5BO,UAAAA,CAAW,cACb,CAAA,CACE,GAAI8B,CAAAA,CAAK,eAAc,CAAE,OAAA,EAAQ,GAAM,KAAA,CAIvC,IAAA,IAAWC,CAAAA,IAAOD,EAAK,YAAA,EAAa,CAAG,CACrC,GAAIC,CAAAA,CAAI,MAAA,CAAO/B,WAAW,aAAa,CAAA,CAAG,CACxCkB,EAAAA,CAAqBa,CAAG,CAAA,CACxB,QACF,CACA,GAAIA,CAAAA,CAAI,MAAA,CAAO/B,UAAAA,CAAW,6BAA6B,EAAG,CACxDkB,EAAAA,CAAqBa,CAAG,CAAA,CACxB,QACF,CAEAT,GAAsBS,CAAG,EAC3B,CAIF,IAAA,IAAWD,CAAAA,IAAQrC,CAAAA,CAAW,qBAC5BO,UAAAA,CAAW,cACb,CAAA,CACM8B,CAAAA,CAAK,aAAA,EAAc,CAAE,SAAQ,GAAM,YAAA,EAIvCR,EAAAA,CAAsBQ,CAAI,EAE9B,CAEO,IAAME,EAAAA,CAAgC,MAAO,CAAE,UAAA,CAAAvC,CAAW,CAAA,IAC/DgC,EAAAA,CAAahC,CAAU,CAAA,CAChBA,CAAAA,CAAAA,CCtHF,IAAMwC,EAAAA,CAAmC,MAAO,CACrD,UAAA,CAAAxC,CAAAA,CACA,MAAA,CAAAxH,CACF,CAAA,GAAM,CACJ,GAAI,CAACA,CAAAA,CAAO,QAAA,EAAU,OACpB,OAAOwH,CAAAA,CAET,IAAMnE,CAAAA,CAAkB,MAAM2B,EAAAA,CAAoChF,CAAM,CAAA,CAGxE,OAAAwH,CAAAA,CACG,oBAAA,CAAqBO,UAAAA,CAAW,cAAc,EAC9C,MAAA,CAAQmB,CAAAA,EAASA,CAAAA,CAAK,aAAA,EAAc,CAAE,OAAA,KAAc,KAAK,CAAA,CACzD,OAAA,CAASA,CAAAA,EAAS,CAEjB,GAAIA,EAAK,YAAA,EAAa,CAAE,CAAC,CAAA,EAAG,MAAA,CAAOnB,UAAAA,CAAW,aAAa,CAAA,CAAG,CAC5D,IAAMkC,CAAAA,CAAoBf,CAAAA,CAAK,YAAA,EAAa,CAAE,CAAC,CAAA,CAC3Ce,CAAAA,EACFA,CAAAA,CAAkB,eAAA,CAChB,CAAA,CAAA,EAAIC,CAAAA,CACFD,EAAkB,OAAA,EAAQ,EAAG,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAA,CAC/CjK,EAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,CAAA,CAAA,CACH,EAEJ,CAGI6F,CAAAA,CAAK,YAAA,EAAa,CAAE,CAAC,CAAA,EAAG,MAAA,CAAOnB,WAAW,uBAAuB,CAAA,EACnEmB,CAAAA,CACG,YAAA,EAAa,CAAE,CAAC,GACf,oBAAA,CAAqBnB,UAAAA,CAAW,kBAAkB,CAAA,CACnD,IAAA,CAAMmB,CAAAA,EAASA,EAAK,OAAA,EAAQ,GAAM,UAAU,CAAA,EAC3C,oBAAA,CAAqBnB,UAAAA,CAAW,kBAAkB,CAAA,CACnD,OAAA,CAASmB,CAAAA,EAAS,CACjBA,CAAAA,CACG,oBAAA,CAAqBnB,UAAAA,CAAW,kBAAkB,CAAA,CAClD,OAAA,CAASmB,CAAAA,EAAS,CACjB,IAAMiB,CAAAA,CAAajB,EAAK,oBAAA,CACtBnB,UAAAA,CAAW,aACb,CAAA,CACIoC,CAAAA,EACFA,CAAAA,EAAY,gBACV,CAAA,CAAA,EAAID,CAAAA,CACFC,CAAAA,CAAW,OAAA,EAAQ,EAAG,OAAA,CAAQ,OAAQ,EAAE,CAAA,CACxCnK,CAAAA,CAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,CAAA,CAAA,CACH,EAEJ,CAAC,EACL,CAAC,EAEP,CAAC,CAAA,CAGHmE,CAAAA,CAAW,oBAAA,CAAqBO,UAAAA,CAAW,YAAY,CAAA,CAAE,QAASmB,CAAAA,EAAS,CACzE,GAAIA,CAAAA,CAAK,WAAA,EAAY,CAAE,SAAQ,GAAM,WAAA,CAAa,CAEhD,GAAIA,CAAAA,CAAK,cAAA,IAAkB,MAAA,CAAOnB,UAAAA,CAAW,aAAa,CAAA,CAAG,CAC3D,IAAMjL,EAAQoM,CAAAA,CAAK,cAAA,EAAe,CAC9BpM,CAAAA,EACFA,CAAAA,CAAM,eAAA,CACJ,IAAIoN,CAAAA,CACFpN,CAAAA,CAAM,OAAA,EAAQ,EAAG,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAA,CACnCkD,CAAAA,CAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,GACH,EAEJ,CAGA,GAAI6F,CAAAA,CAAK,cAAA,EAAe,EAAG,OAAOnB,UAAAA,CAAW,aAAa,CAAA,CAAG,CAE3D,IAAMqC,CAAAA,CAAiBlB,EACpB,cAAA,EAAe,EACd,oBAAA,CAAqBnB,UAAAA,CAAW,cAAc,CAAA,CAC/C,IAAA,CAAMmB,CAAAA,EAASA,CAAAA,CAAK,aAAA,EAAc,CAAE,OAAA,EAAQ,GAAM,IAAI,EACrDkB,CAAAA,EAEFA,CAAAA,CAAe,YAAA,EAAa,CAAE,OAAA,CAASlB,CAAAA,EAAS,EAE5CA,CAAAA,CAAK,MAAA,CAAOnB,UAAAA,CAAW,qBAAqB,CAAA,EAC5CmB,CAAAA,CAAK,OAAOnB,UAAAA,CAAW,gBAAgB,CAAA,GAEvCmB,CAAAA,CACG,iBAAA,CAAkBnB,UAAAA,CAAW,aAAa,CAAA,CAC1C,OAAA,CAASmB,CAAAA,EAAS,CACjBA,CAAAA,CAAK,eAAA,CACH,IAAIgB,CAAAA,CACFhB,CAAAA,CAAK,OAAA,EAAQ,EAAG,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAA,CAClClJ,CAAAA,CAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,GACH,EACF,CAAC,CAAA,CAGD6F,CAAAA,CAAK,MAAA,CAAOnB,UAAAA,CAAW,aAAa,CAAA,EACtCmB,CAAAA,CAAK,eAAA,CACH,CAAA,CAAA,EAAIgB,CAAAA,CACFhB,CAAAA,CAAK,SAAQ,EAAG,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAA,CAClClJ,CAAAA,CAAO,SAAS,MAAA,CAChBqD,CACF,CAAC,CAAA,CAAA,CACH,EAEJ,CAAC,EAEL,CACF,CAGI6F,CAAAA,CAAK,WAAA,EAAY,CAAE,OAAA,KAAc,YAAA,EAC/BA,CAAAA,CAAK,cAAA,EAAe,EAAG,MAAA,CAAOnB,UAAAA,CAAW,aAAa,CAAA,EACxDmB,CAAAA,CACG,oBAAA,CAAqBnB,UAAAA,CAAW,kBAAkB,CAAA,CAClD,QAASmB,CAAAA,EAAS,CACjB,GAAIA,CAAAA,CAAK,cAAA,EAAe,EAAG,OAAOnB,UAAAA,CAAW,cAAc,CAAA,CAAG,CAC5D,IAAMqC,CAAAA,CAAiBlB,CAAAA,CAAK,oBAAA,CAC1BnB,UAAAA,CAAW,cACb,CAAA,CACIqC,CAAAA,EAEFA,CAAAA,CAAe,YAAA,GAAe,OAAA,CAASN,CAAAA,EAAQ,CACzCA,CAAAA,CAAI,MAAA,CAAO/B,UAAAA,CAAW,qBAAqB,CAAA,EAC7C+B,CAAAA,CACG,iBAAA,CAAkB/B,UAAAA,CAAW,aAAa,CAAA,CAC1C,QAASmB,CAAAA,EAAS,CACjBA,CAAAA,CAAK,eAAA,CACH,CAAA,CAAA,EAAIgB,CAAAA,CACFhB,EAAK,OAAA,EAAQ,EAAG,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAA,CAClClJ,EAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,CAAA,CAAA,CACH,EACF,CAAC,CAAA,CAGDyG,CAAAA,CAAI,MAAA,CAAO/B,UAAAA,CAAW,aAAa,CAAA,EACrC+B,EAAI,eAAA,CACF,CAAA,CAAA,EAAII,CAAAA,CACFJ,CAAAA,CAAI,OAAA,EAAQ,EAAG,QAAQ,MAAA,CAAQ,EAAE,CAAA,CACjC9J,CAAAA,CAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,CAAA,CAAA,CACH,EAEJ,CAAC,EAEL,CAEA,GAAI6F,CAAAA,CAAK,cAAA,EAAe,EAAG,MAAA,CAAOnB,UAAAA,CAAW,aAAa,GACpDmB,CAAAA,CAAK,WAAA,EAAY,CAAE,OAAA,EAAQ,GAAM,SAAA,CAAW,CAC9C,IAAMiB,CAAAA,CAAajB,CAAAA,CAAK,cAAA,EAAe,CACnCiB,CAAAA,EACFA,EAAW,eAAA,CACT,CAAA,CAAA,EAAID,CAAAA,CACFC,CAAAA,CAAW,OAAA,EAAQ,EAAG,QAAQ,MAAA,CAAQ,EAAE,CAAA,CACxCnK,CAAAA,CAAO,QAAA,CAAS,MAAA,CAChBqD,CACF,CAAC,CAAA,CAAA,CACH,EAEJ,CAEJ,CAAC,EAGT,CAAC,CAAA,CAEMmE,CACT,CAAA,CAEO,SAAS0C,CAAAA,CACdG,CAAAA,CACA3E,CAAAA,CAAiB,GACjBrC,CAAAA,CACA,CACA,OAAIA,CAAAA,GAAoB,IAAA,CACfgH,CAAAA,CACJ,MAAM,GAAG,CAAA,CACT,GAAA,CAAKrB,CAAAA,EAAc,CAClB,GAAM,CAAC3C,CAAAA,CAASvJ,CAAAA,CAAOwN,CAAQ,CAAA,CAAIC,CAAAA,CAAevB,CAAS,EAC3D,OAAI3C,CAAAA,CACKiE,CAAAA,CACH,CAAA,EAAGjE,CAAO,CAAA,CAAA,EAAIX,CAAM,CAAA,EAAG5I,CAAK,CAAA,CAAA,EAAIwN,CAAQ,CAAA,CAAA,CACxC,CAAA,EAAGjE,CAAO,CAAA,CAAA,EAAIX,CAAM,CAAA,EAAG5I,CAAK,CAAA,CAAA,CAEzBwN,CAAAA,CACH,GAAG5E,CAAM,CAAA,EAAG5I,CAAK,CAAA,CAAA,EAAIwN,CAAQ,CAAA,CAAA,CAC7B,CAAA,EAAG5E,CAAM,CAAA,EAAG5I,CAAK,CAAA,CAEzB,CAAC,CAAA,CACA,IAAA,CAAK,GAAG,CAAA,CAGNuN,CAAAA,CACJ,KAAA,CAAM,GAAG,CAAA,CACT,GAAA,CAAKrB,GACJA,CAAAA,CAAU,OAAA,CAAQ,CAAA,EAAGtD,CAAM,CAAA,CAAA,CAAG,CAAA,GAAM,EAChCsD,CAAAA,CACA,CAAA,EAAGtD,CAAM,CAAA,CAAA,EAAIsD,CAAAA,CAAU,IAAA,EAAM,CAAA,CACnC,CAAA,CACC,IAAA,CAAK,GAAG,CACb,CCxLA,IAAMwB,EAAAA,CAAU,IAAIC,OAAAA,CAAQ,CAC1B,eAAA,CAAiB,EACnB,CAAC,CAAA,CAED,eAAeC,EAAAA,CAAqBC,CAAAA,CAAkB,CACpD,IAAMC,CAAAA,CAAM,MAAM9H,QAAAA,CAAG,OAAA,CAAQhC,UAAAA,CAAK,IAAA,CAAK+J,MAAAA,EAAO,CAAG,SAAS,CAAC,CAAA,CAC3D,OAAO/J,UAAAA,CAAK,IAAA,CAAK8J,EAAKD,CAAQ,CAChC,CAEA,eAAsBG,EAAAA,CACpBC,CAAAA,CACAC,EAA8B,CAC5BzD,EAAAA,CACAoB,EAAAA,CACAsC,CAAAA,CACAjB,EAAAA,CACAkB,CAAAA,CACAC,EACApB,EACF,CAAA,CACA,CACA,IAAMqB,CAAAA,CAAW,MAAMV,GAAqBK,CAAAA,CAAK,QAAQ,CAAA,CACnDvD,CAAAA,CAAagD,EAAAA,CAAQ,gBAAA,CAAiBY,EAAUL,CAAAA,CAAK,GAAA,CAAK,CAC9D,UAAA,CAAYM,UAAAA,CAAW,GACzB,CAAC,CAAA,CAED,IAAA,IAAWC,CAAAA,IAAeN,CAAAA,CACxB,MAAMM,CAAAA,CAAY,CAAE,UAAA,CAAA9D,CAAAA,CAAY,GAAGuD,CAAK,CAAC,CAAA,CAG3C,OAAIA,CAAAA,CAAK,YAAA,CACA,MAAM5C,EAAAA,CAAa,CACxB,UAAA,CAAAX,EACA,GAAGuD,CACL,CAAC,CAAA,CAGIvD,CAAAA,CAAW,OAAA,EACpB,CCjEA,IAAM+D,GAAyC,CAC7C,GAAA,CACA,MAAA,CACA,KAAA,CACA,MAAA,CACA,OAAA,CACA,OACF,CAAA,CAWaC,EAAAA,CAAgC,MAAO,CAAE,UAAA,CAAAhE,CAAAA,CAAY,OAAAxH,CAAO,CAAA,GAAM,CAE7E,GAAI,CAACA,CAAAA,CAAO,OAAO,UAAA,CAAW,OAAO,CAAA,CACnC,OAAOwH,CAAAA,CAMT,IAAMiE,EAAiB,EAAA,CACvB,IAAA,IAASC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAID,CAAAA,CAAgBC,CAAAA,EAAAA,CAAK,CAIvC,IAAMC,CAAAA,CAHcnE,CAAAA,CAAW,oBAAA,CAAqBO,UAAAA,CAAW,UAAU,EAGrC,MAAA,CAAQ6D,CAAAA,EAC1CA,CAAAA,CAAG,iBAAA,EAAkB,CAAE,YAAA,CAAa,SAAS,CAC/C,CAAA,CAEA,GAAID,CAAAA,CAAgB,MAAA,GAAW,CAAA,CAC7B,MAIF,IAAME,CAAAA,CAAeF,CAAAA,CAAgB,MAAA,CAAQC,CAAAA,EAEpC,CADaA,EAAG,oBAAA,CAAqB7D,UAAAA,CAAW,UAAU,CAAA,CAC7C,IAAA,CAAM+D,CAAAA,EACxBA,EAAE,iBAAA,EAAkB,CAAE,YAAA,CAAa,SAAS,CAC9C,CACD,EAIKC,CAAAA,CAAmC,EAAC,CAE1C,IAAA,IAAWC,CAAAA,IAAcH,CAAAA,CAAc,CACrC,IAAMI,CAAAA,CAAiBD,CAAAA,CAAW,iBAAA,EAAkB,CAC9CE,CAAAA,CAAcD,EAAe,YAAA,CAAa,SAAS,CAAA,CAEzD,GAAI,CAACC,CAAAA,CACH,SAGF,IAAMC,CAAAA,CAAgBF,CAAAA,CAAe,cAAA,EAAe,CAAE,OAAA,GAIhDG,CAAAA,CAHWJ,CAAAA,CAAW,cAAA,EAAe,CAGb,IAAA,CAC3BK,CAAAA,EACCA,EAAM,OAAA,EAAQ,GAAMtE,UAAAA,CAAW,UAAA,EAC/BsE,CAAAA,CAAM,OAAA,KAActE,UAAAA,CAAW,qBACnC,CAAA,CAEA,GAAI,CAACqE,CAAAA,CAAc,CAEjBF,CAAAA,CAAY,MAAA,EAAO,CACnB,QACF,CAGA,IAAII,EACAC,CAAAA,CACAC,CAAAA,CAEJ,GAAIJ,CAAAA,CAAa,OAAA,EAAQ,GAAMrE,WAAW,qBAAA,CAAuB,CAC/D,IAAM0E,CAAAA,CAAcL,CAAAA,CAAa,aAAA,CAC/BrE,UAAAA,CAAW,qBACb,CAAA,CACAuE,CAAAA,CAAeG,CAAAA,CAAY,cAAA,EAAe,CAAE,OAAA,GAC5CF,CAAAA,CAAaE,CAAAA,CACV,aAAA,EAAc,CACd,GAAA,CAAK/C,CAAAA,EAASA,EAAK,OAAA,EAAS,CAAA,CAC5B,IAAA,CAAK,GAAG,CAAA,CACX8C,EAAgB,GAClB,CAAA,KAAO,CACL,IAAME,CAAAA,CAAWN,CAAAA,CAAa,cAAcrE,UAAAA,CAAW,UAAU,CAAA,CAC3D4E,CAAAA,CAAYD,CAAAA,CAAS,iBAAA,GAC3BJ,CAAAA,CAAeK,CAAAA,CAAU,cAAA,EAAe,CAAE,OAAA,EAAQ,CAClDJ,EAAaI,CAAAA,CACV,aAAA,EAAc,CACd,GAAA,CAAKjD,CAAAA,EAASA,CAAAA,CAAK,SAAS,CAAA,CAC5B,IAAA,CAAK,GAAG,CAAA,CAEX8C,CAAAA,CAAgBE,EACb,cAAA,EAAe,CACf,GAAA,CAAKE,CAAAA,EAAMA,CAAAA,CAAE,OAAA,EAAS,CAAA,CACtB,IAAA,CAAK,EAAE,EACZ,CAIA,IAAMC,EACJV,CAAAA,GAAkB,QAAA,EAClBZ,EAAAA,CAAuC,QAAA,CAASe,CAAY,CAAA,CAE9DP,EAAgB,IAAA,CAAK,CACnB,aAAA,CAAeC,CAAAA,CACf,aAAA,CAAAG,CAAAA,CACA,aAAAG,CAAAA,CACA,UAAA,CAAAC,CAAAA,CACA,aAAA,CAAAC,CAAAA,CACA,iBAAA,CAAAK,CACF,CAAC,EACH,CAGA,IAAA,IAAWC,CAAAA,IAAQf,CAAAA,CAAgB,SAAQ,CAAG,CAI5C,IAAMgB,CAAAA,CAHiBD,CAAAA,CAAK,aAAA,CAAc,mBAAkB,CAIzD,aAAA,EAAc,CACd,MAAA,CAAQpD,CAAAA,EACHA,CAAAA,CAAK,OAAA,EAAQ,GAAM3B,UAAAA,CAAW,YAAA,CAChB2B,CAAAA,CAAK,aAAA,CAAc3B,UAAAA,CAAW,YAAY,EAC3C,WAAA,EAAY,CAAE,OAAA,EAAQ,GAAM,SAAA,CAEtC,IACR,EACA,GAAA,CAAK2B,CAAAA,EAASA,CAAAA,CAAK,OAAA,EAAS,CAAA,CAC5B,KAAK,GAAG,CAAA,CAGLsD,CAAAA,CAAcF,CAAAA,CAAK,UAAA,CACrB,CAAA,EAAA,EAAKA,EAAK,YAAY,CAAA,CAAA,EAAIA,CAAAA,CAAK,UAAU,CAAA,IAAA,CAAA,CACzC,CAAA,EAAA,EAAKA,EAAK,YAAY,CAAA,IAAA,CAAA,CAGtBG,CAAAA,CAAWF,CAAAA,CAAgB,CAAA,EAAGA,CAAa,IAAM,EAAA,CACrDE,CAAAA,EAAY,CAAA,OAAA,EAAUD,CAAW,CAAA,CAAA,CAC7BF,CAAAA,CAAK,oBACPG,CAAAA,EAAY,uBAAA,CAAA,CAId,IAAMC,CAAAA,CAAcJ,CAAAA,CAAK,aAAA,CAAc,IAAA,EAAK,CACxC,CAAA,EAAGA,CAAAA,CAAK,aAAa,CAAA,CAAA,CACrB,EAAA,CAEEK,CAAAA,CAAiB,IAAIL,CAAAA,CAAK,aAAa,CAAA,CAAA,EAAIG,CAAQ,CAAA,CAAA,EAAIC,CAAW,KAAKJ,CAAAA,CAAK,aAAa,CAAA,CAAA,CAAA,CAE/FA,CAAAA,CAAK,aAAA,CAAc,eAAA,CAAgBK,CAAc,EACnD,CACF,CAEA,OAAO3F,CACT,CAAA,CCtKO,IAAM4F,EAAAA,CAA6B,MAAO,CAAE,UAAA,CAAA5F,CAAW,CAAA,IAE5DA,EAAW,YAAA,EAAa,CAAE,OAAA,CAAS6F,CAAAA,EAAS,CACtCA,CAAAA,CAAK,SAAQ,GAAM,YAAA,EACrBA,CAAAA,CAAK,MAAA,CAAO,OAAO,EAEvB,CAAC,CAAA,CAGD7F,CAAAA,CAAW,uBAAA,EAAwB,CAAE,OAAA,CAAS8F,CAAAA,EAAa,CACrDA,CAAAA,CAAS,OAAA,EAAQ,GAAM,YAAA,EACzBA,CAAAA,CAAS,MAAA,CAAO,OAAO,EAE3B,CAAC,CAAA,CAGD9F,CAAAA,CAAW,qBAAA,EAAsB,CAAE,OAAA,CAAS+F,GAAe,CACpCA,CAAAA,CAAW,eAAA,EAAgB,CACnC,OAAA,CAASC,CAAAA,EAAgB,CAChCA,CAAAA,CAAY,OAAA,EAAQ,GAAM,YAAA,EAC5BA,CAAAA,CAAY,OAAA,CAAQ,OAAO,CAAA,CAEXA,CAAAA,CAAY,YAAA,EAAa,EAC5B,OAAA,EAAQ,GAAM,cAC3BA,CAAAA,CAAY,QAAA,CAAS,OAAO,EAEhC,CAAC,EACH,CAAC,CAAA,CAEMhG,CAAAA,CAAAA,CCIT,eAAsBiG,EAAAA,CACpBjJ,CAAAA,CACAxE,CAAAA,CACAxC,CAAAA,CASA,CACA,GAAI,CAACgH,CAAAA,EAAO,MAAA,CACV,OAAO,CACL,aAAc,EAAC,CACf,YAAA,CAAc,EAAC,CACf,YAAA,CAAc,EAChB,CAAA,CAEFhH,CAAAA,CAAU,CACR,SAAA,CAAW,KAAA,CACX,MAAO,KAAA,CACP,MAAA,CAAQ,KAAA,CACR,QAAA,CAAU,KAAA,CACV,WAAA,CAAa,MACb,GAAGA,CACL,CAAA,CACA,IAAMkQ,CAAAA,CAAsBtG,CAAAA,CAAQ,kBAAmB,CACrD,MAAA,CAAQ5J,CAAAA,CAAQ,MAClB,CAAC,CAAA,EAAG,OAAM,CAEJ,CAACuH,CAAAA,CAAa4I,CAAS,CAAA,CAAI,MAAM,OAAA,CAAQ,GAAA,CAAI,CACjDpL,CAAAA,CAAevC,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CACvCA,EAAO,QAAA,CAAS,SAAA,CACZ4N,EAAAA,CAAqB5N,CAAAA,CAAO,QAAA,CAAS,SAAS,EAC9C,OAAA,CAAQ,OAAA,CAAQ,MAAS,CAC/B,CAAC,CAAA,CAEG6N,EAAyB,EAAC,CAC1BC,GAAAA,CAAyB,EAAC,CAC1BC,CAAAA,CAAyB,EAAC,CAC1BC,CAAAA,CAAyB,EAAC,CAC1BC,GAAAA,CAAyB,IAAA,CAE7B,QAASC,CAAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAQ1J,CAAAA,CAAM,MAAA,CAAQ0J,CAAAA,EAAAA,CAAS,CACjD,IAAMnK,CAAAA,CAAOS,CAAAA,CAAM0J,CAAK,CAAA,CACxB,GAAI,CAACnK,CAAAA,CAAK,OAAA,CACR,SAGF,IAAIzF,CAAAA,CAAW6P,EAAAA,CAAgBpK,EAAM/D,CAAAA,CAAQ,CAC3C,QAAA,CAAU+E,CAAAA,EAAa,QAAA,CACvB,SAAA,CAAWA,GAAa,SAAA,CAAU,IAAA,CAClC,UAAA,CAAYnD,EAAAA,CACV4C,CAAAA,CAAM,GAAA,CAAK4J,GAAMA,CAAAA,CAAE,IAAI,CAAA,CACvBrK,CAAAA,CAAK,IACP,CAAA,CACA,KAAMvG,CAAAA,CAAQ,IAAA,CACd,SAAA,CAAW0Q,CACb,CAAC,CAAA,CAED,GAAI,CAAC5P,CAAAA,CACH,SAGF,IAAM2H,CAAAA,CAAWoI,QAAAA,CAAStK,EAAK,IAAI,CAAA,CAC7BoC,CAAAA,CAAYrF,UAAAA,CAAK,OAAA,CAAQxC,CAAQ,EAQvC,GANK0B,CAAAA,CAAO,GAAA,GACV1B,CAAAA,CAAWA,CAAAA,CAAS,OAAA,CAAQ,UAAYlB,CAAAA,EACtCA,CAAAA,GAAU,MAAA,CAAS,MAAA,CAAS,KAC9B,CAAA,CAAA,CAGE4I,CAAAA,CAAU1H,CAAQ,CAAA,EAAK,CAACgI,UAAAA,CAAWhI,CAAQ,CAAA,CAAG,CAChD,IAAMgQ,CAAAA,CAAqBpI,EAAAA,CAAoBC,CAAS,CAAA,CACpDmI,CAAAA,GACFhQ,CAAAA,CAAWgQ,GAEf,CAEA,IAAMC,CAAAA,CAAejI,UAAAA,CAAWhI,CAAQ,CAAA,CAGxC,GAAIiQ,CAAAA,EAAgBC,QAAAA,CAASlQ,CAAQ,CAAA,CAAE,WAAA,EAAY,CACjD,MAAM,IAAI,KAAA,CACR,CAAA,gBAAA,EAAmBA,CAAQ,CAAA,qEAAA,CAC7B,CAAA,CAOF,IAAMmQ,CAAAA,CACJ1K,CAAAA,CAAK,IAAA,GAAS,eAAA,EAAmBA,CAAAA,CAAK,IAAA,GAAS,gBAC3C0B,CAAAA,CACJO,CAAAA,CAAU1H,CAAQ,CAAA,EAAKmQ,CAAAA,CACnB1K,CAAAA,CAAK,QACL,MAAM+G,EAAAA,CACJ,CACE,QAAA,CAAU/G,CAAAA,CAAK,IAAA,CACf,IAAKA,CAAAA,CAAK,OAAA,CACV,MAAA,CAAA/D,CAAAA,CACA,SAAA,CAAA2N,CAAAA,CACA,aAAc,CAAC3N,CAAAA,CAAO,GAAA,CACtB,QAAA,CAAUxC,CAAAA,CAAQ,QACpB,EACA,CACE+J,EAAAA,CACAoB,EAAAA,CACAsC,CAAAA,CACAjB,EAAAA,CACAmB,CAAAA,CACAuD,IACAlD,EAAAA,CACAN,CAAAA,CACA,GAAIyD,EAAAA,CAAoBrQ,CAAAA,CAAUyG,CAAAA,CAAa/E,CAAM,CAAA,CACjD,CAACoN,EAAa,CAAA,CACd,EAAC,CACLrD,EACF,CACF,CAAA,CAIN,GAAIwE,CAAAA,EAAgB,CAACvI,CAAAA,CAAU1H,CAAQ,CAAA,CAAG,CACxC,IAAMsQ,CAAAA,CAAsB,MAAM9L,QAAAA,CAAG,SAASxE,CAAAA,CAAU,OAAO,CAAA,CAE/D,GACE2G,EAAAA,CAAc2J,CAAAA,CAAqBnJ,CAAAA,CAAS,CAG1C,aAAA,CAAejI,CAAAA,CAAQ,WACzB,CAAC,CAAA,CACD,CACAuQ,EAAa,IAAA,CAAKjN,UAAAA,CAAK,QAAA,CAASd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,CACnE,QACF,CACF,CAGA,GAAIiQ,GAAgB,CAAC/Q,CAAAA,CAAQ,SAAA,EAAa,CAACwI,CAAAA,CAAU1H,CAAQ,EAAG,CAC9DoP,CAAAA,CAAoB,IAAA,EAAK,CACrBlQ,CAAAA,CAAQ,WAAA,EACVA,EAAQ,WAAA,CAAY,IAAA,EAAK,CAE3B,GAAM,CAAE,SAAA,CAAAqR,CAAU,CAAA,CAAI,MAAMC,EAAAA,CAAQ,CAClC,IAAA,CAAM,SAAA,CACN,KAAM,WAAA,CACN,OAAA,CAAS,CAAA,SAAA,EAAYrP,CAAAA,CAAY,IAAA,CAC/BwG,CACF,CAAC,CAAA,6CAAA,CAAA,CACD,OAAA,CAAS,KACX,CAAC,CAAA,CAED,GAAI,CAAC4I,CAAAA,CAAW,CACdd,CAAAA,CAAa,IAAA,CAAKjN,UAAAA,CAAK,QAAA,CAASd,EAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,CAC/Dd,CAAAA,CAAQ,aACVA,CAAAA,CAAQ,WAAA,CAAY,KAAA,EAAM,CAE5B,QACF,CACAkQ,GAAqB,KAAA,EAAM,CACvBlQ,CAAAA,CAAQ,WAAA,EACVA,CAAAA,CAAQ,WAAA,CAAY,QAExB,CAaA,GAVImR,EAAAA,CAAoBrQ,CAAAA,CAAUyG,CAAAA,CAAa/E,CAAM,CAAA,GACnD1B,CAAAA,CAAWA,CAAAA,CAAS,OAAA,CAAQ,sBAAA,CAAwB,UAAU,GAI3DgI,UAAAA,CAAWH,CAAS,CAAA,EACvB,MAAMrD,QAAAA,CAAG,KAAA,CAAMqD,CAAAA,CAAW,CAAE,SAAA,CAAW,IAAK,CAAC,CAAA,CAI3CH,CAAAA,CAAU1H,CAAQ,GAAKiQ,CAAAA,CAAc,CACvC,IAAMK,CAAAA,CAAsB,MAAM9L,QAAAA,CAAG,SAASxE,CAAAA,CAAU,OAAO,CAAA,CACzDyQ,CAAAA,CAAgB9H,EAAAA,CAAgB2H,CAAAA,CAAqBnJ,CAAO,CAAA,CAIlE,GAHAuI,CAAAA,CAAenH,EAAAA,CAAc+H,CAAAA,CAAqBnJ,CAAO,EACzDwI,GAAAA,CAAUnN,UAAAA,CAAK,QAAA,CAASd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAA,CAEtD,CAAC0P,CAAAA,CAAa,MAAA,CAAQ,CACxBD,CAAAA,CAAa,KAAKjN,UAAAA,CAAK,QAAA,CAASd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,CACnE,QACF,CAEA,MAAMwE,QAAAA,CAAG,SAAA,CAAUxE,EAAUyQ,CAAAA,CAAe,OAAO,CAAA,CACnDjB,GAAAA,CAAa,IAAA,CAAKhN,UAAAA,CAAK,SAASd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,CACnE,QACF,CAEA,MAAMwE,QAAAA,CAAG,SAAA,CAAUxE,CAAAA,CAAUmH,CAAAA,CAAS,OAAO,CAAA,CAGxC8I,CAAAA,CAQHT,GAAAA,CAAa,IAAA,CAAKhN,UAAAA,CAAK,QAAA,CAASd,EAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,EAPnEuP,CAAAA,CAAa,KAAK/M,UAAAA,CAAK,QAAA,CAASd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,CAE/D0H,CAAAA,CAAU1H,CAAQ,CAAA,GACpB0P,CAAAA,CAAe,MAAA,CAAO,KAAKzH,EAAAA,CAAgBd,CAAO,CAAC,CAAA,CACnDwI,GAAAA,CAAUnN,UAAAA,CAAK,QAAA,CAASd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAA,CAAA,EAKhE,CAEA,IAAM0Q,IAAW,CAAC,GAAGnB,CAAAA,CAAc,GAAGC,GAAAA,CAAc,GAAGC,CAAY,CAAA,CAC7DkB,CAAAA,CAAe,MAAMC,EAAAA,CAAeF,GAAAA,CAAUhP,CAAM,EAkB1D,GAfA8N,GAAAA,CAAa,IAAA,CAAK,GAAGmB,CAAY,CAAA,CAGjCnB,IAAeA,GAAAA,CAAa,MAAA,CAAQ/J,CAAAA,EAAS,CAAC8J,CAAAA,CAAa,QAAA,CAAS9J,CAAI,CAAC,CAAA,CAGrE,EADoB8J,CAAAA,CAAa,MAAA,EAAUC,GAAAA,CAAa,SACpC,CAACC,CAAAA,CAAa,MAAA,EACpCL,CAAAA,EAAqB,IAAA,CAAK,mBAAmB,EAI/CG,CAAAA,CAAe,KAAA,CAAM,IAAA,CAAK,IAAI,GAAA,CAAIA,CAAY,CAAC,CAAA,CAC/CC,GAAAA,CAAe,KAAA,CAAM,IAAA,CAAK,IAAI,GAAA,CAAIA,GAAY,CAAC,CAAA,CAC/CC,CAAAA,CAAe,KAAA,CAAM,IAAA,CAAK,IAAI,IAAIA,CAAY,CAAC,CAAA,CAE3CF,CAAAA,CAAa,MAAA,CAAA,CAMf,GALAH,GAAqB,OAAA,CACnB,CAAA,QAAA,EAAWG,CAAAA,CAAa,MAAM,CAAA,CAAA,EAC5BA,CAAAA,CAAa,SAAW,CAAA,CAAI,MAAA,CAAS,OACvC,CAAA,CAAA,CACF,CAAA,CACI,CAACrQ,EAAQ,MAAA,CACX,IAAA,IAAWuG,CAAAA,IAAQ8J,CAAAA,CACjB3G,CAAAA,CAAO,GAAA,CAAI,OAAOnD,CAAI,CAAA,CAAE,EAAA,CAAA,KAI5B2J,CAAAA,EAAqB,IAAA,EAAK,CAG5B,GAAII,GAAAA,CAAa,MAAA,GACf1G,CAAAA,CACE,CAAA,QAAA,EAAW0G,GAAAA,CAAa,MAAM,CAAA,CAAA,EAC5BA,GAAAA,CAAa,MAAA,GAAW,CAAA,CAAI,MAAA,CAAS,OACvC,CAAA,CAAA,CAAA,CACA,CACE,OAAQtQ,CAAAA,CAAQ,MAClB,CACF,CAAA,EAAG,IAAA,EAAK,CACJ,CAACA,CAAAA,CAAQ,MAAA,CAAA,CACX,IAAA,IAAWuG,CAAAA,IAAQ+J,GAAAA,CACjB5G,CAAAA,CAAO,IAAI,CAAA,IAAA,EAAOnD,CAAI,CAAA,CAAE,CAAA,CAK9B,GAAIgK,CAAAA,CAAa,SACf3G,CAAAA,CACE,CAAA,QAAA,EAAW2G,CAAAA,CAAa,MAAM,CAAA,CAAA,EAC5BD,GAAAA,CAAa,SAAW,CAAA,CAAI,MAAA,CAAS,OACvC,CAAA,0DAAA,CAAA,CACA,CACE,MAAA,CAAQtQ,EAAQ,MAClB,CACF,CAAA,EAAG,IAAA,EAAK,CACJ,CAACA,EAAQ,MAAA,CAAA,CACX,IAAA,IAAWuG,CAAAA,IAAQgK,CAAAA,CACjB7G,CAAAA,CAAO,GAAA,CAAI,OAAOnD,CAAI,CAAA,CAAE,CAAA,CAK9B,GAAIiK,CAAAA,CAAa,MAAA,EAAUC,MACzB7G,CAAAA,CACE,CAAA,iCAAA,EAAoC3H,CAAAA,CAAY,IAAA,CAAKwO,GAAO,CAAC,GAC/D,CAAA,EAAG,IAAA,EAAK,CACJ,CAACzQ,CAAAA,CAAQ,MAAA,CAAA,CACX,QAAWR,CAAAA,IAAOgR,CAAAA,CAChB9G,CAAAA,CAAO,GAAA,CAAI,CAAA,EAAA,EAAKzH,CAAAA,CAAY,QAAQ,GAAG,CAAC,CAAA,CAAA,EAAIzC,CAAG,CAAA,CAAE,CAAA,CAKvD,OAAKQ,CAAAA,CAAQ,MAAA,EACX0J,CAAAA,CAAO,KAAA,EAAM,CAGR,CACL,aAAA2G,CAAAA,CACA,YAAA,CAAAC,GAAAA,CACA,YAAA,CAAAC,CACF,CACF,CAEO,SAASI,EAAAA,CACdpK,CAAAA,CACA/D,CAAAA,CACAxC,CAAAA,CAOA,CAEA,GAAIA,CAAAA,CAAQ,IAAA,CAAM,CAChB,IAAM8D,CAAAA,CAAeR,UAAAA,CAAK,UAAA,CAAWtD,EAAQ,IAAI,CAAA,CAC7CA,CAAAA,CAAQ,IAAA,CACRsD,UAAAA,CAAK,IAAA,CAAKd,EAAO,aAAA,CAAc,GAAA,CAAKxC,CAAAA,CAAQ,IAAI,CAAA,CAIpD,GAFmB,aAAa,IAAA,CAAK8D,CAAY,CAAA,CAAA,CAK/C,GAAI9D,CAAAA,CAAQ,SAAA,GAAc,EACxB,OAAO8D,CAAAA,CAAAA,KAEJ,CAGL,IAAM2E,CAAAA,CAAWnF,UAAAA,CAAK,SAASiD,CAAAA,CAAK,IAAI,CAAA,CACxC,OAAOjD,UAAAA,CAAK,IAAA,CAAKQ,EAAc2E,CAAQ,CACzC,CACF,CAEA,GAAIlC,CAAAA,CAAK,OAAQ,CACf,GAAIA,CAAAA,CAAK,MAAA,CAAO,UAAA,CAAW,IAAI,CAAA,CAC7B,OAAOjD,UAAAA,CAAK,IAAA,CAAKd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK+D,CAAAA,CAAK,OAAO,OAAA,CAAQ,IAAA,CAAM,EAAE,CAAC,CAAA,CAG1E,IAAIoL,EAASpL,CAAAA,CAAK,MAAA,CAElB,OAAIA,CAAAA,CAAK,IAAA,GAAS,eAAA,GAChBoL,EAASC,EAAAA,CAAkBD,CAAAA,CAAQ3R,CAAAA,CAAQ,SAAS,CAAA,CAChD,CAAC2R,GACI,EAAA,CAIJ3R,CAAAA,CAAQ,QAAA,CACXsD,UAAAA,CAAK,IAAA,CAAKd,CAAAA,CAAO,cAAc,GAAA,CAAK,KAAA,CAAOmP,CAAAA,CAAO,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAC,CAAA,CACrErO,UAAAA,CAAK,IAAA,CAAKd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAKmP,EAAO,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAC,CACpE,CAEA,IAAMhJ,CAAAA,CAAYkJ,EAAAA,CAA2BtL,CAAAA,CAAM/D,CAAM,CAAA,CAEnD6B,CAAAA,CAAeyN,EAAAA,CAAsBvL,EAAK,IAAA,CAAMoC,CAAS,CAAA,CAC/D,OAAOrF,UAAAA,CAAK,IAAA,CAAKqF,EAAWtE,CAAY,CAC1C,CAEA,SAASwN,EAAAA,CACPtL,CAAAA,CACA/D,EACA,CACA,OAAI+D,CAAAA,CAAK,IAAA,GAAS,aAAA,CACT/D,CAAAA,CAAO,cAAc,EAAA,CAG1B+D,CAAAA,CAAK,IAAA,GAAS,cAAA,CACT/D,CAAAA,CAAO,aAAA,CAAc,IAG1B+D,CAAAA,CAAK,IAAA,GAAS,gBAAA,EAAoBA,CAAAA,CAAK,IAAA,GAAS,oBAAA,CAC3C/D,EAAO,aAAA,CAAc,UAAA,CAG1B+D,CAAAA,CAAK,IAAA,GAAS,eAAA,CACT/D,CAAAA,CAAO,cAAc,KAAA,CAGvBA,CAAAA,CAAO,aAAA,CAAc,UAC9B,CAEO,SAAS4B,GAAe+C,CAAAA,CAAiB4K,CAAAA,CAAwB,CAEtE,IAAMC,CAAAA,CAAkB7K,CAAAA,CAAM,IAAK8K,CAAAA,EAAMA,CAAAA,CAAE,OAAA,CAAQ,KAAA,CAAO,EAAE,CAAC,EACvDC,CAAAA,CAAmBH,CAAAA,CAAO,OAAA,CAAQ,KAAA,CAAO,EAAE,CAAA,CAG3CI,EAAYD,CAAAA,CAAiB,KAAA,CAAM,GAAG,CAAA,CAAE,KAAA,CAAM,CAAA,CAAG,EAAE,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,CAGnE,GAAI,CAACC,EACH,OAAO,EAAA,CAIT,IAAMC,CAAAA,CAAiBD,CAAAA,CAAU,KAAA,CAAM,GAAG,CAAA,CAG1C,IAAA,IAASjE,CAAAA,CAAIkE,CAAAA,CAAe,MAAA,CAAQlE,CAAAA,CAAI,EAAGA,CAAAA,EAAAA,CAAK,CAC9C,IAAMmE,CAAAA,CAAWD,CAAAA,CAAe,KAAA,CAAM,CAAA,CAAGlE,CAAC,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,CAKpD,GAHwB8D,CAAAA,CAAgB,KACrC1O,CAAAA,EAASA,CAAAA,GAAS4O,CAAAA,EAAoB5O,CAAAA,CAAK,UAAA,CAAW+O,CAAAA,CAAW,GAAG,CACvE,CAAA,CAEE,OAAO,GAAA,CAAMA,CAEjB,CAGA,OAAO,GAAA,CAAMF,CACf,CAEO,SAASL,EAAAA,CACdhR,CAAAA,CACA6H,EACQ,CAER,IAAM2J,CAAAA,CAAqBxR,CAAAA,CAAS,OAAA,CAAQ,UAAA,CAAY,EAAE,CAAA,CACpDyR,CAAAA,CAAsB5J,CAAAA,CAAU,OAAA,CAAQ,UAAA,CAAY,EAAE,EAGtD6J,CAAAA,CAAeF,CAAAA,CAAmB,KAAA,CAAM,GAAG,CAAA,CAC3CG,CAAAA,CAAiBF,EAAoB,KAAA,CAAM,GAAG,CAAA,CAG9CG,CAAAA,CAAoBD,CAAAA,CAAeA,CAAAA,CAAe,OAAS,CAAC,CAAA,CAC5DE,CAAAA,CAAiBH,CAAAA,CAAa,SAAA,CACjCI,CAAAA,EAAYA,IAAYF,CAC3B,CAAA,CAEA,OAAIC,CAAAA,GAAmB,EAAA,CAEdH,CAAAA,CAAaA,EAAa,MAAA,CAAS,CAAC,CAAA,CAItCA,CAAAA,CAAa,KAAA,CAAMG,CAAAA,CAAiB,CAAC,CAAA,CAAE,IAAA,CAAK,GAAG,CACxD,CAEO,SAASf,GACdD,CAAAA,CACAhL,CAAAA,CACA,CACA,GAAI,CAACA,CAAAA,CACH,OAAO,EAAA,CAGT,GAAIA,CAAAA,GAAc,UAAA,CAChB,OAAOgL,CAAAA,CAGT,GAAIhL,CAAAA,GAAc,YAAA,CAAc,CAC9B,IAAI1C,CAAAA,CAAS0N,CAAAA,CAAO,QAAQ,QAAA,CAAU,QAAQ,CAAA,CAC9C,OAAA1N,CAAAA,CAASA,CAAAA,CAAO,OAAA,CAAQ,oBAAA,CAAsB,IAAI,CAAA,CAE3CA,CACT,CAEA,GAAI0C,CAAAA,GAAc,eAAgB,CAChC,IAAI1C,CAAAA,CAAS0N,CAAAA,CAAO,OAAA,CAAQ,QAAA,CAAU,aAAa,CAAA,CACnD,OAAA1N,CAAAA,CAASA,CAAAA,CAAO,OAAA,CAAQ,oBAAA,CAAsB,IAAI,CAAA,CAE3CA,CACT,CAEA,GAAI0C,CAAAA,GAAc,SAAA,CAAW,CAC3B,IAAI1C,CAAAA,CAAS0N,CAAAA,CAAO,OAAA,CAAQ,QAAA,CAAU,qBAAqB,EAC3D,OAAA1N,CAAAA,CAASA,CAAAA,CAAO,OAAA,CAAQ,oBAAA,CAAsB,IAAI,EAE3CA,CACT,CAEA,OAAO,EACT,CAEA,eAAeyN,GAAemB,CAAAA,CAAqBrQ,CAAAA,CAAgB,CACjE,IAAMwK,CAAAA,CAAU,IAAIC,QAAQ,CAC1B,eAAA,CAAiB,EACnB,CAAC,CAAA,CACK1F,EAAc,MAAMxC,CAAAA,CAAevC,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CAC3DW,EAAWC,UAAAA,CAAWZ,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CAC9CiP,CAAAA,CAAe,EAAC,CAEtB,GAAI,CAAClK,CAAAA,EAAepE,CAAAA,CAAS,UAAA,GAAe,SAC1C,OAAO,EAAC,CAGV,IAAA,IAAW2P,CAAAA,IAAYD,CAAAA,CAAW,CAChC,IAAM/O,CAAAA,CAAeR,UAAAA,CAAK,OAAA,CAAQd,CAAAA,CAAO,aAAA,CAAc,IAAKsQ,CAAQ,CAAA,CAGpE,GAAI,CAAChK,UAAAA,CAAWhF,CAAY,EAC1B,SAGF,IAAMmE,CAAAA,CAAU,MAAM3C,QAAAA,CAAG,QAAA,CAASxB,CAAAA,CAAc,OAAO,CAAA,CAEjDsJ,CAAAA,CAAM,MAAM9H,QAAAA,CAAG,OAAA,CAAQhC,UAAAA,CAAK,KAAK+J,MAAAA,EAAO,CAAG,SAAS,CAAC,CAAA,CACrDrD,CAAAA,CAAagD,EAAQ,gBAAA,CACzB1J,UAAAA,CAAK,IAAA,CAAK8J,CAAAA,CAAKyD,QAAAA,CAAS/M,CAAY,CAAC,CAAA,CACrCmE,CAAAA,CACA,CACE,UAAA,CAAY4F,UAAAA,CAAW,GACzB,CACF,CAAA,CAGA,GAAI,CAAC,CAAC,MAAA,CAAQ,KAAA,CAAO,OAAQ,KAAK,CAAA,CAAE,QAAA,CAAS7D,CAAAA,CAAW,YAAA,EAAc,EACpE,SAGF,IAAM+I,CAAAA,CAAqB/I,CAAAA,CAAW,qBAAA,EAAsB,CAC5D,QAAWgJ,CAAAA,IAAqBD,CAAAA,CAAoB,CAClD,IAAMtI,CAAAA,CAAkBuI,CAAAA,CAAkB,uBAAA,EAAwB,CAGlE,GACEzL,CAAAA,EAAa,WAAA,EACb,CAACkD,CAAAA,CAAgB,UAAA,CAAW,GAAGlD,CAAAA,CAAY,WAAW,CAAA,CAAA,CAAG,CAAA,CAEzD,SAKF,IAAM0L,EAAyB,MAAM3Q,CAAAA,CACnCmI,CAAAA,CACAtH,CACF,CAAA,CAEA,GAAI,CAAC8P,CAAAA,CACH,SAKF,IAAMC,CAAAA,CAAyBC,EAAAA,CAC7BF,CAAAA,CACAJ,EACArQ,CACF,CAAA,CAEA,GAAI,CAAC0Q,CAAAA,CACH,SAIF,IAAME,CAAAA,CAAYC,EAAAA,CAChBH,CAAAA,CACA1Q,CAAAA,CACA+E,CACF,CAAA,CAEI,CAAC6L,CAAAA,EAAaA,CAAAA,GAAc3I,CAAAA,GAIhCuI,CAAAA,CAAkB,kBAAA,CAAmBI,CAAS,EAG9C,MAAM9N,QAAAA,CAAG,SAAA,CAAUxB,CAAAA,CAAckG,CAAAA,CAAW,WAAA,EAAY,CAAG,OAAO,CAAA,CAGlEyH,CAAAA,CAAa,IAAA,CAAKqB,CAAQ,CAAA,EAC5B,CACF,CAEA,OAAOrB,CACT,CAOO,SAAS0B,EAAAA,CACdF,CAAAA,CACAjM,EACAxE,CAAAA,CACA8Q,CAAAA,CAAuB,CAAC,MAAA,CAAQ,KAAA,CAAO,KAAA,CAAO,OAAQ,MAAM,CAAA,CAC5D,CACA,IAAM5R,CAAAA,CAAM4B,UAAAA,CAAK,UAAUd,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CAG7C+Q,CAAAA,CAAgBvM,CAAAA,CAAM,IAAK4J,CAAAA,EAAMA,CAAAA,CAAE,KAAA,CAAMtN,UAAAA,CAAK,GAAG,CAAA,CAAE,KAAKA,UAAAA,CAAK,KAAA,CAAM,GAAG,CAAC,CAAA,CACvEkQ,CAAAA,CAAU,IAAI,GAAA,CAAID,CAAa,CAAA,CAG/BE,CAAAA,CAAYnQ,UAAAA,CAAK,OAAA,CAAQ2P,CAAsB,CAAA,CAC/CS,CAAAA,CAASD,CAAAA,GAAc,EAAA,CACvBE,CAAAA,CAAUD,CAAAA,CACZT,EAAuB,KAAA,CAAM,CAAA,CAAG,CAACQ,CAAAA,CAAU,MAAM,CAAA,CACjDR,EAIEW,CAAAA,CADatQ,UAAAA,CAAK,QAAA,CAAS5B,CAAAA,CAAKiS,CAAO,CAAA,CAClB,MAAMrQ,UAAAA,CAAK,GAAG,CAAA,CAAE,IAAA,CAAKA,UAAAA,CAAK,KAAA,CAAM,GAAG,CAAA,CAGxDuQ,CAAAA,CAAUH,CAAAA,CAAS,CAACD,CAAS,CAAA,CAAIH,EAGjCQ,CAAAA,CAAa,IAAI,GAAA,CAGvB,IAAA,IAAW3S,CAAAA,IAAK0S,CAAAA,CAAS,CACvB,IAAME,CAAAA,CAAUJ,CAAAA,CAAUxS,CAAAA,CACpB6S,CAAAA,CAAU1Q,UAAAA,CAAK,MAAM,SAAA,CAAUA,UAAAA,CAAK,QAAA,CAAS5B,CAAAA,CAAKqS,CAAO,CAAC,CAAA,CAAA,CAC5DP,CAAAA,CAAQ,GAAA,CAAIQ,CAAO,CAAA,EAAKlL,UAAAA,CAAWiL,CAAO,CAAA,GAC5CD,EAAW,GAAA,CAAIE,CAAO,CAAA,CAGxB,IAAMC,CAAAA,CAAS3Q,UAAAA,CAAK,KAAKqQ,CAAAA,CAAS,CAAA,KAAA,EAAQxS,CAAC,CAAA,CAAE,CAAA,CACvC+S,CAAAA,CAAS5Q,WAAK,KAAA,CAAM,SAAA,CAAUA,UAAAA,CAAK,QAAA,CAAS5B,CAAAA,CAAKuS,CAAM,CAAC,CAAA,CAAA,CAC1DT,CAAAA,CAAQ,GAAA,CAAIU,CAAM,CAAA,EAAKpL,UAAAA,CAAWmL,CAAM,CAAA,GAC1CH,CAAAA,CAAW,GAAA,CAAII,CAAM,EAEzB,CAGA,IAAM1S,CAAAA,CAAO8B,UAAAA,CAAK,QAAA,CAASqQ,CAAO,CAAA,CAClC,IAAA,IAAW/C,KAAK2C,CAAAA,CACVM,CAAAA,CAAQ,IAAA,CAAM1S,CAAAA,EAAMyP,CAAAA,CAAE,QAAA,CAAS,IAAIpP,CAAI,CAAA,EAAGL,CAAC,CAAA,CAAE,CAAC,CAAA,EAChD2S,EAAW,GAAA,CAAIlD,CAAC,CAAA,CAKpB,OAAIkD,CAAAA,CAAW,IAAA,GAAS,EAAU,IAAA,CAGnB,KAAA,CAAM,IAAA,CAAKA,CAAU,CAAA,CAAE,IAAA,CAAK,CAACK,CAAAA,CAAGC,CAAAA,GAAM,CAEnD,IAAMC,CAAAA,CAAO/Q,UAAAA,CAAK,MAAM,OAAA,CAAQ6Q,CAAC,CAAA,CAC3BG,CAAAA,CAAOhR,UAAAA,CAAK,KAAA,CAAM,QAAQ8Q,CAAC,CAAA,CAC3BG,CAAAA,CAAMV,CAAAA,CAAQ,OAAA,CAAQQ,CAAI,EAAIR,CAAAA,CAAQ,OAAA,CAAQS,CAAI,CAAA,CACxD,GAAIC,CAAAA,GAAQ,EAAG,OAAOA,CAAAA,CAEtB,IAAMC,CAAAA,CAAUZ,CAAAA,EAAWO,CAAAA,CAAE,UAAA,CAAWP,CAAO,CAAA,CAAI,EAAA,CAAK,CAAA,CAClDa,CAAAA,CAAUb,CAAAA,EAAWQ,CAAAA,CAAE,WAAWR,CAAO,CAAA,CAAI,EAAA,CAAK,CAAA,CACxD,OAAOY,CAAAA,CAAUC,CACnB,CAAC,CAAA,CAGa,CAAC,CACjB,CAEO,SAASpB,GACdvS,CAAAA,CACA0B,CAAAA,CACA+E,CAAAA,CACe,CACf,IAAMmN,CAAAA,CAAMpR,WAAK,SAAA,CAAUA,UAAAA,CAAK,IAAA,CAAKd,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAK1B,CAAQ,CAAC,CAAA,CAIlE6T,CAAAA,CAAU,MAAA,CAAO,OAAA,CAAQnS,CAAAA,CAAO,aAAa,CAAA,CAChD,MAAA,CACC,CAAC,EAAGoS,CAAI,IAAMA,CAAAA,EAAQF,CAAAA,CAAI,UAAA,CAAWpR,UAAAA,CAAK,SAAA,CAAUsR,CAAAA,CAAOtR,WAAK,GAAG,CAAC,CACtE,CAAA,CACC,IAAA,CAAK,CAAC6Q,EAAGC,CAAAA,GAAMA,CAAAA,CAAE,CAAC,CAAA,CAAE,MAAA,CAASD,CAAAA,CAAE,CAAC,CAAA,CAAE,MAAM,CAAA,CAE3C,GAAIQ,CAAAA,CAAQ,MAAA,GAAW,EACrB,OAAO,IAAA,CAET,GAAM,CAACE,CAAAA,CAAUC,CAAO,EAAIH,CAAAA,CAAQ,CAAC,CAAA,CAGjCI,CAAAA,CAAMzR,UAAAA,CAAK,QAAA,CAASwR,EAASJ,CAAG,CAAA,CAEpCK,CAAAA,CAAMA,CAAAA,CAAI,KAAA,CAAMzR,UAAAA,CAAK,GAAG,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,CAGlC,IAAM0R,CAAAA,CAAM1R,WAAK,KAAA,CAAM,OAAA,CAAQyR,CAAG,CAAA,CAE5BE,CAAAA,CADW,CAAC,KAAA,CAAO,MAAA,CAAQ,KAAA,CAAO,MAAM,CAAA,CACrB,QAAA,CAASD,CAAG,CAAA,CAAI,GAAKA,CAAAA,CAC1CE,CAAAA,CAAQH,CAAAA,CAAI,KAAA,CAAM,CAAA,CAAGA,CAAAA,CAAI,OAASC,CAAAA,CAAI,MAAM,CAAA,CAG5CE,CAAAA,CAAM,QAAA,CAAS,QAAQ,IACzBA,CAAAA,CAAQA,CAAAA,CAAM,KAAA,CAAM,CAAA,CAAG,EAAgB,CAAA,CAAA,CAKzC,IAAMC,CAAAA,CACJN,CAAAA,GAAa,KAAA,CACTtN,CAAAA,CAAY,WAAA,CACZ/E,CAAAA,CAAO,QAAQqS,CAAuC,CAAA,CAC5D,GAAI,CAACM,CAAAA,CACH,OAAO,KAGT,IAAIhN,CAAAA,CAAS+M,CAAAA,GAAU,EAAA,CAAK,EAAA,CAAK,CAAA,CAAA,EAAIA,CAAK,CAAA,CAAA,CAI1C,OAAA/M,CAAAA,CAASA,CAAAA,CAAO,OAAA,CAAQ,MAAA,CAAQ,EAAE,CAAA,CAI3B,CAAA,EAAGgN,CAAS,CAAA,EAAGhN,CAAM,CAAA,EAAG8M,CAAO,EACxC,CAEA,SAAS9D,EAAAA,CACPrQ,CAAAA,CACAyG,CAAAA,CACA/E,CAAAA,CACA,CACA,IAAM4S,CAAAA,CACJtU,CAAAA,GAAawC,UAAAA,CAAK,IAAA,CAAKd,CAAAA,CAAO,cAAc,GAAA,CAAK,eAAe,CAAA,EAChE1B,CAAAA,GAAawC,UAAAA,CAAK,IAAA,CAAKd,EAAO,aAAA,CAAc,GAAA,CAAK,eAAe,CAAA,CAE5D6S,CAAAA,CACJ9N,CAAAA,EAAa,UAAU,IAAA,GAAS,UAAA,EAChCA,CAAAA,EAAa,SAAA,CAAU,IAAA,GAAS,YAAA,CAElC,GAAI,CAAC6N,CAAAA,EAAoB,CAACC,CAAAA,EAAY,CAAC9N,CAAAA,EAAa,iBAClD,OAAO,MAAA,CAGT,IAAM+N,CAAAA,CAAe,QAAA,CAAS/N,CAAAA,CAAY,gBAAA,CAAiB,KAAA,CAAM,GAAG,CAAA,CAAE,CAAC,CAAC,CAAA,CAGxE,OAFqB,CAAC,KAAA,CAAM+N,CAAY,CAAA,EAAKA,CAAAA,EAAgB,EAG/D,CCtuBA,IAAMC,EAAAA,CAA6B,CAAC,MAAA,CAAQ,KAAA,CAAO,MAAA,CAAQ,KAAA,CAAO,MAAM,CAAA,CAClEC,EAAAA,CAAsB,CAAC,cAAc,CAAA,CACrCC,EAAAA,CAAuB,CAC3B,iCAAA,CACA,qBACF,CAAA,CAEMzI,EAAAA,CAAU,IAAIC,OAAAA,CAAQ,CAC1B,eAAA,CAAiB,EACnB,CAAC,CAAA,CAIM,SAASyI,GACdjL,CAAAA,CACe,CAEf,GAAIgL,EAAAA,CAAqB,IAAA,CAAME,CAAAA,EAAYA,EAAQ,IAAA,CAAKlL,CAAe,CAAC,CAAA,CACtE,OAAO,IAAA,CAWT,GANI,CAACA,CAAAA,CAAgB,UAAA,CAAW,GAAG,CAAA,EAAKA,CAAAA,CAAgB,SAAS,GAAG,CAAA,GAClEA,CAAAA,CAAkBA,CAAAA,CAAgB,KAAA,CAAM,GAAG,EAAE,CAAC,CAAA,CAAA,CAK5CA,CAAAA,CAAgB,UAAA,CAAW,GAAG,CAAA,CAAG,CACnC,IAAMrC,CAAAA,CAAQqC,CAAAA,CAAgB,KAAA,CAAM,GAAG,CAAA,CACnCrC,EAAM,MAAA,CAAS,CAAA,GACjBqC,CAAAA,CAAkBrC,CAAAA,CAAM,KAAA,CAAM,CAAA,CAAG,CAAC,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,EAEhD,CAEA,OAAOqC,CACT,CAEA,eAAsBmL,EAAAA,CACpB9U,CAAAA,CACA0B,CAAAA,CACA+E,CAAAA,CACAsO,CAAAA,CAA8B,IAAI,GAAA,CAC2C,CAC7E,IAAMC,CAAAA,CAAwBC,CAAA,CAAA,OAAA,CAAQvT,CAAAA,CAAO,cAAc,GAAA,CAAK1B,CAAQ,CAAA,CAClEkV,CAAAA,CAAgCD,CAAA,CAAA,QAAA,CACpCvT,CAAAA,CAAO,cAAc,GAAA,CACrBsT,CACF,CAAA,CAGA,GAAIN,EAAAA,CAAoB,QAAA,CAASQ,CAAwB,CAAA,CACvD,OAAO,CAAE,YAAA,CAAc,EAAC,CAAG,MAAO,EAAG,CAAA,CAIvC,IAAMC,CAAAA,CAAqBF,CAAA,CAAA,OAAA,CAAQjV,CAAQ,CAAA,CAC3C,GAAI,CAACyU,EAAAA,CAA2B,QAAA,CAASU,CAAa,EACpD,OAAO,CAAE,YAAA,CAAc,EAAC,CAAG,KAAA,CAAO,EAAG,CAAA,CAIvC,GAAIJ,CAAAA,CAAe,GAAA,CAAIG,CAAwB,EAC7C,OAAO,CAAE,YAAA,CAAc,EAAC,CAAG,KAAA,CAAO,EAAG,CAAA,CAKvC,GAHAH,CAAAA,CAAe,GAAA,CAAIG,CAAwB,EAGvC,CAAA,CADS,MAAS,CAAA,CAAA,IAAA,CAAKF,CAAgB,CAAA,EACjC,MAAA,GAER,OAAO,CAAE,YAAA,CAAc,EAAC,CAAG,KAAA,CAAO,EAAG,CAAA,CAGvC,IAAM7N,CAAAA,CAAU,MAAS,CAAA,CAAA,QAAA,CAAS6N,EAAkB,OAAO,CAAA,CACrDlI,CAAAA,CAAW,MAAMV,EAAAA,CAA0B6I,CAAA,CAAA,QAAA,CAASD,CAAgB,CAAC,CAAA,CACrE9L,CAAAA,CAAagD,EAAAA,CAAQ,gBAAA,CAAiBY,CAAAA,CAAU3F,CAAAA,CAAS,CAC7D,UAAA,CAAY4F,UAAAA,CAAW,GACzB,CAAC,CAAA,CACK1K,CAAAA,CAAW,MAAMC,UAAAA,CAAWZ,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CAC1D,GAAIW,EAAS,UAAA,GAAe,QAAA,CAC1B,OAAO,CAAE,YAAA,CAAc,GAAI,KAAA,CAAO,EAAG,CAAA,CAGvC,IAAM6D,CAAAA,CAAqD,EAAC,CACtDkP,CAAAA,CAAe,IAAI,GAAA,CAGnBC,CAAAA,CAAWC,EAAAA,CAAkBtV,CAAQ,CAAA,CACrCuV,CAAAA,CAAe,CACnB,IAAA,CAAML,CAAAA,CACN,IAAA,CAAMG,EACN,MAAA,CAAQ,EACV,CAAA,CACAnP,CAAAA,CAAM,IAAA,CAAKqP,CAAY,EAGvB,IAAMC,CAAAA,CAAmBtM,CAAAA,CAAW,qBAAA,EAAsB,CAC1D,IAAA,IAAWuM,KAAmBD,CAAAA,CAAkB,CAC9C,IAAM7L,CAAAA,CAAkB8L,CAAAA,CAAgB,uBAAA,GAElCC,CAAAA,CAAmB/L,CAAAA,CAAgB,UAAA,CAAW,GAAG,CAAA,CAMvD,GAAI,CALkBA,CAAAA,CAAgB,UAAA,CACpC,CAAA,EAAGlD,CAAAA,CAAY,WAAW,CAAA,CAAA,CAC5B,GAGsB,CAACiP,CAAAA,CAAkB,CACvC,IAAMC,CAAAA,CAAaf,EAAAA,CAAiCjL,CAAe,CAAA,CAC/DgM,CAAAA,EACFP,CAAAA,CAAa,GAAA,CAAIO,CAAU,CAAA,CAE7B,QACF,CAEA,IAAIxD,CAAAA,CAAyB,MAAM3Q,CAAAA,CAAcmI,CAAAA,CAAiBtH,CAAQ,CAAA,CAS1E,GAPIqT,CAAAA,GACFvD,CAAAA,CAA8B8C,CAAA,CAAA,OAAA,CACvBA,CAAA,CAAA,OAAA,CAAQD,CAAgB,CAAA,CAC7BrL,CACF,CAAA,CAAA,CAGE,CAACwI,CAAAA,CACH,SAMF,GAAI,CADsB8C,CAAA,CAAA,OAAA,CAAQ9C,CAAsB,CAAA,CAEtD,IAAA,IAAW+B,CAAAA,IAAOO,EAAAA,CAA4B,CAC5C,IAAMmB,EAAAA,CAAsB,CAAA,EAAGzD,CAAsB,CAAA,EAAG+B,CAAG,GAC3D,GAAI,CACF,MAAS,CAAA,CAAA,MAAA,CAAO0B,EAAW,CAAA,CAC3BzD,EAAyByD,EAAAA,CACzB,KACF,CAAA,KAAQ,CACN,QACF,CACF,CAGF,IAAMC,CAAAA,CAAsCZ,CAAA,CAAA,QAAA,CAC1CvT,CAAAA,CAAO,aAAA,CAAc,GAAA,CACrByQ,CACF,CAAA,CAGA,GACE4C,CAAAA,CAAe,GAAA,CAAIc,CAA8B,CAAA,EACjDnB,GAAoB,QAAA,CAASmB,CAA8B,CAAA,CAE3D,SAGF,IAAMR,CAAAA,CAAWC,GAAkB3L,CAAe,CAAA,CAC5ClE,EAAAA,CAAO,CACX,IAAA,CAAMoQ,CAAAA,CACN,KAAMR,CAAAA,CACN,MAAA,CAAQ,EACV,CAAA,CAAA,CAGIA,CAAAA,GAAa,eAAA,EAAmBA,IAAa,eAAA,IAC/C5P,EAAAA,CAAK,MAAA,CAASkE,CAAAA,CAAAA,CAGhBzD,CAAAA,CAAM,IAAA,CAAKT,EAAI,CAAA,CAGf,IAAMqQ,EAAAA,CAAgB,MAAMhB,EAAAA,CAC1Be,CAAAA,CACAnU,EACA+E,CAAAA,CACAsO,CACF,CAAA,CAEA,GAAIe,EAAAA,CAAc,KAAA,CAEhB,QAAWrQ,CAAAA,IAAQqQ,EAAAA,CAAc,KAAA,CAC1Bf,CAAAA,CAAe,GAAA,CAAItP,CAAAA,CAAK,IAAI,CAAA,GAC/BsP,CAAAA,CAAe,GAAA,CAAItP,CAAAA,CAAK,IAAI,CAAA,CAC5BS,EAAM,IAAA,CAAKT,CAAI,CAAA,CAAA,CAKjBqQ,EAAAA,CAAc,YAAA,EAChBA,EAAAA,CAAc,aAAa,OAAA,CAASnQ,CAAAA,EAAQyP,CAAAA,CAAa,GAAA,CAAIzP,CAAG,CAAC,EAErE,CAGA,IAAMoQ,CAAAA,CAAc,KAAA,CAAM,IAAA,CACxB,IAAI,GAAA,CAAI7P,EAAM,GAAA,CAAKT,CAAAA,EAAS,CAACA,CAAAA,CAAK,IAAA,CAAMA,CAAI,CAAC,CAAC,CAAA,CAAE,MAAA,EAClD,CAAA,CAEA,OAAO,CACL,YAAA,CAAc,KAAA,CAAM,IAAA,CAAK2P,CAAY,CAAA,CACrC,KAAA,CAAOW,CACT,CACF,CAEA,eAAe3J,EAAAA,CAAqBC,CAAAA,CAAkB,CACpD,IAAMC,CAAAA,CAAM,MAAS,CAAA,CAAA,OAAA,CAAa2I,CAAA,CAAA,IAAA,CAAK1I,MAAAA,EAAO,CAAG,SAAS,CAAC,CAAA,CAC3D,OAAY0I,CAAA,CAAA,IAAA,CAAK3I,CAAAA,CAAKD,CAAQ,CAChC,CAIA,SAASiJ,EAAAA,CACP3L,CAAAA,CAC4C,CAC5C,OAAIA,EAAgB,QAAA,CAAS,MAAM,CAAA,CAC1B,aAAA,CAGLA,CAAAA,CAAgB,QAAA,CAAS,OAAO,CAAA,CAC3B,cAAA,CAGLA,CAAAA,CAAgB,QAAA,CAAS,SAAS,CAAA,CAC7B,iBAGLA,CAAAA,CAAgB,QAAA,CAAS,cAAc,CAAA,CAClC,oBAAA,CAIX,CAGO,SAASqM,CAAAA,CAAMxT,CAAAA,CAAc,CAClC,GAAI,CACF,OAAA,IAAI,IAAIA,CAAI,CAAA,CACL,CAAA,CACT,CAAA,KAAgB,CACd,OAAO,MACT,CACF,CAEO,SAASyT,EAAAA,CAAYzT,CAAAA,CAAc,CACxC,OAAOA,CAAAA,CAAK,QAAA,CAAS,OAAO,CAAA,EAAK,CAACwT,CAAAA,CAAMxT,CAAI,CAC9C,CASO,SAAS0T,EAAAA,CACdC,CAAAA,CAIS,CAKT,OAJI,CAACA,CAAAA,EAKHA,CAAAA,CAAa,IAAA,GAAS,eAAA,EACtBA,CAAAA,CAAa,IAAA,GAAS,gBAEf,KAAA,CAAA,CAGKA,CAAAA,CAAa,KAAA,EAAS,EAAC,EAGxB,KAAA,CACV1Q,GACC,CAAC,CAACA,CAAAA,CAAK,MAAA,GACNA,CAAAA,CAAK,IAAA,GAAS,iBAAmBA,CAAAA,CAAK,IAAA,GAAS,eAAA,CACpD,CACF,CAIA,eAAsB2Q,GACpBC,CAAAA,CACA3U,CAAAA,CACA,CAEA,GAAI,CAAC4U,EAAAA,CAAoB5U,CAAM,CAAA,CAC7B,OAAOtB,CAAAA,CACJ,KAAA,CAAMmW,CAAsB,CAAA,CAC5B,MAAMF,CAAAA,CAAY,IAAA,EAAK,CAAE,MAAA,CAAO,OAAO,CAAC,EAI7C,IAAM5P,CAAAA,CAAc,MAAMxC,CAAAA,CAAevC,CAAAA,CAAO,aAAA,CAAc,GAAG,CAAA,CAC3D8U,CAAAA,CAAY,IAAI,GAAA,CAChB9F,CAAAA,CAAWtQ,CAAAA,CACd,MAAMmW,CAAsB,CAAA,CAC5B,KAAA,CAAMF,CAAAA,CAAY,IAAA,EAAK,CAAE,OAAO,OAAO,CAAC,CAAA,CAE3C,OAAA3F,CAAAA,CAAS,OAAA,CAASjL,GAAS,CACzB,IAAMzC,CAAAA,CAAe6M,EAAAA,CAAgBpK,CAAAA,CAAM/D,CAAAA,CAAQ,CACjD,QAAA,CAAU+E,CAAAA,EAAa,QAAA,CACvB,SAAA,CAAWA,CAAAA,EAAa,SAAA,CAAU,KAClC,UAAA,CAAYnD,EAAAA,CACVoN,CAAAA,CAAS,GAAA,CAAKZ,CAAAA,EAAMA,CAAAA,CAAE,IAAI,CAAA,CAC1BrK,CAAAA,CAAK,IACP,CACF,CAAC,CAAA,CAEGzC,GAEFwT,CAAAA,CAAU,GAAA,CAAIxT,CAAAA,CAAcyC,CAAI,EAEpC,CAAC,CAAA,CAEM,KAAA,CAAM,IAAA,CAAK+Q,CAAAA,CAAU,MAAA,EAAQ,CACtC,CAGO,SAASF,EAAAA,CAAoB5U,CAAAA,CAAgB,CAClD,OAAO,CAAC,EACNA,GAAQ,aAAA,EAAe,GAAA,GACtBA,CAAAA,EAAQ,aAAA,EAAe,EAAA,EACtBA,CAAAA,EAAQ,eAAe,GAAA,EACvBA,CAAAA,EAAQ,aAAA,EAAe,UAAA,EACvBA,CAAAA,EAAQ,aAAA,EAAe,OAE7B,CCxVA,SAAS+U,EAAAA,CAAuB/U,EAA6B,CAC3D,OAAKA,CAAAA,CAAO,KAAA,CAMRA,CAAAA,CAAO,KAAA,GAAU,YAAcA,CAAAA,CAAO,QAAA,EAAU,MAAA,GAAW,EAAA,CACtDvD,EAAAA,CAGFuD,CAAAA,CAAO,MATLvD,EAUX,CAEO,SAASuY,EAAAA,CAAmBhV,CAAAA,CAA8B,CAC/D,IAAMiV,CAAAA,CAAazS,EAAAA,CAAa,CAC9B,KAAA,CAAO/F,EAAAA,CACP,UAAA,CAAYE,CACd,CAAC,CAAA,CAED,OAAKqD,CAAAA,CAIEa,GAAAA,CAAa,KAAA,CAClBqU,GAAUD,CAAAA,CAAY,CACpB,GAAGjV,CAAAA,CACH,KAAA,CAAO+U,EAAAA,CAAuB/U,CAAM,CAAA,CACpC,UAAA,CAAY,CAAE,GAAGrD,CAAAA,CAAoB,GAAGqD,EAAO,UAAW,CAC5D,CAAC,CACH,CAAA,CATSiV,CAUX,CChCA,IAAIE,EAAAA,CAA2B,CAC7B,OAAA,CAAS,EACX,EAEO,SAASC,EAAAA,CACdC,CAAAA,CACA,CAEAF,EAAAA,CAAQ,OAAA,CAAU,CAAE,GAAGA,EAAAA,CAAQ,OAAA,CAAS,GAAGE,CAAQ,EACrD,CAEO,SAASC,EAAAA,CACd5X,CAAAA,CACwB,CACxB,OAAOyX,EAAAA,CAAQ,OAAA,CAAQzX,CAAG,CAAA,EAAK,EACjC,CAEO,SAAS6X,EAAAA,EAAuB,CACrCJ,EAAAA,CAAQ,OAAA,CAAU,GACpB,CCdO,SAASK,GACdxV,CAAAA,CACU,CACV,IAAM9C,CAAAA,CAAO,IAAI,GAAA,CAEjB,OAAI,OAAO8C,CAAAA,EAAW,QAAA,CACpB/C,EAAAA,CAAe+C,CAAM,CAAA,CAAE,QAASlB,CAAAA,EAAM5B,CAAAA,CAAK,GAAA,CAAI4B,CAAC,CAAC,CAAA,EAEjD7B,GAAe+C,CAAAA,CAAO,GAAG,CAAA,CAAE,OAAA,CAASlB,CAAAA,EAAM5B,CAAAA,CAAK,IAAI4B,CAAC,CAAC,CAAA,CAEjDkB,CAAAA,CAAO,MAAA,EACT,MAAA,CAAO,MAAA,CAAOA,CAAAA,CAAO,MAAM,CAAA,CAAE,OAAA,CAASlD,CAAAA,EAAU,CAC9CG,EAAAA,CAAeH,CAAK,CAAA,CAAE,OAAA,CAASgC,CAAAA,EAAM5B,CAAAA,CAAK,GAAA,CAAI4B,CAAC,CAAC,EAClD,CAAC,CAAA,CAGCkB,CAAAA,CAAO,OAAA,EACT,MAAA,CAAO,OAAOA,CAAAA,CAAO,OAAO,CAAA,CAAE,OAAA,CAASlD,CAAAA,EAAU,CAC/CG,GAAeH,CAAK,CAAA,CAAE,OAAA,CAASgC,CAAAA,EAAM5B,CAAAA,CAAK,GAAA,CAAI4B,CAAC,CAAC,EAClD,CAAC,CAAA,CAAA,CAIE,KAAA,CAAM,IAAA,CAAK5B,CAAI,CACxB,CAEO,SAASuY,EAAAA,CACdrX,CAAAA,CACA4B,CAAAA,CACM,CAEN,IAAM0V,CAAAA,CADeF,EAAAA,CAAiCxV,CAAM,CAAA,CAC/B,MAAA,CAAQlB,CAAAA,EAAM,CAAC,OAAA,CAAQ,GAAA,CAAIA,CAAC,CAAC,CAAA,CAE1D,GAAI4W,EAAQ,MAAA,CAAS,CAAA,CACnB,MAAM,IAAI9W,EAAAA,CAAyCR,CAAAA,CAAcsX,CAAO,CAE5E,CAEO,SAASC,EAAAA,CACdC,CAAAA,CACA5V,CAAAA,CACM,CACN,IAAA,IAAWxB,CAAAA,IAAQoX,CAAAA,CACjBC,EAAAA,CAAkCrX,CAAAA,CAAMwW,EAAAA,CAAmBhV,CAAM,CAAC,CAAA,CAIpEuV,EAAAA,GACF,CC/CA,IAAMO,GAAmB,QAAA,CACnBC,EAAAA,CAAoB,SAAA,CACpBC,EAAAA,CAAkB,YAAA,CAClBC,EAAAA,CAAwB,IACxBC,EAAAA,CAAwB,GAAA,CAE9B,SAASC,EAAAA,CAAYrV,CAAAA,CAAc,CACjC,OAAOA,CAAAA,CAAK,UAAA,CAAW,IAAI,CAAA,EAAKA,CAAAA,CAAK,UAAA,CAAW,GAAG,CACrD,CAEO,SAAS+U,EAAAA,CACd7W,CAAAA,CACAgB,CAAAA,CACA,CACA,GAAI,CAAE,QAAA,CAAAoW,CAAAA,CAAU,IAAA,CAAA5X,CAAK,EAAIe,EAAAA,CAA+BP,CAAI,CAAA,CAI5D,GAAI,CAACoX,CAAAA,CAAU,CACb,GAAI9B,CAAAA,CAAMtV,CAAI,CAAA,EAAKuV,EAAAA,CAAYvV,CAAI,GAAKmX,EAAAA,CAAYnX,CAAI,CAAA,CACtD,OAAO,IAAA,CAEToX,CAAAA,CAAW,UACb,CAGA,IAAMC,CAAAA,CADa,CAAE,GAAG1Z,CAAAA,CAAoB,GAAGqD,CAAAA,EAAQ,UAAW,CAAA,CAChCoW,CAAQ,CAAA,CAC1C,GAAI,CAACC,CAAAA,CACH,MAAM,IAAIlY,CAAAA,CAA2BiY,CAAQ,CAAA,CAK/C,OAAAX,EAAAA,CAAuBW,CAAAA,CAAUC,CAAc,CAAA,CAExC,CACL,GAAA,CAAKC,EAAAA,CAA2B9X,EAAM6X,CAAAA,CAAgBrW,CAAM,CAAA,CAC5D,OAAA,CAASuW,EAAAA,CAA+BF,CAAc,CACxD,CACF,CAEO,SAASC,EAAAA,CACd9X,CAAAA,CACA6X,CAAAA,CACArW,EACA,CACA,GAAI,OAAOqW,CAAAA,EAAmB,QAAA,CAAU,CACtC,IAAI3Y,CAAAA,CAAM2Y,CAAAA,CAAe,OAAA,CAAQP,EAAAA,CAAkBtX,CAAI,CAAA,CACvD,OAAIwB,CAAAA,EAAQ,KAAA,EAAStC,CAAAA,CAAI,QAAA,CAASqY,EAAiB,CAAA,GACjDrY,EAAMA,CAAAA,CAAI,OAAA,CAAQqY,EAAAA,CAAmB/V,CAAAA,CAAO,KAAK,CAAA,CAAA,CAE5CnD,GAAca,CAAG,CAC1B,CAEA,IAAI8Y,CAAAA,CAAUH,CAAAA,CAAe,IAAI,OAAA,CAAQP,EAAAA,CAAkBtX,CAAI,CAAA,CAM/D,OALIwB,CAAAA,EAAQ,OAASwW,CAAAA,CAAQ,QAAA,CAAST,EAAiB,CAAA,GACrDS,CAAAA,CAAUA,CAAAA,CAAQ,QAAQT,EAAAA,CAAmB/V,CAAAA,CAAO,KAAK,CAAA,CAAA,CAE3DwW,CAAAA,CAAU3Z,EAAAA,CAAc2Z,CAAO,CAAA,CAE1BH,CAAAA,CAAe,MAAA,CAIbI,EAAAA,CAAkBD,CAAAA,CAASH,CAAAA,CAAe,MAAM,CAAA,CAH9CG,CAIX,CAEO,SAASD,EAAAA,CACdvW,CAAAA,CACA,CACA,GAAI,OAAOA,CAAAA,EAAW,QAAA,EAAY,CAACA,CAAAA,CAAO,QACxC,OAAO,EAAC,CAGV,IAAMqV,CAAAA,CAAkC,GAExC,IAAA,GAAW,CAACrY,CAAAA,CAAKF,CAAK,CAAA,GAAK,MAAA,CAAO,OAAA,CAAQkD,CAAAA,CAAO,OAAO,CAAA,CAAG,CACzD,IAAM0W,CAAAA,CAAgB7Z,EAAAA,CAAcC,CAAK,CAAA,CAErC6Z,EAAAA,CAAoB7Z,CAAAA,CAAO4Z,CAAa,CAAA,GAC1CrB,CAAAA,CAAQrY,CAAG,CAAA,CAAI0Z,CAAAA,EAEnB,CAEA,OAAOrB,CACT,CAEA,SAASoB,EAAAA,CAAkBD,CAAAA,CAAiBI,CAAAA,CAAgC,CAC1E,IAAMC,CAAAA,CAAY,IAAI,eAAA,CAEtB,IAAA,GAAW,CAAC7Z,CAAAA,CAAKF,CAAK,CAAA,GAAK,OAAO,OAAA,CAAQ8Z,CAAM,CAAA,CAAG,CACjD,IAAMF,CAAAA,CAAgB7Z,GAAcC,CAAK,CAAA,CACrC4Z,CAAAA,EACFG,CAAAA,CAAU,MAAA,CAAO7Z,CAAAA,CAAK0Z,CAAa,EAEvC,CAEA,IAAMI,CAAAA,CAAcD,CAAAA,CAAU,QAAA,GAC9B,GAAI,CAACC,CAAAA,CACH,OAAON,CAAAA,CAGT,IAAMO,EAAYP,CAAAA,CAAQ,QAAA,CAASP,EAAqB,CAAA,CACpDC,EAAAA,CACAD,EAAAA,CAEJ,OAAO,CAAA,EAAGO,CAAO,CAAA,EAAGO,CAAS,CAAA,EAAGD,CAAW,EAC7C,CAEA,SAASH,EAAAA,CAAoBK,CAAAA,CAAuBN,CAAAA,CAAuB,CACzE,IAAMO,CAAAA,CAAkBP,CAAAA,CAAc,IAAA,EAAK,CAE3C,GAAI,CAACO,EACH,OAAO,MAAA,CAIT,GAAID,CAAAA,CAAc,QAAA,CAAS,IAAI,GAEbA,CAAAA,CAAc,KAAA,CAAMhB,EAAe,CAAA,CACtC,CACX,IAAMkB,EAAsBF,CAAAA,CACzB,OAAA,CAAQhB,EAAAA,CAAiB,EAAE,CAAA,CAC3B,IAAA,EAAK,CACR,OAAOiB,CAAAA,GAAoBC,CAC7B,CAGF,OAAO,KACT,CASO,SAASC,EAAAA,CAAmBC,CAAAA,CAAmB,CACpD,GAAI9C,CAAAA,CAAM8C,CAAS,EAAG,CAGpB,IAAM1Z,CAAAA,CAAM,IAAI,GAAA,CAAI0Z,CAAS,EAC7B,OAAI1Z,CAAAA,CAAI,QAAA,CAAS,KAAA,CAAM,aAAa,CAAA,EAAK,CAACA,CAAAA,CAAI,QAAA,CAAS,QAAA,CAAS,OAAO,CAAA,GACrEA,CAAAA,CAAI,SAAW,CAAA,EAAGA,CAAAA,CAAI,QAAQ,CAAA,KAAA,CAAA,CAAA,CAGzBA,CAAAA,CAAI,QAAA,EACb,CAEA,OAAO,CAAA,EAAGlB,EAAY,CAAA,CAAA,EAAI4a,CAAS,EACrC,CC/IA,IAAMC,EAAAA,CAAQ,OAAA,CAAQ,GAAA,CAAI,WAAA,CACtB,IAAIC,eAAAA,CAAgB,OAAA,CAAQ,GAAA,CAAI,WAAW,CAAA,CAC3C,MAAA,CAEEC,GAAgB,IAAI,GAAA,CAM1B,eAAsBC,CAAAA,CACpB7S,CAAAA,CACAnH,CAAAA,CAAkC,EAAC,CACnC,CACAA,CAAAA,CAAU,CACR,QAAA,CAAU,IAAA,CACV,GAAGA,CACL,CAAA,CAEA,GAAI,CA+EF,OA9EgB,MAAM,QAAQ,GAAA,CAC5BmH,CAAAA,CAAM,GAAA,CAAI,MAAO7D,CAAAA,EAAS,CACxB,IAAMpD,CAAAA,CAAMyZ,EAAAA,CAAmBrW,CAAI,CAAA,CAGnC,GAAItD,CAAAA,CAAQ,QAAA,EAAY+Z,GAAc,GAAA,CAAI7Z,CAAG,CAAA,CAC3C,OAAO6Z,EAAAA,CAAc,GAAA,CAAI7Z,CAAG,CAAA,CAI9B,IAAM+Z,CAAAA,CAAAA,CAAgB,SAAY,CAEhC,IAAMpC,EAAUC,EAAAA,CAA8B5X,CAAG,CAAA,CAE3Cga,CAAAA,CAAW,MAAMC,EAAAA,CAAMja,EAAK,CAChC,KAAA,CAAA2Z,EAAAA,CACA,OAAA,CAAS,CACP,GAAGhC,CACL,CACF,CAAC,CAAA,CAED,GAAI,CAACqC,CAAAA,CAAS,GAAI,CAChB,IAAIE,CAAAA,CAEJ,GACEF,CAAAA,CAAS,OAAA,CAAQ,IAAI,cAAc,CAAA,EAAG,QAAA,CAAS,kBAAkB,CAAA,CACjE,CACA,IAAMG,CAAAA,CAAO,MAAMH,CAAAA,CAAS,IAAA,EAAK,CAC3BI,CAAAA,CAASpZ,EACZ,MAAA,CAAO,CAEN,MAAA,CAAQA,CAAAA,CAAE,MAAA,EAAO,CAAE,UAAS,CAC5B,KAAA,CAAOA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,GAElB,OAAA,CAASA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS,CAC7B,MAAOA,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EACpB,CAAC,EACA,SAAA,CAAUmZ,CAAI,CAAA,CAEbC,CAAAA,CAAO,OAAA,GAETF,CAAAA,CAAoBE,EAAO,IAAA,CAAK,MAAA,EAAUA,CAAAA,CAAO,IAAA,CAAK,OAAA,CAElDA,CAAAA,CAAO,KAAK,KAAA,GACdF,CAAAA,CAAoB,CAAA,CAAA,EAAIE,CAAAA,CAAO,IAAA,CAAK,KAAK,CAAA,EAAA,EAAKF,CAAiB,CAAA,CAAA,CAAA,EAGrE,CAEA,MAAIF,CAAAA,CAAS,MAAA,GAAW,GAAA,CAChB,IAAI9Z,EAAAA,CAA0BF,CAAAA,CAAKka,CAAiB,CAAA,CAGxDF,CAAAA,CAAS,MAAA,GAAW,IAChB,IAAIja,CAAAA,CAAsBC,CAAAA,CAAKka,CAAiB,CAAA,CAGpDF,CAAAA,CAAS,SAAW,GAAA,CAChB,IAAI7Z,EAAAA,CAAuBH,CAAAA,CAAKka,CAAiB,CAAA,CAGnD,IAAI9Z,EAAAA,CACRJ,CAAAA,CACAga,CAAAA,CAAS,MAAA,CACTE,CACF,CACF,CAEA,OAAOF,CAAAA,CAAS,IAAA,EAClB,CAAA,GAAG,CAEH,OAAIla,CAAAA,CAAQ,QAAA,EACV+Z,EAAAA,CAAc,GAAA,CAAI7Z,CAAAA,CAAK+Z,CAAY,EAE9BA,CACT,CAAC,CACH,CAGF,CAAA,MAASxW,CAAAA,CAAO,CACd,MAAMA,CACR,CACF,CAEA,eAAsB8W,EAAAA,CAAmBzZ,EAAkB,CACzD,GAAI,CAEF,IAAI0Z,CAAAA,CAAe1Z,CAAAA,CACfA,EAAS,UAAA,CAAW,IAAI,CAAA,GAC1B0Z,CAAAA,CAAelX,UAAAA,CAAK,IAAA,CAAKmX,SAAQ,CAAG3Z,CAAAA,CAAS,KAAA,CAAM,CAAC,CAAC,CAAA,CAAA,CAGvD,IAAMgD,CAAAA,CAAeR,UAAAA,CAAK,OAAA,CAAQkX,CAAY,CAAA,CACxCvS,CAAAA,CAAU,MAAM3C,QAAAA,CAAG,QAAA,CAASxB,CAAAA,CAAc,MAAM,CAAA,CAChDwW,GAAAA,CAAS,KAAK,KAAA,CAAMrS,CAAO,CAAA,CAEjC,GAAI,CACF,OAAOyS,EAAmB,KAAA,CAAMJ,GAAM,CACxC,CAAA,MAAS7W,CAAAA,CAAO,CACd,MAAM,IAAI1C,CAAAA,CAAmBD,CAAAA,CAAU2C,CAAK,CAC9C,CACF,CAAA,MAASA,EAAO,CAEd,MACEA,CAAAA,YAAiB,KAAA,GAChBA,CAAAA,CAAM,OAAA,CAAQ,SAAS,QAAQ,CAAA,EAC9BA,CAAAA,CAAM,OAAA,CAAQ,QAAA,CAAS,cAAc,GAEjC,IAAI5C,EAAAA,CAAuBC,CAAAA,CAAU2C,CAAK,CAAA,CAG9CA,CAAAA,YAAiB1C,EACb0C,CAAAA,CAGF,IAAI5C,EAAAA,CAAuBC,CAAAA,CAAU2C,CAAK,CAClD,CACF,CC5HA,eAAsBkX,EAAAA,CACpBC,CAAAA,CAGApY,CAAAA,CACAxC,CAAAA,CAIA,CAYA,GAXI,CAAC4a,CAAAA,GAIL5a,CAAAA,CAAU,CACR,MAAA,CAAQ,KAAA,CACR,gBAAiB,IAAA,CACjB,GAAGA,CACL,CAAA,CAGIA,CAAAA,CAAQ,eAAA,GAAoB,MAC9B,OAGF,IAAM6a,CAAAA,CAA2BvX,UAAAA,CAAK,QAAA,CACpCd,CAAAA,CAAO,cAAc,GAAA,CACrBA,CAAAA,CAAO,aAAA,CAAc,cACvB,CAAA,CACMsY,CAAAA,CAAkBlR,EACtB,CAAA,SAAA,EAAY3H,CAAAA,CAAY,IAAA,CAAK4Y,CAAwB,CAAC,CAAA,CAAA,CACtD,CACE,MAAA,CAAQ7a,CAAAA,CAAQ,MAClB,CACF,CAAA,CAAE,KAAA,EAAM,CACF+a,EAAM,MAAMzV,QAAAA,CAAG,QAAA,CAAS9C,CAAAA,CAAO,aAAA,CAAc,cAAA,CAAgB,MAAM,CAAA,CACnEoI,CAAAA,CAAS,MAAMoQ,EAAAA,CAAwBD,CAAAA,CAAKH,CAAAA,CAAgBpY,CAAM,CAAA,CACxE,MAAM8C,QAAAA,CAAG,SAAA,CAAU9C,CAAAA,CAAO,aAAA,CAAc,eAAgBoI,CAAAA,CAAQ,MAAM,CAAA,CACtEkQ,CAAAA,EAAiB,OAAA,GACnB,CAEA,eAAsBE,EAAAA,CACpBnO,CAAAA,CACA+N,CAAAA,CACApY,CAAAA,CACA,CACA,IAAMwH,CAAAA,CAAa,MAAMiR,EAAAA,CAAkBpO,CAAAA,CAAOrK,CAAM,CAAA,CAIlD0Y,EAAelR,CAAAA,CAClB,oBAAA,CAAqBO,UAAAA,CAAW,uBAAuB,CAAA,CACvD,IAAA,CAAMmB,CAAAA,EACLA,CAAAA,CACG,aAAA,EAAc,CACd,IAAA,CACEyP,CAAAA,EACCA,CAAAA,CAAS,MAAA,CAAO5Q,WAAW,kBAAkB,CAAA,EAC7C4Q,CAAAA,CAAS,OAAA,EAAQ,GAAM,SAC3B,CACJ,CAAA,CAGF,GAAI,CAACD,CAAAA,CACH,OAAOrO,CAAAA,CAGT,IAAMuO,CAAAA,CAAYC,EAAAA,CAAcH,CAAY,CAAA,CAG5C,OAAAI,EAAAA,CACEJ,EACA,CACE,IAAA,CAAM,UAAA,CACN,KAAA,CAAO,OACT,CAAA,CACA,CAAE,SAAA,CAAAE,CAAU,CACd,CAAA,CAGAR,CAAAA,CAAe,OAAA,EAAS,QAASW,CAAAA,EAAW,CAC1CC,EAAAA,CAAwBN,CAAAA,CAAcK,CAAM,EAC9C,CAAC,CAAA,CAGGX,CAAAA,CAAe,KAAA,EACjB,MAAMa,EAAAA,CAAuBP,CAAAA,CAAcN,CAAAA,CAAe,KAAK,CAAA,CAG1D5Q,CAAAA,CAAW,WAAA,EACpB,CAEA,SAASsR,GACPJ,CAAAA,CACAC,CAAAA,CAIA,CACE,SAAA,CAAAC,CACF,CAAA,CAGA,CACA,IAAMM,CAAAA,CAAmBR,CAAAA,CAAa,WAAA,CAAY,UAAU,CAAA,CAE5D,GAAI,CAACQ,CAAAA,CAAkB,CACrB,IAAMC,CAAAA,CAAc,CAClB,KAAMR,CAAAA,CAAS,IAAA,CACf,WAAA,CAAa,CAAA,CAAA,EAAIC,CAAS,CAAA,EAAGD,EAAS,KAAK,CAAA,EAAGC,CAAS,CAAA,CAAA,CACzD,CAAA,CAGA,OAAID,EAAS,IAAA,GAAS,UAAA,EACpBD,CAAAA,CAAa,wBAAA,CAAyB,CAAA,CAAGS,CAAW,EAC7CT,CAAAA,GAGTA,CAAAA,CAAa,qBAAA,CAAsBS,CAAW,CAAA,CAEvCT,CAAAA,CACT,CAEA,GAAIQ,CAAAA,CAAiB,MAAA,CAAOnR,UAAAA,CAAW,kBAAkB,CAAA,CAAG,CAC1D,IAAM6B,CAAAA,CAAcsP,CAAAA,CAAiB,cAAA,EAAe,CAC9C9P,CAAAA,CAAW,GAAGwP,CAAS,CAAA,EAAGD,CAAAA,CAAS,KAAK,CAAA,EAAGC,CAAS,GAG1D,GAAIhP,CAAAA,EAAa,MAAA,CAAO7B,UAAAA,CAAW,aAAa,CAAA,CAAG,CACjD,IAAMqR,CAAAA,CAAkBxP,CAAAA,CAAY,OAAA,EAAQ,CAC5C,OAAAA,EAAY,eAAA,CAAgB,CAAA,CAAA,EAAIwP,CAAe,CAAA,EAAA,EAAKhQ,CAAQ,CAAA,CAAA,CAAG,EACxDsP,CACT,CAGA,GAAI9O,CAAAA,EAAa,MAAA,CAAO7B,UAAAA,CAAW,sBAAsB,CAAA,CAAG,CAE1D,GACE6B,CAAAA,CACG,WAAA,EAAY,CACZ,GAAA,CAAKyP,CAAAA,EAAYA,CAAAA,CAAQ,OAAA,EAAS,CAAA,CAClC,QAAA,CAASjQ,CAAQ,EAEpB,OAAOsP,CAAAA,CAET9O,CAAAA,CAAY,UAAA,CAAWR,CAAQ,EACjC,CAEA,OAAOsP,CACT,CAEA,OAAOA,CACT,CAEA,eAAeO,EAAAA,CACbP,CAAAA,CACAY,CAAAA,CACA,CAEKZ,CAAAA,CAAa,WAAA,CAAY,OAAO,CAAA,EACnCA,CAAAA,CAAa,qBAAA,CAAsB,CACjC,IAAA,CAAM,OAAA,CACN,YAAa,IACf,CAAC,CAAA,CAIHa,EAAAA,CAAqBb,CAAY,CAAA,CAMjC,IAAMc,CAAAA,CAAAA,CAJgBd,CAAAA,CACnB,kBAAA,CAAmB,OAAO,CAAA,EACzB,aAAA,CAAc3Q,WAAW,kBAAkB,CAAA,EAER,cAAA,EAAe,CACtD,GAAIyR,CAAAA,EAAkB,OAAOzR,UAAAA,CAAW,uBAAuB,CAAA,CAAG,CAChE,IAAM0R,CAAAA,CAAoBD,EAAiB,OAAA,EAAQ,CAC7CE,CAAAA,CAAc,MAAMC,EAAAA,CAAmBF,CAAiB,EACxDhY,CAAAA,CAASyT,EAAAA,CAAUwE,CAAAA,CAAaJ,CAAAA,CAAO,CAC3C,UAAA,CAAY,CAACM,CAAAA,CAAKC,CAAAA,GAAQA,CAC5B,CAAC,CAAA,CACKC,CAAAA,CAAeC,GAAetY,CAAM,CAAA,CACvC,OAAA,CAAQ,iBAAA,CAAmB,OAAO,CAAA,CAClC,QAAQ,OAAA,CAAS,GAAG,CAAA,CACpB,OAAA,CAAQ,OAAA,CAAS,GAAG,EACpB,OAAA,CAAQ,OAAA,CAAS,GAAG,CAAA,CACpB,OAAA,CAAQ,OAAA,CAAS,GAAG,CAAA,CACpB,OAAA,CAAQ,SAAA,CAAW,GAAG,CAAA,CACtB,OAAA,CAAQ,OAAA,CAAS,GAAG,CAAA,CACpB,OAAA,CAAQ,SAAA,CAAW,GAAG,CAAA,CACtB,OAAA,CAAQ,QAAS,GAAG,CAAA,CACvB+X,CAAAA,CAAiB,eAAA,CAAgBM,CAAY,EAC/C,CAGAE,EAAAA,CAAuBtB,CAAY,EACrC,CAEA,SAASM,EAAAA,CACPN,EACAK,CAAAA,CACA,CACA,IAAMkB,CAAAA,CAAkBvB,CAAAA,CAAa,WAAA,CAAY,SAAS,CAAA,CAE1D,GAAI,CAACuB,CAAAA,CACH,OAAAvB,CAAAA,CAAa,sBAAsB,CACjC,IAAA,CAAM,SAAA,CACN,WAAA,CAAa,CAAA,CAAA,EAAIK,CAAM,GACzB,CAAC,CAAA,CAEML,CAAAA,CAGT,GAAIuB,CAAAA,CAAgB,MAAA,CAAOlS,WAAW,kBAAkB,CAAA,CAAG,CACzD,IAAM6B,CAAAA,CAAcqQ,CAAAA,CAAgB,gBAAe,CAEnD,GAAIrQ,CAAAA,EAAa,MAAA,CAAO7B,UAAAA,CAAW,sBAAsB,EAAG,CAC1D,GACE6B,CAAAA,CACG,WAAA,EAAY,CACZ,GAAA,CAAKyP,GACGA,CAAAA,CAAQ,OAAA,EAAQ,CAAE,OAAA,CAAQ,OAAA,CAAS,EAAE,CAC7C,CAAA,CACA,QAAA,CAASN,CAAAA,CAAO,OAAA,CAAQ,OAAA,CAAS,EAAE,CAAC,CAAA,CAEvC,OAAOL,CAAAA,CAET9O,CAAAA,CAAY,UAAA,CAAWmP,CAAM,EAC/B,CAEA,OAAOL,CACT,CAEA,OAAOA,CACT,CAEA,eAAsBD,EAAAA,CAAkBpO,CAAAA,CAAerK,CAAAA,CAAuB,CAC5E,IAAM4K,EAAM,MAAM9H,QAAAA,CAAG,OAAA,CAAQhC,UAAAA,CAAK,IAAA,CAAK+J,MAAAA,EAAO,CAAG,SAAS,CAAC,CAAA,CACrDvJ,CAAAA,CACJtB,CAAAA,EAAQ,aAAA,EAAe,cAAA,EAAkB,qBACrCoL,CAAAA,CAAWtK,UAAAA,CAAK,IAAA,CAAK8J,CAAAA,CAAK,CAAA,OAAA,EAAU9J,UAAAA,CAAK,SAASQ,CAAY,CAAC,CAAA,CAAE,CAAA,CAYvE,OAVgB,IAAImJ,QAAQ,CAC1B,eAAA,CAAiB,EACnB,CAAC,CAAA,CAC0B,iBAAiBW,CAAAA,CAAUf,CAAAA,CAAO,CAG3D,UAAA,CACEvJ,UAAAA,CAAK,OAAA,CAAQQ,CAAY,CAAA,GAAM,KAAA,CAAQ+J,UAAAA,CAAW,EAAA,CAAKA,UAAAA,CAAW,EACtE,CAAC,CAGH,CAEO,SAASwN,EAAAA,CAAcH,CAAAA,CAAuC,CACnE,OAAOA,CAAAA,CACJ,wBAAA,CAAyB3Q,UAAAA,CAAW,aAAa,CAAA,EAChD,YAAA,KAAmBmS,SAAAA,CAAU,MAAA,CAC7B,GAAA,CACA,GACN,CAEO,SAASX,GAAqBY,CAAAA,CAA8B,CACjE,IAAMC,CAAAA,CAAaD,CAAAA,CAAI,aAAA,GAEvB,IAAA,IAASzO,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI0O,CAAAA,CAAW,MAAA,CAAQ1O,IAAK,CAC1C,IAAM2O,CAAAA,CAAOD,CAAAA,CAAW1O,CAAC,CAAA,CACzB,GAAI2O,CAAAA,CAAK,MAAA,CAAOtS,UAAAA,CAAW,gBAAgB,CAAA,CAAG,CAC5C,IAAMuS,CAAAA,CAAmBD,CAAAA,CAAK,aAAA,CAActS,UAAAA,CAAW,gBAAgB,CAAA,CACjEwS,EAAaD,CAAAA,CAAiB,aAAA,EAAc,CAAE,OAAA,EAAQ,CAG5DH,CAAAA,CAAI,yBAAyBzO,CAAAA,CAAG,CAE9B,IAAA,CAAM,CAAA,IAAA,EAAO6O,CAAAA,CAAW,OAAA,CAAQ,SAAA,CAAW,EAAE,CAAC,CAAA,CAAA,CAAA,CAC9C,WAAA,CAAa,CAAA,IAAA,EAAOA,CAAAA,CAAW,OAAA,CAAQ,UAAW,EAAE,CAAC,CAAA,CAAA,CACvD,CAAC,CAAA,CAGDD,CAAAA,CAAiB,SACnB,CAAA,KAAA,GAAWD,CAAAA,CAAK,MAAA,CAAOtS,UAAAA,CAAW,kBAAkB,EAAG,CAErD,IAAM6B,CAAAA,CADiByQ,CAAAA,CAAK,aAAA,CAActS,UAAAA,CAAW,kBAAkB,CAAA,CACpC,cAAA,EAAe,CAGhD6B,CAAAA,EACAA,CAAAA,CAAY,MAAA,CAAO7B,WAAW,uBAAuB,CAAA,CAGrDwR,EAAAA,CACE3P,CAAAA,CAAY,aAAA,CAAc7B,UAAAA,CAAW,uBAAuB,CAC9D,CAAA,CAEA6B,CAAAA,EACAA,CAAAA,CAAY,MAAA,CAAO7B,UAAAA,CAAW,sBAAsB,CAAA,EAEpDyS,EAAAA,CACE5Q,CAAAA,CAAY,aAAA,CAAc7B,UAAAA,CAAW,sBAAsB,CAC7D,EAEJ,CACF,CACF,CAEO,SAASyS,EAAAA,CAAmBnb,EAA6B,CAC9D,IAAMob,CAAAA,CAAWpb,CAAAA,CAAI,WAAA,EAAY,CACjC,QAASqb,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAID,CAAAA,CAAS,MAAA,CAAQC,CAAAA,EAAAA,CAAK,CACxC,IAAMrB,CAAAA,CAAUoB,CAAAA,CAASC,CAAC,CAAA,CAC1B,GAAIrB,EAAQ,MAAA,CAAOtR,UAAAA,CAAW,uBAAuB,CAAA,CAEnDwR,EAAAA,CACEF,CAAAA,CAAQ,cAActR,UAAAA,CAAW,uBAAuB,CAC1D,CAAA,CAAA,KAAA,GACSsR,CAAAA,CAAQ,MAAA,CAAOtR,WAAW,sBAAsB,CAAA,CAEzDyS,EAAAA,CACEnB,CAAAA,CAAQ,aAAA,CAActR,UAAAA,CAAW,sBAAsB,CACzD,CAAA,CAAA,KAAA,GACSsR,CAAAA,CAAQ,MAAA,CAAOtR,UAAAA,CAAW,aAAa,CAAA,CAAG,CACnD,IAAMwS,CAAAA,CAAalB,CAAAA,CAAQ,OAAA,EAAQ,CAEnCha,CAAAA,CAAI,cAAcqb,CAAC,CAAA,CACnBrb,CAAAA,CAAI,aAAA,CAAcqb,CAAAA,CAAG,CAAA,CAAA,EAAIH,CAAU,CAAA,CAAA,CAAG,EACxC,CACF,CACF,CAEO,SAASP,GAAuBG,CAAAA,CAA8B,CACnE,IAAMC,CAAAA,CAAaD,CAAAA,CAAI,aAAA,GAEvB,IAAA,IAASzO,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI0O,CAAAA,CAAW,MAAA,CAAQ1O,IAAK,CAC1C,IAAM2O,CAAAA,CAAOD,CAAAA,CAAW1O,CAAC,CAAA,CACzB,GAAI2O,CAAAA,CAAK,MAAA,CAAOtS,UAAAA,CAAW,kBAAkB,CAAA,CAAG,CAC9C,IAAM4S,CAAAA,CAAiBN,CAAAA,CACjBzQ,CAAAA,CAAc+Q,CAAAA,CAAe,cAAA,EAAe,CAElD,GAAI/Q,CAAAA,EAAeA,CAAAA,CAAY,MAAA,CAAO7B,UAAAA,CAAW,aAAa,CAAA,CAAG,CAC/D,IAAMjL,CAAAA,CAAQ8M,CAAAA,CACX,aAAA,CAAc7B,UAAAA,CAAW,aAAa,EACtC,eAAA,EAAgB,CACfjL,CAAAA,CAAM,UAAA,CAAW,KAAK,CAAA,GACxBqd,EAAI,sBAAA,CAAuBzO,CAAAA,CAAG,CAAE,UAAA,CAAY5O,CAAAA,CAAM,KAAA,CAAM,CAAC,CAAE,CAAC,CAAA,CAC5D6d,CAAAA,CAAe,MAAA,EAAO,EAE1B,MAAW/Q,CAAAA,EAAa,MAAA,CAAO7B,UAAAA,CAAW,uBAAuB,CAAA,CAC/DiS,EAAAA,CAAuBpQ,CAAsC,CAAA,CAE7DA,CAAAA,EACAA,CAAAA,CAAY,MAAA,CAAO7B,UAAAA,CAAW,sBAAsB,GAEpD6S,EAAAA,CACEhR,CAAAA,CAAY,aAAA,CAAc7B,UAAAA,CAAW,sBAAsB,CAC7D,EAEJ,CACF,CACF,CAEO,SAAS6S,EAAAA,CAAoBvb,CAAAA,CAA6B,CAC/D,IAAMob,CAAAA,CAAWpb,CAAAA,CAAI,WAAA,EAAY,CACjC,IAAA,IAASqb,CAAAA,CAAI,EAAGA,CAAAA,CAAID,CAAAA,CAAS,MAAA,CAAQC,CAAAA,EAAAA,CAAK,CACxC,IAAMrB,EAAUoB,CAAAA,CAASC,CAAC,CAAA,CAC1B,GAAIrB,CAAAA,CAAQ,MAAA,CAAOtR,WAAW,uBAAuB,CAAA,CAEnDiS,EAAAA,CACEX,CAAAA,CAAQ,aAAA,CAActR,UAAAA,CAAW,uBAAuB,CAC1D,CAAA,CAAA,KAAA,GACSsR,CAAAA,CAAQ,MAAA,CAAOtR,UAAAA,CAAW,sBAAsB,EAEzD6S,EAAAA,CACEvB,CAAAA,CAAQ,aAAA,CAActR,UAAAA,CAAW,sBAAsB,CACzD,UACSsR,CAAAA,CAAQ,MAAA,CAAOtR,UAAAA,CAAW,aAAa,CAAA,CAAG,CACnD,IAAMwS,CAAAA,CAAalB,CAAAA,CAAQ,OAAA,EAAQ,CAE7BwB,CAAAA,CAAa,+BAAA,CACfA,EAAW,IAAA,CAAKN,CAAU,CAAA,GAC5Blb,CAAAA,CAAI,aAAA,CAAcqb,CAAC,EACnBrb,CAAAA,CAAI,aAAA,CAAcqb,CAAAA,CAAGH,CAAAA,CAAW,OAAA,CAAQM,CAAAA,CAAY,IAAI,CAAC,CAAA,EAE7D,CACF,CACF,CAEA,eAAelB,GAAmBmB,CAAAA,CAA2C,CAM3E,IAAMC,CAAAA,CAAAA,CALa,MAAMtC,EAAAA,CACvB,iBAAiBqC,CAAmB,CAAA,CAAA,CACpC,IACF,CAAA,EAE6B,aAAA,EAAc,CAAE,CAAC,CAAA,CAC9C,GAAIC,CAAAA,EAAW,OAAA,EAAQ,GAAMhT,UAAAA,CAAW,kBAAmB,CAIzD,IAAM6B,CAAAA,CAAAA,CAHemR,CAAAA,CAClB,kBAAA,EAAmB,EAClB,eAAA,EAAgB,CAAE,CAAC,CAAA,EACS,cAAA,EAAe,CAC/C,GAAInR,CAAAA,EAAa,OAAO7B,UAAAA,CAAW,uBAAuB,CAAA,CACxD,OAAO,MAAMiT,EAAAA,CAA6BpR,CAAW,CAEzD,CAEA,MAAM,IAAI,KAAA,CAAM,sCAAsC,CACxD,CAEA,SAASoR,EAAAA,CAA6B9R,CAAAA,CAAoC,CACxE,IAAMzH,EAAc,EAAC,CACrB,IAAA,IAAWkX,CAAAA,IAAYzP,CAAAA,CAAK,aAAA,GAC1B,GAAIyP,CAAAA,CAAS,MAAA,CAAO5Q,UAAAA,CAAW,kBAAkB,CAAA,CAAG,CAClD,IAAM/I,CAAAA,CAAO2Z,CAAAA,CAAS,OAAA,EAAQ,CAAE,OAAA,CAAQ,MAAO,EAAE,CAAA,CAE/CA,CAAAA,CAAS,cAAA,EAAe,EAAG,MAAA,CAAO5Q,UAAAA,CAAW,uBAAuB,CAAA,CAEpEtG,CAAAA,CAAOzC,CAAI,CAAA,CAAIgc,EAAAA,CACbrC,CAAAA,CAAS,gBACX,CAAA,CAEAA,CAAAA,CAAS,cAAA,EAAe,EAAG,MAAA,CAAO5Q,WAAW,sBAAsB,CAAA,CAEnEtG,CAAAA,CAAOzC,CAAI,CAAA,CAAIic,EAAAA,CACbtC,EAAS,cAAA,EACX,CAAA,CAEAlX,CAAAA,CAAOzC,CAAI,CAAA,CAAIkc,GAAWvC,CAAAA,CAAS,cAAA,EAAgB,EAEvD,CAEF,OAAOlX,CACT,CAEA,SAASwZ,EAAAA,CAA4B/R,CAAAA,CAAqC,CACxE,IAAMzH,EAAgB,EAAC,CACvB,IAAA,IAAW4X,CAAAA,IAAWnQ,CAAAA,CAAK,WAAA,GACrBmQ,CAAAA,CAAQ,MAAA,CAAOtR,UAAAA,CAAW,uBAAuB,CAAA,CACnDtG,CAAAA,CAAO,IAAA,CACLuZ,EAAAA,CACE3B,CAAAA,CAAQ,aAAA,CAActR,UAAAA,CAAW,uBAAuB,CAC1D,CACF,EACSsR,CAAAA,CAAQ,MAAA,CAAOtR,UAAAA,CAAW,sBAAsB,CAAA,CACzDtG,CAAAA,CAAO,KACLwZ,EAAAA,CACE5B,CAAAA,CAAQ,aAAA,CAActR,UAAAA,CAAW,sBAAsB,CACzD,CACF,CAAA,CAEAtG,CAAAA,CAAO,IAAA,CAAKyZ,EAAAA,CAAW7B,CAAO,CAAC,EAGnC,OAAO5X,CACT,CAEA,SAASyZ,EAAAA,CAAWhS,CAAAA,CAAgB,CAClC,OAAQA,CAAAA,CAAK,OAAA,EAAQ,EACnB,KAAKnB,WAAW,aAAA,CACd,OAAOmB,CAAAA,CAAK,OAAA,EAAQ,CACtB,KAAKnB,WAAW,cAAA,CACd,OAAO,MAAA,CAAOmB,CAAAA,CAAK,OAAA,EAAS,EAC9B,KAAKnB,UAAAA,CAAW,WAAA,CACd,OAAO,KAAA,CACT,KAAKA,WAAW,YAAA,CACd,OAAO,MAAA,CACT,KAAKA,UAAAA,CAAW,WAAA,CACd,OAAO,IAAA,CACT,KAAKA,UAAAA,CAAW,sBAAA,CACd,OAAOmB,CAAAA,CAAK,aAAY,CAAE,GAAA,CAAIgS,EAAU,CAAA,CAC1C,KAAKnT,UAAAA,CAAW,wBACd,OAAOiT,EAAAA,CAA6B9R,CAAI,CAAA,CAC1C,QACE,OAAOA,EAAK,OAAA,EAChB,CACF,CAEO,SAASiS,EAAAA,CACdC,EACA,CACA,IAAM3Z,CAAAA,CAA8B,EAAC,CAErC,IAAA,IAAWzE,KAAO,MAAA,CAAO,IAAA,CAAKoe,CAAO,CAAA,CAAG,CACtC,IAAMxV,CAAAA,CAAQ5I,CAAAA,CAAI,KAAA,CAAM,GAAG,CAAA,CACrBqe,CAAAA,CAAYzV,CAAAA,CAAM,CAAC,EACnB0V,CAAAA,CAAU1V,CAAAA,CAAM,KAAA,CAAM,CAAC,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,CAEnC0V,CAAAA,GAAY,EAAA,CACV,OAAO7Z,CAAAA,CAAO4Z,CAAS,GAAM,QAAA,CAC/B5Z,CAAAA,CAAO4Z,CAAS,CAAA,CAAE,OAAA,CAAU,CAAA,UAAA,EAAare,CAAG,CAAA,EAAA,CAAA,CAE5CyE,CAAAA,CAAO4Z,CAAS,CAAA,CAAI,CAAA,UAAA,EAAare,CAAG,MAGlC,OAAOyE,CAAAA,CAAO4Z,CAAS,CAAA,EAAM,QAAA,GAC/B5Z,CAAAA,CAAO4Z,CAAS,CAAA,CAAI,CAAE,OAAA,CAAS,CAAA,UAAA,EAAaA,CAAS,CAAA,EAAA,CAAK,GAE5D5Z,CAAAA,CAAO4Z,CAAS,CAAA,CAAEC,CAAO,CAAA,CAAI,CAAA,UAAA,EAAate,CAAG,CAAA,EAAA,CAAA,EAEjD,CAGA,IAAA,GAAW,CAACqe,CAAAA,CAAWve,CAAK,IAAK,MAAA,CAAO,OAAA,CAAQ2E,CAAM,CAAA,CAElD,OAAO3E,CAAAA,EAAU,UACjBA,CAAAA,CAAM,OAAA,GAAY,CAAA,UAAA,EAAaue,CAAS,CAAA,EAAA,CAAA,EACxC,EAAEA,KAAaD,CAAAA,CAAAA,EAEf,OAAOte,CAAAA,CAAM,OAAA,CAIjB,OAAO2E,CACT,CCvfO,SAAS8Z,EAAAA,CACd3F,CAAAA,CACA5V,CAAAA,CACA,CACA,IAAMwb,EAA0D,EAAC,CAC3DC,CAAAA,CAAgB,CAAC,GAAG7F,CAAK,EAE/B,GAAI,CAAC5V,CAAAA,EAAQ,UAAA,CACX,OAAAoV,EAAAA,CAAmB,EAAE,CAAA,CACdqG,CAAAA,CAGT,IAAA,IAAS/P,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI+P,EAAc,MAAA,CAAQ/P,CAAAA,EAAAA,CAAK,CAC7C,IAAMgQ,CAAAA,CAAW7F,EAAAA,CAAkC4F,EAAc/P,CAAC,CAAA,CAAG1L,CAAM,CAAA,CAEvE0b,CAAAA,GACFD,CAAAA,CAAc/P,CAAC,CAAA,CAAIgQ,CAAAA,CAAS,GAAA,CAExB,MAAA,CAAO,IAAA,CAAKA,CAAAA,CAAS,OAAO,CAAA,CAAE,MAAA,CAAS,CAAA,GACzCF,CAAAA,CAAgBE,CAAAA,CAAS,GAAG,EAAIA,CAAAA,CAAS,OAAA,CAAA,EAG/C,CAEA,OAAAtG,EAAAA,CAAmBoG,CAAe,EAE3BC,CACT,CAIA,eAAsBE,EAAAA,CACpB/F,CAAAA,CACA5V,CAAAA,CACAxC,EAAkC,EAAC,CACnC,CAoCA,OAnCgB,MAAM,OAAA,CAAQ,IAC5BoY,CAAAA,CAAM,GAAA,CAAI,MAAOpX,GAAAA,EAAS,CACxB,GAAI+V,GAAY/V,GAAI,CAAA,CAClB,OAAOuZ,EAAAA,CAAmBvZ,GAAI,CAAA,CAGhC,GAAI8V,CAAAA,CAAM9V,GAAI,CAAA,CAAG,CACf,GAAM,CAACiD,CAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc,CAAChZ,GAAI,CAAA,CAAGhB,CAAO,CAAA,CACpD,GAAI,CACF,OAAO0a,CAAAA,CAAmB,KAAA,CAAMzW,CAAM,CACxC,CAAA,MAASR,CAAAA,CAAO,CACd,MAAM,IAAI1C,EAAmBC,GAAAA,CAAMyC,CAAK,CAC1C,CACF,CAEA,GAAIzC,IAAK,UAAA,CAAW,GAAG,CAAA,EAAKwB,CAAAA,EAAQ,UAAA,CAAY,CAC9C,IAAM2E,CAAAA,CAAQ4W,EAAAA,CAAmC,CAAC/c,GAAI,CAAA,CAAGwB,CAAM,CAAA,CACzD,CAACyB,CAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc7S,CAAAA,CAAOnH,CAAO,EACnD,GAAI,CACF,OAAO0a,CAAAA,CAAmB,KAAA,CAAMzW,CAAM,CACxC,CAAA,MAASR,CAAAA,CAAO,CACd,MAAM,IAAI1C,CAAAA,CAAmBC,IAAMyC,CAAK,CAC1C,CACF,CAEA,IAAMH,CAAAA,CAAO,UAAUd,CAAAA,EAAQ,KAAA,EAAS,aAAa,CAAA,CAAA,EAAIxB,GAAI,CAAA,KAAA,CAAA,CACvD,CAACiD,CAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc,CAAC1W,CAAI,EAAGtD,CAAO,CAAA,CACpD,GAAI,CACF,OAAO0a,CAAAA,CAAmB,KAAA,CAAMzW,CAAM,CACxC,CAAA,MAASR,CAAAA,CAAO,CACd,MAAM,IAAI1C,EAAmBC,GAAAA,CAAMyC,CAAK,CAC1C,CACF,CAAC,CACH,CAGF,CAGqC2a,CAAAA,CAClC,MAAA,CAAO,CACN,KAAMC,CAAAA,CACN,OAAA,CAASnd,CAAAA,CAAE,MAAA,EAAO,CAAE,QAAA,GAEpB,IAAA,CAAMod,CAAAA,CAAuB,QAAA,EAAS,CACtC,MAAA,CAAQpd,CAAAA,CAAE,KAAI,CAAE,QAAA,EAClB,CAAC,CAAA,CACA,WAAA,GAIH,eAAsBqd,EAAAA,CACpBC,CAAAA,CACAhc,GAAAA,CACAxC,CAAAA,CAAkC,GAClC,CACAA,CAAAA,CAAU,CACR,QAAA,CAAU,IAAA,CACV,GAAGA,CACL,CAAA,CAEA,IAAIye,CAAAA,CAA0D,EAAC,CAC3DC,GAAAA,CAAqE,GACrEC,CAAAA,CAAuC,EAAC,CAEtCC,CAAAA,CAAc,KAAA,CAAM,IAAA,CAAK,IAAI,GAAA,CAAIJ,CAAK,CAAC,CAAA,CAEvCK,CAAAA,CAAU,MAAMV,GAAmBS,CAAAA,CAAapc,GAAAA,CAAQxC,CAAO,CAAA,CAE/D8e,CAAAA,CAAY,IAAI,IACtB,IAAA,IAAS5Q,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI2Q,CAAAA,CAAQ,MAAA,CAAQ3Q,IAC9B2Q,CAAAA,CAAQ3Q,CAAC,CAAA,EACX4Q,CAAAA,CAAU,GAAA,CAAIF,CAAAA,CAAY1Q,CAAC,CAAA,CAAG2Q,CAAAA,CAAQ3Q,CAAC,CAAC,CAAA,CAI5C,IAAA,GAAW,CAAC6Q,CAAAA,CAAY/d,CAAI,CAAA,GAAK,KAAA,CAAM,IAAA,CAAK8d,CAAAA,CAAU,SAAS,CAAA,CAAG,CAEhE,IAAME,CAAAA,CAA+D,CACnE,GAAGhe,CAAAA,CACH,OAAA,CAAS+d,CACX,CAAA,CAGA,GAFAN,CAAAA,CAAQ,KAAKO,CAAc,CAAA,CAEvBhe,CAAAA,CAAK,oBAAA,CAAsB,CAE7B,IAAIie,EAAuBje,CAAAA,CAAK,oBAAA,CAGhC,GAAKwB,GAAAA,EAAQ,UAAA,CASXyc,CAAAA,CAAuBlB,GACrB/c,CAAAA,CAAK,oBAAA,CACLwB,GACF,CAAA,CAAA,KAZuB,CACvB,IAAM0c,EAAiBle,CAAAA,CAAK,oBAAA,CAAqB,MAAA,CAAQyF,CAAAA,EACvDA,CAAAA,CAAI,UAAA,CAAW,GAAG,CACpB,CAAA,CACA,GAAIyY,CAAAA,CAAe,MAAA,CAAS,CAAA,CAAG,CAC7B,GAAM,CAAE,QAAA,CAAAtG,CAAS,CAAA,CAAI7W,EAAAA,CAA+Bmd,CAAAA,CAAe,CAAC,CAAC,CAAA,CACrE,MAAM,IAAIve,CAAAA,CAA2BiY,CAAQ,CAC/C,CACF,CAOA,GAAM,CAAE,KAAA,CAAAR,CAAAA,CAAO,cAAA+G,CAAc,CAAA,CAAI,MAAMC,EAAAA,CACrCH,CAAAA,CACAzc,GAAAA,CACAxC,EACA,IAAI,GAAA,CAAI4e,CAAW,CACrB,CAAA,CACAF,GAAAA,CAAmB,KAAK,GAAGtG,CAAK,CAAA,CAChCuG,CAAAA,CAA2B,IAAA,CAAK,GAAGQ,CAAa,EAClD,CACF,CAKA,GAHAV,CAAAA,CAAQ,IAAA,CAAK,GAAGC,GAAkB,CAAA,CAG9BC,CAAAA,CAA2B,MAAA,CAAS,CAAA,CAAG,CAEzC,IAAMU,CAAAA,CAAsB,KAAA,CAAM,IAAA,CAAK,IAAI,GAAA,CAAIV,CAA0B,CAAC,CAAA,CAGpEW,CAAAA,CAAqBD,CAAAA,CAAoB,MAAA,CAC5C7d,CAAAA,EAAS,CAACA,EAAK,UAAA,CAAW,GAAG,CAChC,CAAA,CACM+d,CAAAA,CAAqBF,CAAAA,CAAoB,OAAQ7d,CAAAA,EACrDA,CAAAA,CAAK,UAAA,CAAW,GAAG,CACrB,CAAA,CAGA,GAAI+d,CAAAA,CAAmB,MAAA,CAAS,CAAA,CAAG,CAEjC,IAAMC,CAAAA,CAAa,MAAMrB,EAAAA,CACvBoB,CAAAA,CACA/c,GAAAA,CACAxC,CACF,CAAA,CAEA,IAAA,IAASkO,EAAI,CAAA,CAAGA,CAAAA,CAAIsR,CAAAA,CAAW,MAAA,CAAQtR,CAAAA,EAAAA,CAAK,CAE1C,IAAM8Q,CAAAA,CAA+D,CACnE,GAFWQ,CAAAA,CAAWtR,CAAC,CAAA,CAGvB,QAASqR,CAAAA,CAAmBrR,CAAC,CAC/B,CAAA,CACAuQ,CAAAA,CAAQ,IAAA,CAAKO,CAAc,EAC7B,CACF,CAGA,GAAIM,CAAAA,CAAmB,MAAA,CAAS,CAAA,CAAG,CACjC,IAAM5O,CAAAA,CAAQ,MAAM+O,EAAAA,EAAuB,CAC3C,GAAI,CAAC/O,CAAAA,EAAS+N,CAAAA,CAAQ,MAAA,GAAW,CAAA,CAC/B,OAAO,IAAA,CAGT,GAAI/N,CAAAA,CAAO,CAEL4O,CAAAA,CAAmB,QAAA,CAAS,OAAO,CAAA,EACrCA,EAAmB,OAAA,CAAQ,OAAO,CAAA,CAKpC,IAAMI,CAAAA,CAAyB,GAC/B,IAAA,IAAWle,EAAAA,IAAQ8d,CAAAA,CAAoB,CACrC,IAAMK,EAAAA,CAAmB,MAAMC,EAAAA,CAC7Bpe,EAAAA,CACAgB,GAAAA,CACAxC,CACF,CAAA,CACA0f,CAAAA,CAAa,KAAK,GAAGC,EAAgB,EACvC,CAGA,IAAME,CAAAA,CAAa,MAAM,IAAA,CAAK,IAAI,GAAA,CAAIH,CAAY,CAAC,CAAA,CAC/Czb,EAAS,MAAM+V,CAAAA,CAAc6F,CAAAA,CAAY7f,CAAO,CAAA,CAC9C8f,GAAAA,CAAkB5e,EAAE,KAAA,CAAMwZ,CAAkB,CAAA,CAAE,KAAA,CAAMzW,CAAM,CAAA,CAChEwa,EAAQ,IAAA,CAAK,GAAGqB,GAAe,EACjC,CACF,CACF,CAEA,GAAI,CAACrB,CAAAA,CAAQ,MAAA,CACX,OAAO,IAAA,CAST,IACEG,CAAAA,CAAY,QAAA,CAAS,OAAO,CAAA,EAC5BD,CAAAA,CAA2B,QAAA,CAAS,OAAO,CAAA,GAEvCnc,GAAAA,CAAO,QAAA,CAAS,SAAA,CAAW,CAC7B,IAAMsZ,EAAQ,MAAMiE,EAAAA,CAAiBvd,GAAAA,CAAO,QAAA,CAAS,SAAA,CAAWA,GAAM,CAAA,CAClEsZ,CAAAA,EACF2C,CAAAA,CAAQ,OAAA,CAAQ3C,CAAK,EAEzB,CAIF,IAAMkE,EAAY,IAAI,GAAA,CAItBvB,CAAAA,CAAQ,OAAA,CAASzd,CAAAA,EAAS,CAExB,IAAMif,CAAAA,CAASjf,CAAAA,CAAK,OAAA,EAAWA,CAAAA,CAAK,IAAA,CACpCgf,CAAAA,CAAU,IAAIhf,CAAAA,CAAMif,CAAM,EAC5B,CAAC,CAAA,CAGDxB,CAAAA,CAAUyB,GAA6BzB,CAAAA,CAASuB,CAAS,CAAA,CAIzDvB,CAAAA,CAAQ,IAAA,CAAK,CAACtK,EAAGC,CAAAA,GACXD,CAAAA,CAAE,IAAA,GAAS,gBAAA,EAAoBC,CAAAA,CAAE,IAAA,GAAS,iBACrC,EAAA,CAELD,CAAAA,CAAE,IAAA,GAAS,gBAAA,EAAoBC,CAAAA,CAAE,IAAA,GAAS,iBACrC,CAAA,CAEF,CACR,CAAA,CAED,IAAI+L,CAAAA,CAAW,EAAC,CAChB1B,CAAAA,CAAQ,OAAA,CAASzd,CAAAA,EAAS,CACxBmf,CAAAA,CAAWzI,EAAAA,CAAUyI,CAAAA,CAAUnf,EAAK,QAAA,EAAY,EAAE,EACpD,CAAC,CAAA,CAED,IAAI4c,CAAAA,CAAU,EAAC,CACfa,CAAAA,CAAQ,OAAA,CAASzd,CAAAA,EAAS,CACxB4c,CAAAA,CAAUlG,EAAAA,CAAUkG,CAAAA,CAAS5c,CAAAA,CAAK,OAAA,EAAW,EAAE,EACjD,CAAC,CAAA,CAED,IAAIof,CAAAA,CAAM,GACV3B,CAAAA,CAAQ,OAAA,CAASzd,CAAAA,EAAS,CACxBof,CAAAA,CAAM1I,EAAAA,CAAU0I,EAAKpf,CAAAA,CAAK,GAAA,EAAO,EAAE,EACrC,CAAC,EAED,IAAIqf,CAAAA,CAAO,EAAA,CACX5B,CAAAA,CAAQ,OAAA,CAASzd,CAAAA,EAAS,CACpBA,CAAAA,CAAK,IAAA,GACPqf,CAAAA,EAAQ,CAAA,EAAGrf,CAAAA,CAAK,IAAI;AAAA,CAAA,EAExB,CAAC,CAAA,CAED,IAAIsf,CAAAA,CAAU,EAAC,CACf7B,CAAAA,CAAQ,OAAA,CAASzd,CAAAA,EAAS,CACxBsf,CAAAA,CAAU5I,EAAAA,CAAU4I,EAAStf,CAAAA,CAAK,OAAA,EAAW,EAAE,EACjD,CAAC,CAAA,CAGD,IAAMuf,EAAoB,MAAMrJ,EAAAA,CAC9BuH,CAAAA,CAAQ,GAAA,CAAKzd,CAAAA,EAASA,CAAAA,CAAK,KAAA,EAAS,EAAE,CAAA,CACtCwB,GACF,CAAA,CAGMge,CAAAA,CAA4B/B,CAAAA,CAC/B,MAAA,CAAQzd,CAAAA,EAASA,CAAAA,CAAK,OAAS,eAAA,EAAmBA,CAAAA,CAAK,IAAI,CAAA,CAC3D,GAAA,CAAKA,CAAAA,GAAU,CACd,GAAGA,EACH,IAAA,CAAM,eAAA,CACN,IAAA,CAAMA,CAAAA,CAAK,IACb,CAAA,CAAE,CAAA,CAEEsZ,CAAAA,CAASmG,EAAgC,KAAA,CAAM,CACnD,YAAA,CAAc/I,EAAAA,CAAU,GAAA,CAAI+G,CAAAA,CAAQ,GAAA,CAAKzd,CAAAA,EAASA,EAAK,YAAA,EAAgB,EAAE,CAAC,CAAA,CAC1E,eAAA,CAAiB0W,EAAAA,CAAU,GAAA,CACzB+G,EAAQ,GAAA,CAAKzd,CAAAA,EAASA,CAAAA,CAAK,eAAA,EAAmB,EAAE,CAClD,CAAA,CACA,MAAOuf,CAAAA,CACP,QAAA,CAAAJ,CAAAA,CACA,OAAA,CAAAvC,CAAAA,CACA,GAAA,CAAAwC,CAAAA,CACA,IAAA,CAAAC,EACA,KAAA,CAAOG,CAAAA,CAAM,MAAA,CAAS,CAAA,CAAIA,CAAAA,CAAQ,MACpC,CAAC,CAAA,CAED,OAAI,MAAA,CAAO,IAAA,CAAKF,CAAO,CAAA,CAAE,MAAA,CAAS,CAAA,GAChChG,CAAAA,CAAO,OAAA,CAAUgG,GAGZhG,CACT,CAEA,eAAe8E,EAAAA,CACblJ,CAAAA,CACA1T,CAAAA,CACAxC,CAAAA,CAAkC,GAClC0gB,CAAAA,CAAuB,IAAI,GAAA,CAC3B,CACA,IAAMtI,CAAAA,CAA8C,EAAC,CAC/C+G,EAA0B,EAAC,CAEjC,IAAA,IAAW1Y,CAAAA,IAAOyP,CAAAA,CAChB,GAAI,CAAAwK,CAAAA,CAAQ,IAAIja,CAAG,CAAA,CAAA,CAMnB,GAHAia,CAAAA,CAAQ,GAAA,CAAIja,CAAG,CAAA,CAGXqQ,CAAAA,CAAMrQ,CAAG,CAAA,EAAKsQ,EAAAA,CAAYtQ,CAAG,CAAA,CAAG,CAClC,GAAM,CAACzF,CAAI,CAAA,CAAI,MAAMmd,EAAAA,CAAmB,CAAC1X,CAAG,CAAA,CAAGjE,CAAAA,CAAQxC,CAAO,EAC9D,GAAIgB,CAAAA,GACFoX,CAAAA,CAAM,IAAA,CAAKpX,CAAI,CAAA,CACXA,CAAAA,CAAK,oBAAA,CAAA,CAAsB,CAE7B,IAAM2f,CAAAA,CAAene,CAAAA,EAAQ,UAAA,CACzBub,EAAAA,CACE/c,CAAAA,CAAK,oBAAA,CACLwB,CACF,EACAxB,CAAAA,CAAK,oBAAA,CAEH4f,CAAAA,CAAS,MAAMxB,EAAAA,CACnBuB,CAAAA,CACAne,CAAAA,CACAxC,CAAAA,CACA0gB,CACF,CAAA,CACAtI,CAAAA,CAAM,IAAA,CAAK,GAAGwI,CAAAA,CAAO,KAAK,CAAA,CAC1BzB,CAAAA,CAAc,KAAK,GAAGyB,CAAAA,CAAO,aAAa,EAC5C,CAEJ,CAAA,KAAA,GAESna,CAAAA,CAAI,UAAA,CAAW,GAAG,CAAA,EAAKjE,CAAAA,EAAQ,UAAA,CAAY,CAElD,GAAM,CAAE,QAAA,CAAAoW,CAAS,EAAI7W,EAAAA,CAA+B0E,CAAG,CAAA,CACvD,GAAImS,CAAAA,EAAY,EAAEA,CAAAA,IAAYpW,CAAAA,CAAO,YACnC,MAAM,IAAI7B,CAAAA,CAA2BiY,CAAQ,CAAA,CAK/C,GAAM,CAAC5X,CAAI,EAAI,MAAMmd,EAAAA,CAAmB,CAAC1X,CAAG,CAAA,CAAGjE,CAAAA,CAAQxC,CAAO,CAAA,CAC9D,GAAIgB,CAAAA,GACFoX,CAAAA,CAAM,IAAA,CAAKpX,CAAI,CAAA,CACXA,CAAAA,CAAK,oBAAA,CAAA,CAAsB,CAE7B,IAAM2f,CAAAA,CAAene,CAAAA,EAAQ,UAAA,CACzBub,EAAAA,CACE/c,CAAAA,CAAK,oBAAA,CACLwB,CACF,CAAA,CACAxB,EAAK,oBAAA,CAEH4f,CAAAA,CAAS,MAAMxB,EAAAA,CACnBuB,CAAAA,CACAne,CAAAA,CACAxC,CAAAA,CACA0gB,CACF,EACAtI,CAAAA,CAAM,IAAA,CAAK,GAAGwI,CAAAA,CAAO,KAAK,CAAA,CAC1BzB,CAAAA,CAAc,IAAA,CAAK,GAAGyB,CAAAA,CAAO,aAAa,EAC5C,CAEJ,CAAA,KAAA,GAGEzB,CAAAA,CAAc,IAAA,CAAK1Y,CAAG,CAAA,CAElBjE,CAAAA,CACF,GAAI,CACF,GAAM,CAACxB,CAAI,CAAA,CAAI,MAAMmd,EAAAA,CAAmB,CAAC1X,CAAG,CAAA,CAAGjE,CAAAA,CAAQxC,CAAO,CAAA,CAC9D,GAAIgB,GAAQA,CAAAA,CAAK,oBAAA,CAAsB,CAErC,IAAM2f,CAAAA,CAAene,CAAAA,EAAQ,UAAA,CACzBub,EAAAA,CACE/c,EAAK,oBAAA,CACLwB,CACF,CAAA,CACAxB,CAAAA,CAAK,oBAAA,CAEH4f,CAAAA,CAAS,MAAMxB,EAAAA,CACnBuB,EACAne,CAAAA,CACAxC,CAAAA,CACA0gB,CACF,CAAA,CACAtI,CAAAA,CAAM,IAAA,CAAK,GAAGwI,CAAAA,CAAO,KAAK,CAAA,CAC1BzB,CAAAA,CAAc,IAAA,CAAK,GAAGyB,CAAAA,CAAO,aAAa,EAC5C,CACF,MAAgB,CAGhB,CAAA,CAKN,OAAO,CAAE,KAAA,CAAAxI,CAAAA,CAAO,aAAA,CAAA+G,CAAc,CAChC,CAEA,eAAeS,EAAAA,CACb1f,CAAAA,CACAsC,CAAAA,CACAxC,CAAAA,CAAkC,EAAC,CACnC,CACA,GAAI8W,CAAAA,CAAM5W,CAAG,CAAA,CACX,OAAO,CAACA,CAAG,CAAA,CAGb,GAAM,CAAE,aAAA,CAAAif,CAAc,CAAA,CAAI,MAAMC,EAAAA,CAC9B,CAAClf,CAAG,EACJsC,CAAAA,CACAxC,CAAAA,CACA,IAAI,GACN,CAAA,CAEM6gB,CAAAA,CAAQre,CAAAA,CAAO,aAAA,EAAe,IAChC,MAAMqC,EAAAA,CAAyBrC,CAAAA,CAAO,aAAA,CAAc,GAAA,CAAKA,CAAAA,CAAO,KAAK,CAAA,CACrEA,EAAO,KAAA,CAELse,CAAAA,CAAO3B,CAAAA,CAAc,GAAA,CAAK3d,CAAAA,EAC9BmY,EAAAA,CAAmB7C,CAAAA,CAAMtV,CAAI,EAAIA,CAAAA,CAAO,CAAA,OAAA,EAAUqf,CAAK,CAAA,CAAA,EAAIrf,CAAI,CAAA,KAAA,CAAO,CACxE,CAAA,CAEA,OAAO,KAAA,CAAM,IAAA,CAAK,IAAI,GAAA,CAAIsf,CAAI,CAAC,CACjC,CAEA,eAAef,EAAAA,CAAiBve,CAAAA,CAAcgB,CAAAA,CAAgB,CAC5D,GAAM,CAAC2N,CAAAA,CAAWtK,CAAe,CAAA,CAAI,MAAM,OAAA,CAAQ,GAAA,CAAI,CACrDuK,EAAAA,CAAqB5O,CAAI,CAAA,CACzBgG,GAAoChF,CAAM,CAC5C,CAAC,CAAA,CACD,GAAI,CAAC2N,CAAAA,CACH,OAAO,KAIT,IAAM2L,CAAAA,CAAQ,CACZ,IAAA,CAAAta,CAAAA,CACA,IAAA,CAAM,gBAAA,CACN,QAAA,CAAU,CACR,MAAA,CAAQ,CACN,KAAA,CAAO,CACL,MAAA,CAAQ,CACN,YAAA,CAAc,CACZ,GAAI,eAAA,CACJ,EAAA,CAAI,2BAAA,CACJ,EAAA,CAAI,2BACN,CAAA,CACA,MAAA,CAAQ,EACV,CACF,CACF,CACF,CAAA,CACA,OAAA,CAAS,CACP,KAAA,CAAO,GACP,KAAA,CAAO,CACL,MAAA,CAAQ,QACV,CAAA,CACA,IAAA,CAAM,EACR,CACF,CAAA,CAEA,OAAIgB,CAAAA,CAAO,QAAA,CAAS,YAAA,GAClBsZ,CAAAA,CAAM,QAAA,CAAS,MAAA,CAAO,MAAM,MAAA,CAAO,MAAA,CAAS,CAC1C,GAAGA,CAAAA,CAAM,QAAA,CAAS,MAAA,CAAO,KAAA,CAAM,OAAO,MAAA,CACtC,GAAG6B,EAAAA,CAAoCxN,CAAAA,CAAU,OAAA,CAAQ,IAAA,EAAQ,EAAE,CACrE,CAAA,CACA2L,CAAAA,CAAM,OAAA,CAAU,CACd,KAAA,CAAO,CACL,GAAG3L,CAAAA,CAAU,QAAQ,KAAA,CACrB,GAAG2L,CAAAA,CAAM,OAAA,CAAQ,KACnB,CAAA,CACA,KAAA,CAAO,CACL,GAAG3L,CAAAA,CAAU,OAAA,CAAQ,KAAA,CACrB,GAAG2L,CAAAA,CAAM,OAAA,CAAQ,KACnB,CAAA,CACA,KAAM,CACJ,GAAG3L,CAAAA,CAAU,OAAA,CAAQ,IAAA,CACrB,GAAG2L,CAAAA,CAAM,OAAA,CAAQ,IACnB,CACF,CAAA,CAEIjW,CAAAA,GAAoB,IAAA,EAAQsK,CAAAA,CAAU,SAAA,GACxC2L,CAAAA,CAAM,OAAA,CAAU,CACd,KAAA,CAAO,CACL,GAAG3L,CAAAA,CAAU,SAAA,CAAU,KAAA,CACvB,GAAG2L,CAAAA,CAAM,OAAA,CAAQ,KACnB,CAAA,CACA,KAAA,CAAO,CACL,MAAA,CAAQ,UAAA,CACR,GAAG3L,EAAU,SAAA,CAAU,KACzB,CAAA,CACA,IAAA,CAAM,CACJ,GAAGA,CAAAA,CAAU,SAAA,CAAU,IACzB,CACF,CAAA,CAAA,CAAA,CAIG2L,CACT,CAEA,SAASiF,CAAAA,CACP/f,CAAAA,CACAif,CAAAA,CACA,CACA,IAAMe,CAAAA,CAAaf,CAAAA,EAAUjf,CAAAA,CAAK,IAAA,CAE5BigB,CAAAA,CAAOC,UAAAA,CAAW,QAAQ,EAC7B,MAAA,CAAOF,CAAU,CAAA,CACjB,MAAA,CAAO,KAAK,CAAA,CACZ,SAAA,CAAU,CAAA,CAAG,CAAC,CAAA,CAEjB,OAAO,CAAA,EAAGhgB,CAAAA,CAAK,IAAI,CAAA,EAAA,EAAKigB,CAAI,CAAA,CAC9B,CAEA,SAASE,EAAAA,CAAoC1K,CAAAA,CAAoB,CAC/D,GAAIK,CAAAA,CAAML,CAAU,CAAA,CAAG,CAErB,IAAM2K,CAAAA,CADM,IAAI,GAAA,CAAI3K,CAAU,CAAA,CACT,QAAA,CACf7W,CAAAA,CAAQwhB,EAAS,KAAA,CAAM,kBAAkB,CAAA,CACzC5f,CAAAA,CAAO5B,CAAAA,CAAQA,CAAAA,CAAM,CAAC,CAAA,CAAI0D,WAAK,QAAA,CAAS8d,CAAAA,CAAU,OAAO,CAAA,CAE/D,OAAO,CACL,IAAA,CAAA5f,CAAAA,CACA,KAAMuf,CAAAA,CAAgB,CAAE,IAAA,CAAAvf,CAAK,CAAA,CAAGiV,CAAU,CAC5C,CACF,CAEA,GAAIM,EAAAA,CAAYN,CAAU,CAAA,CAAG,CAC3B,IAAM7W,CAAAA,CAAQ6W,CAAAA,CAAW,MAAM,kBAAkB,CAAA,CAC3CjV,CAAAA,CAAO5B,CAAAA,CAAQA,CAAAA,CAAM,CAAC,CAAA,CAAI0D,UAAAA,CAAK,SAASmT,CAAAA,CAAY,OAAO,CAAA,CAEjE,OAAO,CACL,IAAA,CAAAjV,CAAAA,CACA,IAAA,CAAMuf,EAAgB,CAAE,IAAA,CAAAvf,CAAK,CAAA,CAAGiV,CAAU,CAC5C,CACF,CAEA,GAAM,CAAE,IAAA,CAAAzV,CAAK,CAAA,CAAIe,EAAAA,CAA+B0U,CAAU,CAAA,CAC1D,OAAO,CACL,IAAA,CAAMzV,CAAAA,CACN,IAAA,CAAM+f,CAAAA,CAAgB,CAAE,IAAA,CAAM/f,CAAK,EAAGyV,CAAU,CAClD,CACF,CAEA,SAASyJ,EAAAA,CACP9H,CAAAA,CACA4H,CAAAA,CACA,CACA,IAAMqB,CAAAA,CAAU,IAAI,GAAA,CAIdC,CAAAA,CAAa,IAAI,GAAA,CAIjBC,CAAAA,CAAW,IAAI,GAAA,CACfC,CAAAA,CAAgB,IAAI,GAAA,CAE1BpJ,CAAAA,CAAM,OAAA,CAASpX,CAAAA,EAAS,CACtB,IAAMif,CAAAA,CAASD,CAAAA,CAAU,GAAA,CAAIhf,CAAI,CAAA,EAAKA,CAAAA,CAAK,IAAA,CACrCigB,CAAAA,CAAOF,EAAgB/f,CAAAA,CAAMif,CAAM,CAAA,CAEzCoB,CAAAA,CAAQ,GAAA,CAAIJ,CAAAA,CAAMjgB,CAAI,CAAA,CACtBsgB,EAAW,GAAA,CAAIL,CAAAA,CAAMjgB,CAAI,CAAA,CACzBugB,CAAAA,CAAS,GAAA,CAAIN,CAAAA,CAAM,CAAC,EACpBO,CAAAA,CAAc,GAAA,CAAIP,CAAAA,CAAM,EAAE,EAC5B,CAAC,CAAA,CAGD,IAAMQ,CAAAA,CAAc,IAAI,GAAA,CACxBrJ,CAAAA,CAAM,OAAA,CAASpX,CAAAA,EAAS,CACtB,IAAMif,EAASD,CAAAA,CAAU,GAAA,CAAIhf,CAAI,CAAA,EAAKA,CAAAA,CAAK,IAAA,CACrCigB,CAAAA,CAAOF,CAAAA,CAAgB/f,EAAMif,CAAM,CAAA,CAEpCwB,CAAAA,CAAY,GAAA,CAAIzgB,CAAAA,CAAK,IAAI,CAAA,EAC5BygB,CAAAA,CAAY,IAAIzgB,CAAAA,CAAK,IAAA,CAAM,EAAE,CAAA,CAE/BygB,CAAAA,CAAY,GAAA,CAAIzgB,CAAAA,CAAK,IAAI,CAAA,CAAG,IAAA,CAAKigB,CAAI,CAAA,CAEjChB,CAAAA,GAAWjf,CAAAA,CAAK,IAAA,GACbygB,CAAAA,CAAY,IAAIxB,CAAM,CAAA,EACzBwB,CAAAA,CAAY,GAAA,CAAIxB,CAAAA,CAAQ,EAAE,CAAA,CAE5BwB,EAAY,GAAA,CAAIxB,CAAM,CAAA,CAAG,IAAA,CAAKgB,CAAI,CAAA,EAEtC,CAAC,CAAA,CAED7I,EAAM,OAAA,CAASpX,CAAAA,EAAS,CACtB,IAAM0gB,CAAAA,CAAa1B,CAAAA,CAAU,GAAA,CAAIhf,CAAI,CAAA,EAAKA,CAAAA,CAAK,IAAA,CACzC2gB,CAAAA,CAAWZ,CAAAA,CAAgB/f,CAAAA,CAAM0gB,CAAU,CAAA,CAE7C1gB,EAAK,oBAAA,EACPA,CAAAA,CAAK,oBAAA,CAAqB,OAAA,CAASyF,CAAAA,EAAQ,CACzC,IAAImb,CAAAA,CAEEC,EAAeJ,CAAAA,CAAY,GAAA,CAAIhb,CAAG,CAAA,EAAK,EAAC,CAC9C,GAAIob,CAAAA,CAAa,SAAW,CAAA,CAC1BD,CAAAA,CAAUC,CAAAA,CAAa,CAAC,CAAA,CAAA,KAAA,GACfA,CAAAA,CAAa,MAAA,CAAS,CAAA,CAG/BD,EAAUC,CAAAA,CAAa,CAAC,CAAA,CAAA,KACnB,CACL,GAAM,CAAE,IAAA,CAAArgB,CAAK,EAAI2f,EAAAA,CAAoC1a,CAAG,CAAA,CAClDqb,CAAAA,CAAcL,CAAAA,CAAY,GAAA,CAAIjgB,CAAI,CAAA,EAAK,EAAC,CAC1CsgB,CAAAA,CAAY,MAAA,CAAS,CAAA,GACvBF,CAAAA,CAAUE,CAAAA,CAAY,CAAC,CAAA,EAE3B,CAEIF,CAAAA,EAAWP,CAAAA,CAAQ,GAAA,CAAIO,CAAO,CAAA,GAChCJ,CAAAA,CAAc,GAAA,CAAII,CAAO,EAAG,IAAA,CAAKD,CAAQ,CAAA,CACzCJ,CAAAA,CAAS,GAAA,CAAII,CAAAA,CAAUJ,CAAAA,CAAS,GAAA,CAAII,CAAQ,CAAA,CAAK,CAAC,CAAA,EAEtD,CAAC,EAEL,CAAC,CAAA,CAGD,IAAMI,EAAkB,EAAC,CACnBC,CAAAA,CAAyD,EAAC,CAQhE,IANAT,CAAAA,CAAS,OAAA,CAAQ,CAACU,CAAAA,CAAQhB,CAAAA,GAAS,CAC7BgB,CAAAA,GAAW,CAAA,EACbF,CAAAA,CAAM,IAAA,CAAKd,CAAI,EAEnB,CAAC,CAAA,CAEMc,CAAAA,CAAM,MAAA,CAAS,CAAA,EAAG,CACvB,IAAMG,CAAAA,CAAcH,EAAM,KAAA,EAAM,CAC1B/gB,CAAAA,CAAOqgB,CAAAA,CAAQ,GAAA,CAAIa,CAAW,CAAA,CACpCF,CAAAA,CAAO,KAAKhhB,CAAI,CAAA,CAEhBwgB,CAAAA,CAAc,GAAA,CAAIU,CAAW,CAAA,CAAG,OAAA,CAASC,CAAAA,EAAkB,CACzD,IAAMC,CAAAA,CAAYb,CAAAA,CAAS,GAAA,CAAIY,CAAa,CAAA,CAAK,CAAA,CACjDZ,CAAAA,CAAS,GAAA,CAAIY,CAAAA,CAAeC,CAAS,CAAA,CAEjCA,CAAAA,GAAc,CAAA,EAChBL,CAAAA,CAAM,IAAA,CAAKI,CAAa,EAE5B,CAAC,EACH,CAEA,GAAIH,CAAAA,CAAO,MAAA,GAAW5J,CAAAA,CAAM,OAAQ,CAClC,OAAA,CAAQ,IAAA,CAAK,gDAAgD,CAAA,CAG7D,IAAMiK,CAAAA,CAAe,IAAI,IACvBL,CAAAA,CAAO,GAAA,CAAKhhB,CAAAA,EAAS,CACnB,IAAMif,CAAAA,CAASD,CAAAA,CAAU,GAAA,CAAIhf,CAAI,CAAA,EAAKA,CAAAA,CAAK,IAAA,CAC3C,OAAO+f,CAAAA,CAAgB/f,CAAAA,CAAMif,CAAM,CACrC,CAAC,CACH,CAAA,CAEA7H,CAAAA,CAAM,OAAA,CAASpX,CAAAA,EAAS,CACtB,IAAMif,CAAAA,CAASD,EAAU,GAAA,CAAIhf,CAAI,CAAA,EAAKA,CAAAA,CAAK,IAAA,CACrCigB,CAAAA,CAAOF,CAAAA,CAAgB/f,CAAAA,CAAMif,CAAM,CAAA,CACpCoC,CAAAA,CAAa,GAAA,CAAIpB,CAAI,CAAA,EACxBe,CAAAA,CAAO,IAAA,CAAKhhB,CAAI,EAEpB,CAAC,EACH,CAEA,OAAOghB,CACT,CCjuBO,SAASM,EAAAA,CAAY7e,CAAAA,CAAgB,CAgC1C,GA/BAiG,CAAAA,CAAO,KAAA,GACPA,CAAAA,CAAO,KAAA,CACL,sEACF,CAAA,CACAA,CAAAA,CAAO,KAAA,CAAM,0DAA0D,CAAA,CACvEA,EAAO,KAAA,CAAM,EAAE,CAAA,CACX,OAAOjG,CAAAA,EAAU,QAAA,GACnBiG,CAAAA,CAAO,KAAA,CAAMjG,CAAK,CAAA,CAClBiG,CAAAA,CAAO,KAAA,EAAM,CACb,OAAA,CAAQ,IAAA,CAAK,CAAC,CAAA,CAAA,CAGZjG,aAAiB3D,CAAAA,GACf2D,CAAAA,CAAM,OAAA,GACRiG,CAAAA,CAAO,KAAA,CAAMjG,CAAAA,CAAM,KAAA,CAAQ,QAAA,CAAW,UAAU,CAAA,CAChDiG,CAAAA,CAAO,KAAA,CAAMjG,CAAAA,CAAM,OAAO,CAAA,CAAA,CAGxBA,CAAAA,CAAM,KAAA,GACRiG,EAAO,KAAA,CAAM;AAAA,QAAA,CAAY,CAAA,CACzBA,EAAO,KAAA,CAAMjG,CAAAA,CAAM,KAAK,CAAA,CAAA,CAGtBA,CAAAA,CAAM,UAAA,GACRiG,CAAAA,CAAO,KAAA,CAAM;AAAA,WAAA,CAAe,EAC5BA,CAAAA,CAAO,KAAA,CAAMjG,EAAM,UAAU,CAAA,CAAA,CAE/BiG,EAAO,KAAA,EAAM,CACb,QAAQ,IAAA,CAAK,CAAC,GAGZjG,CAAAA,YAAiBvC,CAAAA,CAAE,SAAU,CAC/BwI,CAAAA,CAAO,MAAM,oBAAoB,CAAA,CACjC,OAAW,CAAClK,CAAAA,CAAKF,CAAK,CAAA,GAAK,MAAA,CAAO,QAAQmE,CAAAA,CAAM,OAAA,GAAU,WAAW,CAAA,CACnEiG,EAAO,KAAA,CAAM,CAAA,EAAA,EAAKzH,EAAY,IAAA,CAAKzC,CAAG,CAAC,CAAA,EAAA,EAAKF,CAAK,EAAE,CAAA,CAErDoK,CAAAA,CAAO,OAAM,CACb,OAAA,CAAQ,KAAK,CAAC,EAChB,CAEIjG,CAAAA,YAAiB,KAAA,GACnBiG,EAAO,KAAA,CAAMjG,CAAAA,CAAM,OAAO,CAAA,CAC1BiG,CAAAA,CAAO,OAAM,CACb,OAAA,CAAQ,KAAK,CAAC,CAAA,CAAA,CAGhBA,EAAO,KAAA,EAAM,CACb,QAAQ,IAAA,CAAK,CAAC,EAChB,CCZA,eAAsB6Y,EAAAA,CACpB/gB,CAAAA,CACAxB,EAIA,CACA,GAAM,CAAE,MAAA,CAAAwC,CAAAA,CAAQ,SAAAggB,CAAS,CAAA,CAAIxiB,GAAW,EAAC,CAEzC,GAAI8W,CAAAA,CAAMtV,CAAI,EAAG,CACf,GAAM,CAACyC,CAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc,CAACxY,CAAI,CAAA,CAAG,CAAE,SAAAghB,CAAS,CAAC,EACzD,GAAI,CACF,OAAOC,CAAAA,CAAe,KAAA,CAAMxe,CAAM,CACpC,CAAA,MAASR,EAAO,CACd,MAAM,IAAI1C,CAAAA,CAAmBS,CAAAA,CAAMiC,CAAK,CAC1C,CACF,CAEA,GAAI,CAACjC,EAAK,UAAA,CAAW,GAAG,EACtB,MAAM,IAAID,GAA8BC,CAAI,CAAA,CAG9C,IAAIZ,CAAAA,CAAeY,CAAAA,CACdZ,EAAa,QAAA,CAAS,WAAW,IACpCA,CAAAA,CAAe,CAAA,EAAGA,CAAY,CAAA,SAAA,CAAA,CAAA,CAGhC,IAAM8hB,EAAgBrK,EAAAA,CACpBzX,CAAAA,CACA4W,GAAmBhV,CAAM,CAC3B,EAEA,GAAI,CAACkgB,GAAe,GAAA,CAClB,MAAM,IAAIziB,CAAAA,CAAsBW,CAAY,EAG1C8hB,CAAAA,CAAc,OAAA,EAAW,OAAO,IAAA,CAAKA,CAAAA,CAAc,OAAO,CAAA,CAAE,MAAA,CAAS,GACvE9K,EAAAA,CAAmB,CACjB,CAAC8K,CAAAA,CAAc,GAAG,EAAGA,CAAAA,CAAc,OACrC,CAAC,CAAA,CAGH,GAAM,CAACze,GAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc,CAAC0I,EAAc,GAAG,CAAA,CAAG,CAAE,QAAA,CAAAF,CAAS,CAAC,CAAA,CAEtE,GAAI,CACF,OAAOC,CAAAA,CAAe,MAAMxe,GAAM,CACpC,OAASR,CAAAA,CAAO,CACd,MAAM,IAAI1C,CAAAA,CAAmBH,EAAc6C,CAAK,CAClD,CACF,CAEA,eAAsBkf,GACpBvK,CAAAA,CACApY,CAAAA,CAIA,CACA,GAAM,CAAE,OAAAwC,CAAAA,CAAQ,QAAA,CAAAggB,EAAW,KAAM,CAAA,CAAIxiB,GAAW,EAAC,CAEjD,OAAA+X,EAAAA,EAAqB,CAEdoG,GAAmB/F,CAAAA,CAAOZ,EAAAA,CAAmBhV,CAAM,CAAA,CAAG,CAAE,SAAAggB,CAAS,CAAC,CAC3E,CAEA,eAAsBI,GACpBxK,CAAAA,CACApY,CAAAA,CAIA,CACA,GAAM,CAAE,OAAAwC,CAAAA,CAAQ,QAAA,CAAAggB,EAAW,KAAM,CAAA,CAAIxiB,GAAW,EAAC,CAEjD,OAAA+X,EAAAA,EAAqB,CACdwG,GAAoBnG,CAAAA,CAAOZ,EAAAA,CAAmBhV,CAAM,CAAA,CAAG,CAAE,SAAAggB,CAAS,CAAC,CAC5E,CAEA,eAAsBK,GACpBnhB,CAAAA,CACA1B,CAAAA,CACA,CACA,GAAM,CAAE,SAAAwiB,CAAAA,CAAW,IAAK,EAAIxiB,CAAAA,EAAW,GAGlCwiB,CAAAA,EACH1f,EAAAA,CAAS,aAAY,CAGvB,IAAMS,EAAe,MAAMT,EAAAA,CAAS,OAAOpB,CAAG,CAAA,CAE9C,GAAI,CAAC6B,CAAAA,CAGH,OAAO,CACL,UAAA,CAAYpE,CACd,CAAA,CAIF,IAAM2jB,EAAmB5hB,CAAAA,CACtB,MAAA,CAAO,CACN,UAAA,CAAY6hB,GAAAA,CAAqB,UACnC,CAAC,EACA,SAAA,CAAUxf,CAAAA,CAAa,MAAM,CAAA,CAEhC,GAAI,CAACuf,CAAAA,CAAiB,OAAA,CACpB,MAAM,IAAIrhB,EAAAA,CAAiBC,EAAKohB,CAAAA,CAAiB,KAAK,EAIxD,OAAO,CACL,WAAY,CACV,GAAG3jB,EACH,GAAI2jB,CAAAA,CAAiB,KAAK,UAAA,EAAc,EAC1C,CACF,CACF,CAEA,eAAsBrD,EAAAA,EAAyB,CAC7C,GAAI,CACF,GAAM,CAACxb,CAAM,EAAI,MAAM+V,CAAAA,CAAc,CAAC,YAAY,CAAC,EAEnD,OAAOgJ,CAAAA,CAAoB,MAAM/e,CAAM,CACzC,OAASR,CAAAA,CAAO,CACdiG,EAAO,KAAA,CAAM;AAAA,CAAI,CAAA,CACjB4Y,EAAAA,CAAY7e,CAAK,EACnB,CACF,CAEA,eAAsBwf,EAAAA,EAAoB,CACxC,GAAI,CACF,GAAM,CAAChf,CAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc,CAAC,mBAAmB,CAAC,CAAA,CAE1D,OAAOkJ,GAAAA,CAAa,KAAA,CAAMjf,CAAM,CAClC,CAAA,MAASR,CAAAA,CAAO,CACd,OAAAiG,EAAO,KAAA,CAAM;AAAA,CAAI,EACjB4Y,EAAAA,CAAY7e,CAAK,EACV,EACT,CACF,CAEA,eAAsB0f,IAAmB,CACvC,GAAI,CACF,GAAM,CAAClf,CAAM,CAAA,CAAI,MAAM+V,EAAc,CAAC,kBAAkB,CAAC,CAAA,CACzD,OAAOoJ,CAAAA,CAAY,KAAA,CAAMnf,CAAM,CACjC,CAAA,MAASR,EAAO,CACd,OAAA6e,GAAY7e,CAAK,CAAA,CACV,EACT,CACF,CAEA,eAAsB4f,EAAAA,EAAwB,CAC5C,OAAOnkB,EACT,CAEA,eAAsBkR,GAAqBD,CAAAA,CAAmB,CAC5D,GAAI,CACF,GAAM,CAAClM,CAAM,CAAA,CAAI,MAAM+V,CAAAA,CAAc,CAAC,UAAU7J,CAAS,CAAA,KAAA,CAAO,CAAC,CAAA,CAEjE,OAAOmT,EAAwB,KAAA,CAAMrf,CAAM,CAC7C,CAAA,MAASR,EAAO,CACd6e,EAAAA,CAAY7e,CAAK,EACnB,CACF,CAKA,eAAsB8f,EAAAA,CACpB7S,EACA8N,CAAAA,CACA,CACA,IAAMgF,CAAAA,CAA4C,GAElD,IAAA,IAAWhiB,CAAAA,IAAQgd,EAAO,CACxB,IAAMiF,CAAAA,CAAQ/S,CAAAA,CAAM,KAAM+S,CAAAA,EAAUA,CAAAA,CAAM,OAASjiB,CAAI,CAAA,CAEvD,GAAKiiB,CAAAA,GAILD,CAAAA,CAAK,KAAKC,CAAK,CAAA,CAEXA,EAAM,oBAAA,CAAA,CAAsB,CAC9B,IAAMvN,CAAAA,CAAe,MAAMqN,GAAY7S,CAAAA,CAAO+S,CAAAA,CAAM,oBAAoB,CAAA,CACxED,EAAK,IAAA,CAAK,GAAGtN,CAAY,EAC3B,CACF,CAEA,OAAOsN,CAAAA,CAAK,OACV,CAACE,CAAAA,CAAWhT,EAAOiT,CAAAA,GACjBA,CAAAA,CAAK,UAAWvU,CAAAA,EAAMA,CAAAA,CAAE,OAASsU,CAAAA,CAAU,IAAI,CAAA,GAAMhT,CACzD,CACF,CAKA,eAAsBkT,GACpB/C,CAAAA,CACA2C,CAAAA,CACA,CACA,GAAI,CACF,IAAMrc,CAAAA,CAAQqc,CAAAA,CAAK,IAAKxiB,CAAAA,EAAS,CAAA,OAAA,EAAU6f,CAAK,CAAA,CAAA,EAAI7f,CAAAA,CAAK,IAAI,CAAA,KAAA,CAAO,CAAA,CAEpE,OAAA,CADgB,MAAMgZ,EAAc7S,CAAK,CAAA,EAC1B,IAAKlD,GAAAA,EAAWyW,CAAAA,CAAmB,MAAMzW,GAAM,CAAC,CACjE,CAAA,MAASR,CAAAA,CAAO,CACd,OAAA6e,EAAAA,CAAY7e,CAAK,CAAA,CACV,EACT,CACF,CAKA,eAAsBogB,EAAAA,CACpBrhB,EACAxB,CAAAA,CACA8iB,CAAAA,CACA,CACA,GAAIA,CAAAA,CACF,OAAOA,CAAAA,CAGT,GAAI9iB,EAAK,IAAA,GAAS,aAAA,CAChB,OAAOwB,CAAAA,CAAO,aAAA,CAAc,IAAMA,CAAAA,CAAO,aAAA,CAAc,WAGzD,GAAM,CAACuhB,CAAAA,CAAQzd,CAAI,EAAItF,CAAAA,CAAK,IAAA,EAAM,MAAM,GAAG,CAAA,EAAK,EAAC,CACjD,OAAM+iB,KAAUvhB,CAAAA,CAAO,aAAA,CAIhBc,WAAK,IAAA,CACVd,CAAAA,CAAO,cAAcuhB,CAA2C,CAAA,CAChEzd,CACF,CAAA,CANS,IAOX,CAGA,eAAsB0d,GAAchkB,CAAAA,CAAkC,CACpEA,EAAU,CACR,QAAA,CAAU,KACV,GAAGA,CACL,EAEA,IAAME,CAAAA,CAAM,GAAGlB,EAAY,CAAA,gBAAA,CAAA,CACrB,CAACilB,CAAI,CAAA,CAAI,MAAMjK,CAAAA,CAAc,CAAC9Z,CAAG,CAAA,CAAG,CACxC,QAAA,CAAUF,CAAAA,CAAQ,QACpB,CAAC,CAAA,CAED,GAAI,CACF,OAAOkkB,EAAiB,KAAA,CAAMD,CAAI,CACpC,CAAA,MAASxgB,CAAAA,CAAO,CACd,MAAIA,CAAAA,YAAiBvC,EAAE,QAAA,CACf,IAAIS,EAAAA,CAA0B8B,CAAK,EAGrCA,CACR,CACF,CAKA,eAAsB0gB,EAAAA,CAAmBnkB,EAAkC,CAEzE,IAAMokB,EAAa,MAAMJ,EAAAA,CAAchkB,CAAO,CAAA,CAC9C,OAAKokB,EACE,MAAA,CAAO,WAAA,CAAYA,EAAW,GAAA,CAAK,CAAA,EAAM,CAAC,CAAA,CAAE,KAAM,CAAA,CAAE,GAAG,CAAC,CAAC,CAAA,CADxC,IAI1B,CAEA,eAAsBC,GAAWrkB,CAAAA,CAAkC,CACjEA,EAAU,CACR,QAAA,CAAU,KACV,GAAGA,CACL,EAEA,IAAME,CAAAA,CAAM,CAAA,EAAGlB,EAAY,eACrB,CAACilB,CAAI,EAAI,MAAMjK,CAAAA,CAAc,CAAC9Z,CAAG,CAAA,CAAG,CACxC,QAAA,CAAUF,CAAAA,CAAQ,QACpB,CAAC,CAAA,CAGD,OADeskB,GAAAA,CAAiB,KAAA,CAAML,CAAI,CAAA,CAC5B,OAChB,CAEA,eAAsBM,EAAAA,CACpB/iB,EACAxB,CAAAA,CACA,CAEA,QADgB,MAAMqkB,EAAAA,CAAWrkB,CAAO,CAAA,EAE9B,IAAA,CACLwkB,GAAWA,CAAAA,CAAO,IAAA,CAAK,aAAY,GAAMhjB,CAAAA,CAAK,aACjD,CAAA,EAAK,IAET,CC/UA,eAAsBijB,EAAAA,CACpBL,EACApkB,CAAAA,CAOA,CACA,GAAM,CAAE,KAAA,CAAA0kB,EAAO,KAAA,CAAAC,CAAAA,CAAO,OAAAC,CAAAA,CAAQ,MAAA,CAAApiB,EAAQ,QAAA,CAAAggB,CAAS,CAAA,CAAIxiB,CAAAA,EAAW,EAAC,CAE3D6kB,CAAAA,CAAqD,EAAC,CAE1D,IAAA,IAAWjM,KAAYwL,CAAAA,CAAY,CAGjC,IAAMU,CAAAA,CAAAA,CAAAA,CAFe,MAAMvC,GAAY3J,CAAAA,CAAU,CAAE,OAAApW,CAAAA,CAAQ,QAAA,CAAAggB,CAAS,CAAC,CAAA,EAE7B,KAAA,EAAS,IAAI,GAAA,CAAKxhB,CAAAA,GAAU,CAClE,IAAA,CAAMA,CAAAA,CAAK,KACX,IAAA,CAAMA,CAAAA,CAAK,KACX,WAAA,CAAaA,CAAAA,CAAK,YAClB,QAAA,CAAU4X,CAAAA,CACV,mBAAoBmM,EAAAA,CAClB/jB,CAAAA,CAAK,KACL4X,CACF,CACF,CAAA,CAAE,CAAA,CAEFiM,EAAWA,CAAAA,CAAS,MAAA,CAAOC,CAAiB,EAC9C,CAEIJ,IACFG,CAAAA,CAAWG,EAAAA,CAAYH,EAAU,CAC/B,KAAA,CAAAH,EACA,KAAA,CAAOG,CAAAA,CAAS,OAChB,IAAA,CAAM,CAAC,OAAQ,aAAa,CAC9B,CAAC,CAAA,CAAA,CAGH,IAAMI,CAAAA,CAAmBL,CAAAA,EAAU,EAC7BM,CAAAA,CAAkBP,CAAAA,EAASE,EAAS,MAAA,CACpCM,CAAAA,CAAaN,EAAS,MAAA,CAEtB5gB,CAAAA,CAA8C,CAClD,UAAA,CAAY,CACV,MAAOkhB,CAAAA,CACP,MAAA,CAAQF,EACR,KAAA,CAAOC,CAAAA,CACP,OAAA,CAASD,CAAAA,CAAmBC,EAAkBC,CAChD,CAAA,CACA,MAAON,CAAAA,CAAS,KAAA,CAAMI,EAAkBA,CAAAA,CAAmBC,CAAe,CAC5E,CAAA,CAEA,OAAOE,EAAoB,KAAA,CAAMnhB,CAAM,CACzC,CAEA,IAAMohB,GAAuBnkB,CAAAA,CAC1B,MAAA,CAAO,CACN,IAAA,CAAMA,EAAE,MAAA,EAAO,CACf,KAAMA,CAAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAC1B,YAAaA,CAAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CACjC,SAAUA,CAAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAC9B,mBAAoBA,CAAAA,CAAE,MAAA,GAAS,QAAA,EACjC,CAAC,CAAA,CACA,WAAA,GAIH,SAAS8jB,EAAAA,CASP5M,EACApY,CAAAA,CAGA,CACAA,EAAU,CACR,KAAA,CAAO,IACP,SAAA,CAAW,IAAA,CACX,GAAGA,CACL,CAAA,CAQA,IAAM6e,CAAAA,CANgByG,GAAU,EAAA,CAAGtlB,CAAAA,CAAQ,MAAOoY,CAAAA,CAAO,CACvD,KAAMpY,CAAAA,CAAQ,IAAA,CACd,UAAWA,CAAAA,CAAQ,SAAA,CACnB,MAAOA,CAAAA,CAAQ,KACjB,CAAC,CAAA,CAE6B,GAAA,CAAKiE,GAAWA,CAAAA,CAAO,GAAG,CAAA,CAExD,OAAO/C,EAAE,KAAA,CAAMmkB,EAAoB,EAAE,KAAA,CAAMxG,CAAO,CACpD,CAEA,SAAS/H,GAAMyO,CAAAA,CAAyB,CACtC,GAAI,CACF,OAAA,IAAI,IAAIA,CAAM,CAAA,CACP,EACT,CAAA,KAAQ,CACN,OAAO,MACT,CACF,CAKO,SAASR,GACdvjB,CAAAA,CACAoX,CAAAA,CACA,CAEA,GAAI,CAAC9B,GAAM8B,CAAQ,CAAA,CACjB,OAAO,CAAA,EAAGA,CAAQ,IAAIpX,CAAI,CAAA,CAAA,CAI5B,IAAMgkB,CAAAA,CAAc5M,CAAAA,CAAS,OAAA,CAAQ,KAAK,EAAI,CAAA,CACxC6M,CAAAA,CAAU7M,EAAS,OAAA,CAAQ,GAAA,CAAK4M,CAAW,CAAA,CAEjD,GAAIC,IAAY,EAAA,CAAI,CAElB,IAAMC,CAAAA,CAAa9M,CAAAA,CAAS,QAAQ,GAAA,CAAK4M,CAAW,EACpD,GAAIE,CAAAA,GAAe,EAAA,CAAI,CAErB,IAAMC,CAAAA,CAAc/M,CAAAA,CAAS,UAAU,CAAA,CAAG8M,CAAU,EAG9CE,CAAAA,CAFgBhN,CAAAA,CAAS,UAAU8M,CAAU,CAAA,CAEhB,QAAQ,eAAA,CAAiBlkB,CAAI,EAChE,OAAOmkB,CAAAA,CAAcC,CACvB,CAEA,OAAOhN,CACT,CAGA,IAAMiN,CAAAA,CAAWjN,CAAAA,CAAS,UAAU,CAAA,CAAG6M,CAAO,EACxCK,CAAAA,CAAelN,CAAAA,CAAS,UAAU6M,CAAO,CAAA,CAIzCM,EACJD,CAAAA,CAAa,OAAA,CAAQ,GAAG,CAAA,GAAM,EAAA,CAC1BA,EAAa,OAAA,CAAQ,GAAG,CAAA,CACxBA,CAAAA,CAAa,OACbE,CAAAA,CAAWF,CAAAA,CAAa,UAAU,CAAA,CAAGC,CAAO,EAC5CE,CAAAA,CAAgBH,CAAAA,CAAa,UAAUC,CAAO,CAAA,CAG9CG,EAAYF,CAAAA,CAAS,WAAA,CAAY,UAAU,CAAA,CAC7CG,CAAAA,CAAcH,EACdE,CAAAA,GAAc,EAAA,GAChBC,EACEH,CAAAA,CAAS,SAAA,CAAU,EAAGE,CAAS,CAAA,CAC/B1kB,EACAwkB,CAAAA,CAAS,SAAA,CAAUE,EAAY,CAAiB,CAAA,CAAA,CAIpD,IAAMN,CAAAA,CAAeK,CAAAA,CAAc,QAAQ,eAAA,CAAiBzkB,CAAI,EAEhE,OAAOqkB,CAAAA,CAAWM,EAAcP,CAClC","file":"chunk-ZW7RMHBI.js","sourcesContent":["import { registryConfigSchema } from \"@/src/schema\"\nimport { z } from \"zod\"\n\nexport const REGISTRY_URL =\n  process.env.REGISTRY_URL ?? \"https://ui.shadcn.com/r\"\n\nexport const FALLBACK_STYLE = \"new-york-v4\"\n\nexport const BASE_COLORS = [\n  {\n    name: \"neutral\",\n    label: \"Neutral\",\n  },\n  {\n    name: \"gray\",\n    label: \"Gray\",\n  },\n  {\n    name: \"zinc\",\n    label: \"Zinc\",\n  },\n  {\n    name: \"stone\",\n    label: \"Stone\",\n  },\n  {\n    name: \"slate\",\n    label: \"Slate\",\n  },\n] as const\n\n// Built-in registries that are always available and cannot be overridden\nexport const BUILTIN_REGISTRIES: z.infer<typeof registryConfigSchema> = {\n  \"@shadcn\": `${REGISTRY_URL}/styles/{style}/{name}.json`,\n}\n\nexport const BUILTIN_MODULES = new Set([\n  [\n    // Node.js built-in modules\n    // From https://github.com/sindresorhus/builtin-modules.\n    \"node:assert\",\n    \"assert\",\n    \"node:assert/strict\",\n    \"assert/strict\",\n    \"node:async_hooks\",\n    \"async_hooks\",\n    \"node:buffer\",\n    \"buffer\",\n    \"node:child_process\",\n    \"child_process\",\n    \"node:cluster\",\n    \"cluster\",\n    \"node:console\",\n    \"console\",\n    \"node:constants\",\n    \"constants\",\n    \"node:crypto\",\n    \"crypto\",\n    \"node:dgram\",\n    \"dgram\",\n    \"node:diagnostics_channel\",\n    \"diagnostics_channel\",\n    \"node:dns\",\n    \"dns\",\n    \"node:dns/promises\",\n    \"dns/promises\",\n    \"node:domain\",\n    \"domain\",\n    \"node:events\",\n    \"events\",\n    \"node:fs\",\n    \"fs\",\n    \"node:fs/promises\",\n    \"fs/promises\",\n    \"node:http\",\n    \"http\",\n    \"node:http2\",\n    \"http2\",\n    \"node:https\",\n    \"https\",\n    \"node:inspector\",\n    \"inspector\",\n    \"node:inspector/promises\",\n    \"inspector/promises\",\n    \"node:module\",\n    \"module\",\n    \"node:net\",\n    \"net\",\n    \"node:os\",\n    \"os\",\n    \"node:path\",\n    \"path\",\n    \"node:path/posix\",\n    \"path/posix\",\n    \"node:path/win32\",\n    \"path/win32\",\n    \"node:perf_hooks\",\n    \"perf_hooks\",\n    \"node:process\",\n    \"process\",\n    \"node:querystring\",\n    \"querystring\",\n    \"node:quic\",\n    \"node:readline\",\n    \"readline\",\n    \"node:readline/promises\",\n    \"readline/promises\",\n    \"node:repl\",\n    \"repl\",\n    \"node:sea\",\n    \"node:sqlite\",\n    \"node:stream\",\n    \"stream\",\n    \"node:stream/consumers\",\n    \"stream/consumers\",\n    \"node:stream/promises\",\n    \"stream/promises\",\n    \"node:stream/web\",\n    \"stream/web\",\n    \"node:string_decoder\",\n    \"string_decoder\",\n    \"node:test\",\n    \"node:test/reporters\",\n    \"node:timers\",\n    \"timers\",\n    \"node:timers/promises\",\n    \"timers/promises\",\n    \"node:tls\",\n    \"tls\",\n    \"node:trace_events\",\n    \"trace_events\",\n    \"node:tty\",\n    \"tty\",\n    \"node:url\",\n    \"url\",\n    \"node:util\",\n    \"util\",\n    \"node:util/types\",\n    \"util/types\",\n    \"node:v8\",\n    \"v8\",\n    \"node:vm\",\n    \"vm\",\n    \"node:wasi\",\n    \"wasi\",\n    \"node:worker_threads\",\n    \"worker_threads\",\n    \"node:zlib\",\n    \"zlib\",\n\n    // Bun built-in modules.\n    \"bun\",\n    \"bun:test\",\n    \"bun:sqlite\",\n    \"bun:ffi\",\n    \"bun:jsc\",\n    \"bun:internal\",\n  ],\n])\n\nexport const DEPRECATED_COMPONENTS = [\n  {\n    name: \"toast\",\n    deprecatedBy: \"sonner\",\n    message:\n      \"The toast component is deprecated. Use the sonner component instead.\",\n  },\n  {\n    name: \"toaster\",\n    deprecatedBy: \"sonner\",\n    message:\n      \"The toaster component is deprecated. Use the sonner component instead.\",\n  },\n]\n","export function expandEnvVars(value: string) {\n  return value.replace(/\\${(\\w+)}/g, (_match, key) => process.env[key] || \"\")\n}\n\nexport function extractEnvVars(value: string) {\n  const vars: string[] = []\n  const regex = /\\${(\\w+)}/g\n  let match: RegExpExecArray | null\n\n  while ((match = regex.exec(value)) !== null) {\n    vars.push(match[1])\n  }\n\n  return vars\n}\n","import { z } from \"zod\"\n\n// Error codes for programmatic error handling\nexport const RegistryErrorCode = {\n  // Network errors\n  NETWORK_ERROR: \"NETWORK_ERROR\",\n  NOT_FOUND: \"NOT_FOUND\",\n  UNAUTHORIZED: \"UNAUTHORIZED\",\n  FORBIDDEN: \"FORBIDDEN\",\n  FETCH_ERROR: \"FETCH_ERROR\",\n\n  // Configuration errors\n  NOT_CONFIGURED: \"NOT_CONFIGURED\",\n  INVALID_CONFIG: \"INVALID_CONFIG\",\n  MISSING_ENV_VARS: \"MISSING_ENV_VARS\",\n\n  // File system errors\n  LOCAL_FILE_ERROR: \"LOCAL_FILE_ERROR\",\n\n  // Parsing errors\n  PARSE_ERROR: \"PARSE_ERROR\",\n  VALIDATION_ERROR: \"VALIDATION_ERROR\",\n\n  // Generic errors\n  UNKNOWN_ERROR: \"UNKNOWN_ERROR\",\n} as const\n\nexport type RegistryErrorCode =\n  (typeof RegistryErrorCode)[keyof typeof RegistryErrorCode]\n\nexport class RegistryError extends Error {\n  public readonly code: RegistryErrorCode\n  public readonly statusCode?: number\n  public readonly context?: Record<string, unknown>\n  public readonly suggestion?: string\n  public readonly timestamp: Date\n  public readonly cause?: unknown\n\n  constructor(\n    message: string,\n    options: {\n      code?: RegistryErrorCode\n      statusCode?: number\n      cause?: unknown\n      context?: Record<string, unknown>\n      suggestion?: string\n    } = {}\n  ) {\n    super(message)\n    this.name = \"RegistryError\"\n    this.code = options.code || RegistryErrorCode.UNKNOWN_ERROR\n    this.statusCode = options.statusCode\n    this.cause = options.cause\n    this.context = options.context\n    this.suggestion = options.suggestion\n    this.timestamp = new Date()\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, this.constructor)\n    }\n  }\n\n  toJSON() {\n    return {\n      name: this.name,\n      message: this.message,\n      code: this.code,\n      statusCode: this.statusCode,\n      context: this.context,\n      suggestion: this.suggestion,\n      timestamp: this.timestamp,\n      stack: this.stack,\n    }\n  }\n}\n\nexport class RegistryNotFoundError extends RegistryError {\n  constructor(public readonly url: string, cause?: unknown) {\n    const message = `The item at ${url} was not found. It may not exist at the registry.`\n\n    super(message, {\n      code: RegistryErrorCode.NOT_FOUND,\n      statusCode: 404,\n      cause,\n      context: { url },\n      suggestion:\n        \"Check if the item name is correct and the registry URL is accessible.\",\n    })\n    this.name = \"RegistryNotFoundError\"\n  }\n}\n\nexport class RegistryUnauthorizedError extends RegistryError {\n  constructor(public readonly url: string, cause?: unknown) {\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\n\n    super(message, {\n      code: RegistryErrorCode.UNAUTHORIZED,\n      statusCode: 401,\n      cause,\n      context: { url },\n      suggestion:\n        \"Check your authentication credentials and environment variables.\",\n    })\n    this.name = \"RegistryUnauthorizedError\"\n  }\n}\n\nexport class RegistryForbiddenError extends RegistryError {\n  constructor(public readonly url: string, cause?: unknown) {\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\n\n    super(message, {\n      code: RegistryErrorCode.FORBIDDEN,\n      statusCode: 403,\n      cause,\n      context: { url },\n      suggestion:\n        \"Check your authentication credentials and environment variables.\",\n    })\n    this.name = \"RegistryForbiddenError\"\n  }\n}\n\nexport class RegistryFetchError extends RegistryError {\n  constructor(\n    public readonly url: string,\n    statusCode?: number,\n    public readonly responseBody?: string,\n    cause?: unknown\n  ) {\n    // Use the error detail from the server if available\n    const baseMessage = statusCode\n      ? `Failed to fetch from registry (${statusCode}): ${url}`\n      : `Failed to fetch from registry: ${url}`\n\n    const message =\n      typeof cause === \"string\" && cause\n        ? `${baseMessage} - ${cause}`\n        : baseMessage\n\n    let suggestion = \"Check your network connection and try again.\"\n    if (statusCode === 404) {\n      suggestion =\n        \"The requested resource was not found. Check the URL or item name.\"\n    } else if (statusCode === 500) {\n      suggestion = \"The registry server encountered an error. Try again later.\"\n    } else if (statusCode && statusCode >= 400 && statusCode < 500) {\n      suggestion = \"There was a client error. Check your request parameters.\"\n    }\n\n    super(message, {\n      code: RegistryErrorCode.FETCH_ERROR,\n      statusCode,\n      cause,\n      context: { url, responseBody },\n      suggestion,\n    })\n    this.name = \"RegistryFetchError\"\n  }\n}\n\nexport class RegistryNotConfiguredError extends RegistryError {\n  constructor(public readonly registryName: string | null) {\n    const message = registryName\n      ? `Unknown registry \"${registryName}\". Make sure it is defined in components.json as follows:\n{\n  \"registries\": {\n    \"${registryName}\": \"[URL_TO_REGISTRY]\"\n  }\n}`\n      : `Unknown registry. Make sure it is defined in components.json under \"registries\".`\n\n    super(message, {\n      code: RegistryErrorCode.NOT_CONFIGURED,\n      context: { registryName },\n      suggestion:\n        \"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format.\",\n    })\n    this.name = \"RegistryNotConfiguredError\"\n  }\n}\n\nexport class RegistryLocalFileError extends RegistryError {\n  constructor(public readonly filePath: string, cause?: unknown) {\n    super(`Failed to read local registry file: ${filePath}`, {\n      code: RegistryErrorCode.LOCAL_FILE_ERROR,\n      cause,\n      context: { filePath },\n      suggestion: \"Check if the file exists and you have read permissions.\",\n    })\n    this.name = \"RegistryLocalFileError\"\n  }\n}\n\nexport class RegistryParseError extends RegistryError {\n  public readonly parseError: unknown\n\n  constructor(public readonly item: string, parseError: unknown) {\n    let message = `Failed to parse registry item: ${item}`\n\n    if (parseError instanceof z.ZodError) {\n      message = `Failed to parse registry item: ${item}\\n${parseError.errors\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\n        .join(\"\\n\")}`\n    }\n\n    super(message, {\n      code: RegistryErrorCode.PARSE_ERROR,\n      cause: parseError,\n      context: { item },\n      suggestion:\n        \"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.shadcn.com/schema/registry-item.json.\",\n    })\n\n    this.parseError = parseError\n    this.name = \"RegistryParseError\"\n  }\n}\n\nexport class RegistryMissingEnvironmentVariablesError extends RegistryError {\n  constructor(\n    public readonly registryName: string,\n    public readonly missingVars: string[]\n  ) {\n    const message =\n      `Registry \"${registryName}\" requires the following environment variables:\\n\\n` +\n      missingVars.map((v) => `   ${v}`).join(\"\\n\")\n\n    super(message, {\n      code: RegistryErrorCode.MISSING_ENV_VARS,\n      context: { registryName, missingVars },\n      suggestion:\n        \"Set the required environment variables to your .env or .env.local file.\",\n    })\n    this.name = \"RegistryMissingEnvironmentVariablesError\"\n  }\n}\n\nexport class RegistryInvalidNamespaceError extends RegistryError {\n  constructor(public readonly name: string) {\n    const message = `Invalid registry namespace: \"${name}\". Registry names must start with @ (e.g., @shadcn, @v0).`\n\n    super(message, {\n      code: RegistryErrorCode.VALIDATION_ERROR,\n      context: { name },\n      suggestion:\n        \"Use a valid registry name starting with @ or provide a direct URL to the registry.\",\n    })\n    this.name = \"RegistryInvalidNamespaceError\"\n  }\n}\n\nexport class ConfigMissingError extends RegistryError {\n  constructor(public readonly cwd: string) {\n    const message = `No components.json found in ${cwd} or parent directories.`\n\n    super(message, {\n      code: RegistryErrorCode.NOT_CONFIGURED,\n      context: { cwd },\n      suggestion:\n        \"Run 'npx shadcn@latest init' to create a components.json file, or check that you're in the correct directory.\",\n    })\n    this.name = \"ConfigMissingError\"\n  }\n}\n\nexport class ConfigParseError extends RegistryError {\n  constructor(public readonly cwd: string, parseError: unknown) {\n    let message = `Invalid components.json configuration in ${cwd}.`\n\n    if (parseError instanceof z.ZodError) {\n      message = `Invalid components.json configuration in ${cwd}:\\n${parseError.errors\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\n        .join(\"\\n\")}`\n    }\n\n    super(message, {\n      code: RegistryErrorCode.INVALID_CONFIG,\n      cause: parseError,\n      context: { cwd },\n      suggestion:\n        \"Check your components.json file for syntax errors or invalid configuration. Run 'npx shadcn@latest init' to regenerate a valid configuration.\",\n    })\n    this.name = \"ConfigParseError\"\n  }\n}\n\nexport class RegistriesIndexParseError extends RegistryError {\n  public readonly parseError: unknown\n\n  constructor(parseError: unknown) {\n    let message = \"Failed to parse registries index\"\n\n    if (parseError instanceof z.ZodError) {\n      const invalidNamespaces = parseError.errors\n        .filter((e) => e.path.length > 0)\n        .map((e) => `\"${e.path[0]}\"`)\n        .filter((v, i, arr) => arr.indexOf(v) === i) // remove duplicates\n\n      if (invalidNamespaces.length > 0) {\n        message = `Failed to parse registries index. Invalid registry namespace(s): ${invalidNamespaces.join(\n          \", \"\n        )}\\n${parseError.errors\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\n          .join(\"\\n\")}`\n      } else {\n        message = `Failed to parse registries index:\\n${parseError.errors\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\n          .join(\"\\n\")}`\n      }\n    }\n\n    super(message, {\n      code: RegistryErrorCode.PARSE_ERROR,\n      cause: parseError,\n      context: { parseError },\n      suggestion:\n        \"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @shadcn, @example).\",\n    })\n\n    this.parseError = parseError\n    this.name = \"RegistriesIndexParseError\"\n  }\n}\n\nexport class InvalidConfigIconLibraryError extends RegistryError {\n  constructor(\n    public readonly iconLibrary: string,\n    public readonly validOptions: string[]\n  ) {\n    const message = `Invalid icon library \"${iconLibrary}\". Valid options are: ${validOptions.join(\n      \", \"\n    )}`\n\n    super(message, {\n      code: RegistryErrorCode.INVALID_CONFIG,\n      context: { iconLibrary, validOptions },\n      suggestion: `Update the \"iconLibrary\" field in your components.json to one of: ${validOptions.join(\n        \", \"\n      )}`,\n    })\n    this.name = \"InvalidConfigIconLibraryError\"\n  }\n}\n","// Valid registry name pattern: @namespace where namespace is alphanumeric with hyphens/underscores\nconst REGISTRY_PATTERN = /^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\\/(.+)$/\n\nexport function parseRegistryAndItemFromString(name: string) {\n  if (!name.startsWith(\"@\")) {\n    return {\n      registry: null,\n      item: name,\n    }\n  }\n\n  const match = name.match(REGISTRY_PATTERN)\n  if (match) {\n    return {\n      registry: match[1],\n      item: match[2],\n    }\n  }\n\n  return {\n    registry: null,\n    item: name,\n  }\n}\n","export const FRAMEWORKS = {\n  \"next-app\": {\n    name: \"next-app\",\n    label: \"Next.js\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/next\",\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\n    },\n  },\n  \"next-pages\": {\n    name: \"next-pages\",\n    label: \"Next.js\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/next\",\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\n    },\n  },\n  remix: {\n    name: \"remix\",\n    label: \"Remix\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/remix\",\n      tailwind: \"https://tailwindcss.com/docs/guides/remix\",\n    },\n  },\n  \"react-router\": {\n    name: \"react-router\",\n    label: \"React Router\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/react-router\",\n      tailwind:\n        \"https://tailwindcss.com/docs/installation/framework-guides/react-router\",\n    },\n  },\n  vite: {\n    name: \"vite\",\n    label: \"Vite\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/vite\",\n      tailwind: \"https://tailwindcss.com/docs/guides/vite\",\n    },\n  },\n  astro: {\n    name: \"astro\",\n    label: \"Astro\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/astro\",\n      tailwind: \"https://tailwindcss.com/docs/guides/astro\",\n    },\n  },\n  laravel: {\n    name: \"laravel\",\n    label: \"Laravel\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/laravel\",\n      tailwind: \"https://tailwindcss.com/docs/guides/laravel\",\n    },\n  },\n  \"tanstack-start\": {\n    name: \"tanstack-start\",\n    label: \"TanStack Start\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/tanstack\",\n      tailwind: \"https://tailwindcss.com/docs/installation/using-postcss\",\n    },\n  },\n  gatsby: {\n    name: \"gatsby\",\n    label: \"Gatsby\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/gatsby\",\n      tailwind: \"https://tailwindcss.com/docs/guides/gatsby\",\n    },\n  },\n  expo: {\n    name: \"expo\",\n    label: \"Expo\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/expo\",\n      tailwind: \"https://www.nativewind.dev/docs/getting-started/installation\",\n    },\n  },\n  manual: {\n    name: \"manual\",\n    label: \"Manual\",\n    links: {\n      installation: \"https://ui.shadcn.com/docs/installation/manual\",\n      tailwind: \"https://tailwindcss.com/docs/installation\",\n    },\n  },\n} as const\n\nexport type Framework = (typeof FRAMEWORKS)[keyof typeof FRAMEWORKS]\n","import { cyan, green, red, yellow } from \"kleur/colors\"\n\nexport const highlighter = {\n  error: red,\n  warn: yellow,\n  info: cyan,\n  success: green,\n}\n","import { createMatchPath, type ConfigLoaderSuccessResult } from \"tsconfig-paths\"\n\nexport async function resolveImport(\n  importPath: string,\n  config: Pick<ConfigLoaderSuccessResult, \"absoluteBaseUrl\" | \"paths\">\n) {\n  return createMatchPath(config.absoluteBaseUrl, config.paths)(\n    importPath,\n    undefined,\n    () => true,\n    [\".ts\", \".tsx\", \".jsx\", \".js\", \".css\"]\n  )\n}\n","import path from \"path\"\nimport { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\nimport {\n  configSchema,\n  rawConfigSchema,\n  workspaceConfigSchema,\n} from \"@/src/schema\"\nimport { getProjectInfo } from \"@/src/utils/get-project-info\"\nimport { highlighter } from \"@/src/utils/highlighter\"\nimport { resolveImport } from \"@/src/utils/resolve-import\"\nimport { cosmiconfig } from \"cosmiconfig\"\nimport fg from \"fast-glob\"\nimport { loadConfig } from \"tsconfig-paths\"\nimport { z } from \"zod\"\n\nexport const DEFAULT_STYLE = \"default\"\nexport const DEFAULT_COMPONENTS = \"@/components\"\nexport const DEFAULT_UTILS = \"@/lib/utils\"\nexport const DEFAULT_TAILWIND_CSS = \"app/globals.css\"\nexport const DEFAULT_TAILWIND_CONFIG = \"tailwind.config.js\"\nexport const DEFAULT_TAILWIND_BASE_COLOR = \"slate\"\n\n// TODO: Figure out if we want to support all cosmiconfig formats.\n// A simple components.json file would be nice.\nexport const explorer = cosmiconfig(\"components\", {\n  searchPlaces: [\"components.json\"],\n})\n\nexport type Config = z.infer<typeof configSchema>\n\nexport async function getConfig(cwd: string) {\n  const config = await getRawConfig(cwd)\n\n  if (!config) {\n    return null\n  }\n\n  // Set default icon library if not provided.\n  if (!config.iconLibrary) {\n    config.iconLibrary = config.style === \"new-york\" ? \"radix\" : \"lucide\"\n  }\n\n  return await resolveConfigPaths(cwd, config)\n}\n\nexport async function resolveConfigPaths(\n  cwd: string,\n  config: z.infer<typeof rawConfigSchema>\n) {\n  // Merge built-in registries with user registries\n  config.registries = {\n    ...BUILTIN_REGISTRIES,\n    ...(config.registries || {}),\n  }\n\n  // Read tsconfig.json.\n  const tsConfig = await loadConfig(cwd)\n\n  if (tsConfig.resultType === \"failed\") {\n    throw new Error(\n      `Failed to load ${config.tsx ? \"tsconfig\" : \"jsconfig\"}.json. ${\n        tsConfig.message ?? \"\"\n      }`.trim()\n    )\n  }\n\n  return configSchema.parse({\n    ...config,\n    resolvedPaths: {\n      cwd,\n      tailwindConfig: config.tailwind.config\n        ? path.resolve(cwd, config.tailwind.config)\n        : \"\",\n      tailwindCss: path.resolve(cwd, config.tailwind.css),\n      utils: await resolveImport(config.aliases[\"utils\"], tsConfig),\n      components: await resolveImport(config.aliases[\"components\"], tsConfig),\n      ui: config.aliases[\"ui\"]\n        ? await resolveImport(config.aliases[\"ui\"], tsConfig)\n        : path.resolve(\n            (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\n              cwd,\n            \"ui\"\n          ),\n      // TODO: Make this configurable.\n      // For now, we assume the lib and hooks directories are one level up from the components directory.\n      lib: config.aliases[\"lib\"]\n        ? await resolveImport(config.aliases[\"lib\"], tsConfig)\n        : path.resolve(\n            (await resolveImport(config.aliases[\"utils\"], tsConfig)) ?? cwd,\n            \"..\"\n          ),\n      hooks: config.aliases[\"hooks\"]\n        ? await resolveImport(config.aliases[\"hooks\"], tsConfig)\n        : path.resolve(\n            (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\n              cwd,\n            \"..\",\n            \"hooks\"\n          ),\n    },\n  })\n}\n\nexport async function getRawConfig(\n  cwd: string\n): Promise<z.infer<typeof rawConfigSchema> | null> {\n  try {\n    const configResult = await explorer.search(cwd)\n\n    if (!configResult) {\n      return null\n    }\n\n    const config = rawConfigSchema.parse(configResult.config)\n\n    // Check if user is trying to override built-in registries\n    if (config.registries) {\n      for (const registryName of Object.keys(config.registries)) {\n        if (registryName in BUILTIN_REGISTRIES) {\n          throw new Error(\n            `\"${registryName}\" is a built-in registry and cannot be overridden.`\n          )\n        }\n      }\n    }\n\n    return config\n  } catch (error) {\n    const componentPath = `${cwd}/components.json`\n    if (error instanceof Error && error.message.includes(\"reserved registry\")) {\n      throw error\n    }\n    throw new Error(\n      `Invalid configuration found in ${highlighter.info(componentPath)}.`\n    )\n  }\n}\n\n// Note: we can check for -workspace.yaml or \"workspace\" in package.json.\n// Since cwd is not necessarily the root of the project.\n// We'll instead check if ui aliases resolve to a different root.\nexport async function getWorkspaceConfig(config: Config) {\n  let resolvedAliases: any = {}\n\n  for (const key of Object.keys(config.aliases)) {\n    if (!isAliasKey(key, config)) {\n      continue\n    }\n\n    const resolvedPath = config.resolvedPaths[key]\n    const packageRoot = await findPackageRoot(\n      config.resolvedPaths.cwd,\n      resolvedPath\n    )\n\n    if (!packageRoot) {\n      resolvedAliases[key] = config\n      continue\n    }\n\n    resolvedAliases[key] = await getConfig(packageRoot)\n  }\n\n  const result = workspaceConfigSchema.safeParse(resolvedAliases)\n  if (!result.success) {\n    return null\n  }\n\n  return result.data\n}\n\nexport async function findPackageRoot(cwd: string, resolvedPath: string) {\n  const commonRoot = findCommonRoot(cwd, resolvedPath)\n  const relativePath = path.relative(commonRoot, resolvedPath)\n\n  const packageRoots = await fg.glob(\"**/package.json\", {\n    cwd: commonRoot,\n    deep: 3,\n    ignore: [\"**/node_modules/**\", \"**/dist/**\", \"**/build/**\", \"**/public/**\"],\n  })\n\n  const matchingPackageRoot = packageRoots\n    .map((pkgPath) => path.dirname(pkgPath))\n    .find((pkgDir) => relativePath.startsWith(pkgDir))\n\n  return matchingPackageRoot ? path.join(commonRoot, matchingPackageRoot) : null\n}\n\nfunction isAliasKey(\n  key: string,\n  config: Config\n): key is keyof Config[\"aliases\"] {\n  return Object.keys(config.resolvedPaths)\n    .filter((key) => key !== \"utils\")\n    .includes(key)\n}\n\nexport function findCommonRoot(cwd: string, resolvedPath: string) {\n  const parts1 = cwd.split(path.sep)\n  const parts2 = resolvedPath.split(path.sep)\n  const commonParts = []\n\n  for (let i = 0; i < Math.min(parts1.length, parts2.length); i++) {\n    if (parts1[i] !== parts2[i]) {\n      break\n    }\n    commonParts.push(parts1[i])\n  }\n\n  return commonParts.join(path.sep)\n}\n\n// TODO: Cache this call.\nexport async function getTargetStyleFromConfig(cwd: string, fallback: string) {\n  const projectInfo = await getProjectInfo(cwd)\n  return projectInfo?.tailwindVersion === \"v4\" ? \"new-york-v4\" : fallback\n}\n\nexport type DeepPartial<T> = {\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\n}\n\n/**\n * Creates a config object with sensible defaults.\n * Useful for universal registry items that bypass framework detection.\n *\n * @param partial - Partial config values to override defaults\n * @returns A complete Config object\n */\nexport function createConfig(partial?: DeepPartial<Config>): Config {\n  const defaultConfig: Config = {\n    resolvedPaths: {\n      cwd: process.cwd(),\n      tailwindConfig: \"\",\n      tailwindCss: \"\",\n      utils: \"\",\n      components: \"\",\n      ui: \"\",\n      lib: \"\",\n      hooks: \"\",\n    },\n    style: \"\",\n    tailwind: {\n      config: \"\",\n      css: \"\",\n      baseColor: \"\",\n      cssVariables: false,\n    },\n    rsc: false,\n    tsx: true,\n    aliases: {\n      components: \"\",\n      utils: \"\",\n    },\n    registries: {\n      ...BUILTIN_REGISTRIES,\n    },\n  }\n\n  // Deep merge the partial config with defaults\n  if (partial) {\n    return {\n      ...defaultConfig,\n      ...partial,\n      resolvedPaths: {\n        ...defaultConfig.resolvedPaths,\n        ...(partial.resolvedPaths || {}),\n      },\n      tailwind: {\n        ...defaultConfig.tailwind,\n        ...(partial.tailwind || {}),\n      },\n      aliases: {\n        ...defaultConfig.aliases,\n        ...(partial.aliases || {}),\n      },\n      registries: {\n        ...defaultConfig.registries,\n        ...(partial.registries || {}),\n      },\n    }\n  }\n\n  return defaultConfig\n}\n","import path from \"path\"\nimport fs from \"fs-extra\"\nimport { type PackageJson } from \"type-fest\"\n\nexport function getPackageInfo(\n  cwd: string = \"\",\n  shouldThrow: boolean = true\n): PackageJson | null {\n  const packageJsonPath = path.join(cwd, \"package.json\")\n\n  return fs.readJSONSync(packageJsonPath, {\n    throws: shouldThrow,\n  }) as PackageJson\n}\n","import path from \"path\"\nimport { rawConfigSchema } from \"@/src/schema\"\nimport { FRAMEWORKS, Framework } from \"@/src/utils/frameworks\"\nimport { Config, getConfig, resolveConfigPaths } from \"@/src/utils/get-config\"\nimport { getPackageInfo } from \"@/src/utils/get-package-info\"\nimport fg from \"fast-glob\"\nimport fs from \"fs-extra\"\nimport { loadConfig } from \"tsconfig-paths\"\nimport { z } from \"zod\"\n\nexport type TailwindVersion = \"v3\" | \"v4\" | null\n\nexport type ProjectInfo = {\n  framework: Framework\n  isSrcDir: boolean\n  isRSC: boolean\n  isTsx: boolean\n  tailwindConfigFile: string | null\n  tailwindCssFile: string | null\n  tailwindVersion: TailwindVersion\n  frameworkVersion: string | null\n  aliasPrefix: string | null\n}\n\nconst PROJECT_SHARED_IGNORE = [\n  \"**/node_modules/**\",\n  \".next\",\n  \"public\",\n  \"dist\",\n  \"build\",\n]\n\nconst TS_CONFIG_SCHEMA = z.object({\n  compilerOptions: z.object({\n    paths: z.record(z.string().or(z.array(z.string()))),\n  }),\n})\n\nexport async function getProjectInfo(cwd: string): Promise<ProjectInfo | null> {\n  const [\n    configFiles,\n    isSrcDir,\n    isTsx,\n    tailwindConfigFile,\n    tailwindCssFile,\n    tailwindVersion,\n    aliasPrefix,\n    packageJson,\n  ] = await Promise.all([\n    fg.glob(\n      \"**/{next,vite,astro,app}.config.*|gatsby-config.*|composer.json|react-router.config.*\",\n      {\n        cwd,\n        deep: 3,\n        ignore: PROJECT_SHARED_IGNORE,\n      }\n    ),\n    fs.pathExists(path.resolve(cwd, \"src\")),\n    isTypeScriptProject(cwd),\n    getTailwindConfigFile(cwd),\n    getTailwindCssFile(cwd),\n    getTailwindVersion(cwd),\n    getTsConfigAliasPrefix(cwd),\n    getPackageInfo(cwd, false),\n  ])\n\n  const isUsingAppDir = await fs.pathExists(\n    path.resolve(cwd, `${isSrcDir ? \"src/\" : \"\"}app`)\n  )\n\n  const type: ProjectInfo = {\n    framework: FRAMEWORKS[\"manual\"],\n    isSrcDir,\n    isRSC: false,\n    isTsx,\n    tailwindConfigFile,\n    tailwindCssFile,\n    tailwindVersion,\n    frameworkVersion: null,\n    aliasPrefix,\n  }\n\n  // Next.js.\n  if (configFiles.find((file) => file.startsWith(\"next.config.\"))?.length) {\n    type.framework = isUsingAppDir\n      ? FRAMEWORKS[\"next-app\"]\n      : FRAMEWORKS[\"next-pages\"]\n    type.isRSC = isUsingAppDir\n    type.frameworkVersion = await getFrameworkVersion(\n      type.framework,\n      packageJson\n    )\n    return type\n  }\n\n  // Astro.\n  if (configFiles.find((file) => file.startsWith(\"astro.config.\"))?.length) {\n    type.framework = FRAMEWORKS[\"astro\"]\n    return type\n  }\n\n  // Gatsby.\n  if (configFiles.find((file) => file.startsWith(\"gatsby-config.\"))?.length) {\n    type.framework = FRAMEWORKS[\"gatsby\"]\n    return type\n  }\n\n  // Laravel.\n  if (configFiles.find((file) => file.startsWith(\"composer.json\"))?.length) {\n    type.framework = FRAMEWORKS[\"laravel\"]\n    return type\n  }\n\n  // Remix.\n  if (\n    Object.keys(packageJson?.dependencies ?? {}).find((dep) =>\n      dep.startsWith(\"@remix-run/\")\n    )\n  ) {\n    type.framework = FRAMEWORKS[\"remix\"]\n    return type\n  }\n\n  // TanStack Start.\n  if (\n    [\n      ...Object.keys(packageJson?.dependencies ?? {}),\n      ...Object.keys(packageJson?.devDependencies ?? {}),\n    ].find((dep) => dep.startsWith(\"@tanstack/react-start\"))\n  ) {\n    type.framework = FRAMEWORKS[\"tanstack-start\"]\n    return type\n  }\n\n  // React Router.\n  if (\n    configFiles.find((file) => file.startsWith(\"react-router.config.\"))?.length\n  ) {\n    type.framework = FRAMEWORKS[\"react-router\"]\n    return type\n  }\n\n  // Vite.\n  // Some Remix templates also have a vite.config.* file.\n  // We'll assume that it got caught by the Remix check above.\n  if (configFiles.find((file) => file.startsWith(\"vite.config.\"))?.length) {\n    type.framework = FRAMEWORKS[\"vite\"]\n    return type\n  }\n\n  // Vinxi-based (such as @tanstack/start and @solidjs/solid-start)\n  // They are vite-based, and the same configurations used for Vite should work flawlessly\n  const appConfig = configFiles.find((file) => file.startsWith(\"app.config\"))\n  if (appConfig?.length) {\n    const appConfigContents = await fs.readFile(\n      path.resolve(cwd, appConfig),\n      \"utf8\"\n    )\n    if (appConfigContents.includes(\"defineConfig\")) {\n      type.framework = FRAMEWORKS[\"vite\"]\n      return type\n    }\n  }\n\n  // Expo.\n  if (packageJson?.dependencies?.expo) {\n    type.framework = FRAMEWORKS[\"expo\"]\n    return type\n  }\n\n  return type\n}\n\nexport async function getFrameworkVersion(\n  framework: Framework,\n  packageJson: ReturnType<typeof getPackageInfo>\n) {\n  if (!packageJson) {\n    return null\n  }\n\n  // Only detect Next.js version for now.\n  if (![\"next-app\", \"next-pages\"].includes(framework.name)) {\n    return null\n  }\n\n  const version =\n    packageJson.dependencies?.next || packageJson.devDependencies?.next\n\n  if (!version) {\n    return null\n  }\n\n  // Extract full semver (major.minor.patch), handling ^, ~, etc.\n  const versionMatch = version.match(/^[\\^~]?(\\d+\\.\\d+\\.\\d+)/)\n  if (versionMatch) {\n    return versionMatch[1] // e.g., \"16.0.0\"\n  }\n\n  // For ranges like \">=15.0.0 <16.0.0\", extract the first version.\n  const rangeMatch = version.match(/(\\d+\\.\\d+\\.\\d+)/)\n  if (rangeMatch) {\n    return rangeMatch[1]\n  }\n\n  // For \"latest\", \"canary\", \"rc\", etc., return the tag as-is.\n  return version\n}\n\nexport async function getTailwindVersion(\n  cwd: string\n): Promise<ProjectInfo[\"tailwindVersion\"]> {\n  const [packageInfo, config] = await Promise.all([\n    getPackageInfo(cwd, false),\n    getConfig(cwd),\n  ])\n\n  // If the config file is empty, we can assume that it's a v4 project.\n  if (config?.tailwind?.config === \"\") {\n    return \"v4\"\n  }\n\n  if (\n    !packageInfo?.dependencies?.tailwindcss &&\n    !packageInfo?.devDependencies?.tailwindcss\n  ) {\n    return null\n  }\n\n  if (\n    /^(?:\\^|~)?3(?:\\.\\d+)*(?:-.*)?$/.test(\n      packageInfo?.dependencies?.tailwindcss ||\n        packageInfo?.devDependencies?.tailwindcss ||\n        \"\"\n    )\n  ) {\n    return \"v3\"\n  }\n\n  return \"v4\"\n}\n\nexport async function getTailwindCssFile(cwd: string) {\n  const [files, tailwindVersion] = await Promise.all([\n    fg.glob([\"**/*.css\", \"**/*.scss\"], {\n      cwd,\n      deep: 5,\n      ignore: PROJECT_SHARED_IGNORE,\n    }),\n    getTailwindVersion(cwd),\n  ])\n\n  if (!files.length) {\n    return null\n  }\n\n  const needle =\n    tailwindVersion === \"v4\" ? `@import \"tailwindcss\"` : \"@tailwind base\"\n  for (const file of files) {\n    const contents = await fs.readFile(path.resolve(cwd, file), \"utf8\")\n    if (\n      contents.includes(`@import \"tailwindcss\"`) ||\n      contents.includes(`@import 'tailwindcss'`) ||\n      contents.includes(`@tailwind base`)\n    ) {\n      return file\n    }\n  }\n\n  return null\n}\n\nexport async function getTailwindConfigFile(cwd: string) {\n  const files = await fg.glob(\"tailwind.config.*\", {\n    cwd,\n    deep: 3,\n    ignore: PROJECT_SHARED_IGNORE,\n  })\n\n  if (!files.length) {\n    return null\n  }\n\n  return files[0]\n}\n\nexport async function getTsConfigAliasPrefix(cwd: string) {\n  const tsConfig = await loadConfig(cwd)\n\n  if (\n    tsConfig?.resultType === \"failed\" ||\n    !Object.entries(tsConfig?.paths).length\n  ) {\n    return null\n  }\n\n  // This assume that the first alias is the prefix.\n  for (const [alias, paths] of Object.entries(tsConfig.paths)) {\n    if (\n      paths.includes(\"./*\") ||\n      paths.includes(\"./src/*\") ||\n      paths.includes(\"./app/*\") ||\n      paths.includes(\"./resources/js/*\") // Laravel.\n    ) {\n      return alias.replace(/\\/\\*$/, \"\") ?? null\n    }\n  }\n\n  // Use the first alias as the prefix.\n  return Object.keys(tsConfig?.paths)?.[0].replace(/\\/\\*$/, \"\") ?? null\n}\n\nexport async function isTypeScriptProject(cwd: string) {\n  const files = await fg.glob(\"tsconfig.*\", {\n    cwd,\n    deep: 1,\n    ignore: PROJECT_SHARED_IGNORE,\n  })\n\n  return files.length > 0\n}\n\nexport async function getTsConfig(cwd: string) {\n  for (const fallback of [\n    \"tsconfig.json\",\n    \"tsconfig.web.json\",\n    \"tsconfig.app.json\",\n  ]) {\n    const filePath = path.resolve(cwd, fallback)\n    if (!(await fs.pathExists(filePath))) {\n      continue\n    }\n\n    // We can't use fs.readJSON because it doesn't support comments.\n    const contents = await fs.readFile(filePath, \"utf8\")\n    const cleanedContents = contents.replace(/\\/\\*\\s*\\*\\//g, \"\")\n    const result = TS_CONFIG_SCHEMA.safeParse(JSON.parse(cleanedContents))\n\n    if (result.error) {\n      continue\n    }\n\n    return result.data\n  }\n\n  return null\n}\n\nexport async function getProjectConfig(\n  cwd: string,\n  defaultProjectInfo: ProjectInfo | null = null\n): Promise<Config | null> {\n  // Check for existing component config.\n  const [existingConfig, projectInfo] = await Promise.all([\n    getConfig(cwd),\n    !defaultProjectInfo\n      ? getProjectInfo(cwd)\n      : Promise.resolve(defaultProjectInfo),\n  ])\n\n  if (existingConfig) {\n    return existingConfig\n  }\n\n  if (\n    !projectInfo ||\n    !projectInfo.tailwindCssFile ||\n    (projectInfo.tailwindVersion === \"v3\" && !projectInfo.tailwindConfigFile)\n  ) {\n    return null\n  }\n\n  const config: z.infer<typeof rawConfigSchema> = {\n    $schema: \"https://ui.shadcn.com/schema.json\",\n    rsc: projectInfo.isRSC,\n    tsx: projectInfo.isTsx,\n    style: \"new-york\",\n    tailwind: {\n      config: projectInfo.tailwindConfigFile ?? \"\",\n      baseColor: \"zinc\",\n      css: projectInfo.tailwindCssFile,\n      cssVariables: true,\n      prefix: \"\",\n    },\n    iconLibrary: \"lucide\",\n    aliases: {\n      components: `${projectInfo.aliasPrefix}/components`,\n      ui: `${projectInfo.aliasPrefix}/components/ui`,\n      hooks: `${projectInfo.aliasPrefix}/hooks`,\n      lib: `${projectInfo.aliasPrefix}/lib`,\n      utils: `${projectInfo.aliasPrefix}/lib/utils`,\n    },\n  }\n\n  return await resolveConfigPaths(cwd, config)\n}\n\nexport async function getProjectTailwindVersionFromConfig(config: {\n  resolvedPaths: Pick<Config[\"resolvedPaths\"], \"cwd\">\n}): Promise<TailwindVersion> {\n  if (!config.resolvedPaths?.cwd) {\n    return \"v3\"\n  }\n\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\n\n  if (!projectInfo?.tailwindVersion) {\n    return null\n  }\n\n  return projectInfo.tailwindVersion\n}\n","export function isContentSame(\n  existingContent: string,\n  newContent: string,\n  options: {\n    ignoreImports?: boolean\n  } = {}\n) {\n  const { ignoreImports = false } = options\n\n  // Normalize line endings and whitespace.\n  const normalizedExisting = existingContent.replace(/\\r\\n/g, \"\\n\").trim()\n  const normalizedNew = newContent.replace(/\\r\\n/g, \"\\n\").trim()\n\n  // First, try exact match after normalization.\n  if (normalizedExisting === normalizedNew) {\n    return true\n  }\n\n  // If not ignoring imports or exact match failed, return false\n  if (!ignoreImports) {\n    return false\n  }\n\n  // Compare with import statements normalized.\n  // This regex matches various import patterns including:\n  // - import defaultExport from \"module\"\n  // - import * as name from \"module\"\n  // - import { export1, export2 } from \"module\"\n  // - import { export1 as alias1 } from \"module\"\n  // - import defaultExport, { export1 } from \"module\"\n  // - import type { Type } from \"module\"\n  // - This Regex written by Claude Code.\n  const importRegex =\n    /^(import\\s+(?:type\\s+)?(?:\\*\\s+as\\s+\\w+|\\{[^}]*\\}|\\w+)?(?:\\s*,\\s*(?:\\{[^}]*\\}|\\w+))?\\s+from\\s+[\"'])([^\"']+)([\"'])/gm\n\n  // Function to normalize import paths - remove alias differences.\n  const normalizeImports = (content: string) => {\n    return content.replace(\n      importRegex,\n      (_match, prefix, importPath, suffix) => {\n        // Keep relative imports as-is.\n        if (importPath.startsWith(\".\")) {\n          return `${prefix}${importPath}${suffix}`\n        }\n\n        // For aliased imports, normalize to a common format.\n        // Extract the last meaningful part of the path.\n        const parts = importPath.split(\"/\")\n        const lastPart = parts[parts.length - 1]\n\n        // Normalize to a consistent format.\n        return `${prefix}@normalized/${lastPart}${suffix}`\n      }\n    )\n  }\n\n  const existingNormalized = normalizeImports(normalizedExisting)\n  const newNormalized = normalizeImports(normalizedNew)\n\n  return existingNormalized === newNormalized\n}\n","import { existsSync } from \"fs\"\nimport path from \"path\"\n\nexport function isEnvFile(filePath: string) {\n  const fileName = path.basename(filePath)\n  return /^\\.env(\\.|$)/.test(fileName)\n}\n\n/**\n * Finds a file variant in the project.\n * TODO: abstract this to a more generic function.\n */\nexport function findExistingEnvFile(targetDir: string) {\n  const variants = [\n    \".env.local\",\n    \".env\",\n    \".env.development.local\",\n    \".env.development\",\n  ]\n\n  for (const variant of variants) {\n    const filePath = path.join(targetDir, variant)\n    if (existsSync(filePath)) {\n      return filePath\n    }\n  }\n\n  return null\n}\n\n/**\n * Parse .env content into key-value pairs.\n */\nexport function parseEnvContent(content: string) {\n  const lines = content.split(\"\\n\")\n  const env: Record<string, string> = {}\n\n  for (const line of lines) {\n    const trimmed = line.trim()\n\n    if (!trimmed || trimmed.startsWith(\"#\")) {\n      continue\n    }\n\n    // Find the first = and split there\n    const equalIndex = trimmed.indexOf(\"=\")\n    if (equalIndex === -1) {\n      continue\n    }\n\n    const key = trimmed.substring(0, equalIndex).trim()\n    const value = trimmed.substring(equalIndex + 1).trim()\n\n    if (key) {\n      env[key] = value.replace(/^[\"']|[\"']$/g, \"\")\n    }\n  }\n\n  return env\n}\n\n/**\n * Get the list of new keys that would be added when merging env content.\n */\nexport function getNewEnvKeys(existingContent: string, newContent: string) {\n  const existingEnv = parseEnvContent(existingContent)\n  const newEnv = parseEnvContent(newContent)\n\n  const newKeys = []\n  for (const key of Object.keys(newEnv)) {\n    if (!(key in existingEnv)) {\n      newKeys.push(key)\n    }\n  }\n\n  return newKeys\n}\n\n/**\n * Merge env content by appending ONLY new keys that don't exist in the existing content.\n * Existing keys are preserved with their original values.\n */\nexport function mergeEnvContent(existingContent: string, newContent: string) {\n  const existingEnv = parseEnvContent(existingContent)\n  const newEnv = parseEnvContent(newContent)\n\n  let result = existingContent.trimEnd()\n  if (result && !result.endsWith(\"\\n\")) {\n    result += \"\\n\"\n  }\n\n  const newKeys: string[] = []\n  for (const [key, value] of Object.entries(newEnv)) {\n    if (!(key in existingEnv)) {\n      newKeys.push(`${key}=${value}`)\n    }\n  }\n\n  if (newKeys.length > 0) {\n    if (result) {\n      result += \"\\n\"\n    }\n    result += newKeys.join(\"\\n\")\n    return result + \"\\n\"\n  }\n\n  // Ensure existing content ends with newline.\n  if (result && !result.endsWith(\"\\n\")) {\n    return result + \"\\n\"\n  }\n\n  return result\n}\n","import { highlighter } from \"@/src/utils/highlighter\"\n\nexport const logger = {\n  error(...args: unknown[]) {\n    console.log(highlighter.error(args.join(\" \")))\n  },\n  warn(...args: unknown[]) {\n    console.log(highlighter.warn(args.join(\" \")))\n  },\n  info(...args: unknown[]) {\n    console.log(highlighter.info(args.join(\" \")))\n  },\n  success(...args: unknown[]) {\n    console.log(highlighter.success(args.join(\" \")))\n  },\n  log(...args: unknown[]) {\n    console.log(args.join(\" \"))\n  },\n  break() {\n    console.log(\"\")\n  },\n}\n","import ora, { type Options } from \"ora\"\n\nexport function spinner(\n  text: Options[\"text\"],\n  options?: {\n    silent?: boolean\n  }\n) {\n  return ora({\n    text,\n    isSilent: options?.silent,\n  })\n}\n","import { Config } from \"@/src/utils/get-config\"\nimport { Transformer } from \"@/src/utils/transformers\"\nimport { SyntaxKind } from \"ts-morph\"\n\nexport const transformImport: Transformer = async ({\n  sourceFile,\n  config,\n  isRemote,\n}) => {\n  const utilsAlias = config.aliases?.utils\n  const workspaceAlias =\n    typeof utilsAlias === \"string\" && utilsAlias.includes(\"/\")\n      ? utilsAlias.split(\"/\")[0]\n      : \"@\"\n  const utilsImport = `${workspaceAlias}/lib/utils`\n\n  if (![\".tsx\", \".ts\", \".jsx\", \".js\"].includes(sourceFile.getExtension())) {\n    return sourceFile\n  }\n\n  for (const specifier of sourceFile.getImportStringLiterals()) {\n    const updated = updateImportAliases(\n      specifier.getLiteralValue(),\n      config,\n      isRemote\n    )\n    specifier.setLiteralValue(updated)\n\n    // Replace `import { cn } from \"@/lib/utils\"`\n    if (utilsImport === updated || updated === \"@/lib/utils\") {\n      const importDeclaration = specifier.getFirstAncestorByKind(\n        SyntaxKind.ImportDeclaration\n      )\n      const isCnImport = importDeclaration\n        ?.getNamedImports()\n        .some((namedImport) => namedImport.getName() === \"cn\")\n\n      if (!isCnImport || !config.aliases.utils) {\n        continue\n      }\n\n      specifier.setLiteralValue(\n        utilsImport === updated\n          ? updated.replace(utilsImport, config.aliases.utils)\n          : config.aliases.utils\n      )\n    }\n  }\n\n  return sourceFile\n}\n\nfunction updateImportAliases(\n  moduleSpecifier: string,\n  config: Config,\n  isRemote: boolean = false\n) {\n  // Not a local import.\n  if (!moduleSpecifier.startsWith(\"@/\") && !isRemote) {\n    return moduleSpecifier\n  }\n\n  // This treats the remote as coming from a faux registry.\n  if (isRemote && moduleSpecifier.startsWith(\"@/\")) {\n    moduleSpecifier = moduleSpecifier.replace(/^@\\//, `@/registry/new-york/`)\n  }\n\n  // Not a registry import.\n  if (!moduleSpecifier.startsWith(\"@/registry/\")) {\n    // We fix the alias and return.\n    const alias = config.aliases.components.split(\"/\")[0]\n    return moduleSpecifier.replace(/^@\\//, `${alias}/`)\n  }\n\n  if (moduleSpecifier.match(/^@\\/registry\\/(.+)\\/ui/)) {\n    return moduleSpecifier.replace(\n      /^@\\/registry\\/(.+)\\/ui/,\n      config.aliases.ui ?? `${config.aliases.components}/ui`\n    )\n  }\n\n  if (\n    config.aliases.components &&\n    moduleSpecifier.match(/^@\\/registry\\/(.+)\\/components/)\n  ) {\n    return moduleSpecifier.replace(\n      /^@\\/registry\\/(.+)\\/components/,\n      config.aliases.components\n    )\n  }\n\n  if (config.aliases.lib && moduleSpecifier.match(/^@\\/registry\\/(.+)\\/lib/)) {\n    return moduleSpecifier.replace(\n      /^@\\/registry\\/(.+)\\/lib/,\n      config.aliases.lib\n    )\n  }\n\n  if (\n    config.aliases.hooks &&\n    moduleSpecifier.match(/^@\\/registry\\/(.+)\\/hooks/)\n  ) {\n    return moduleSpecifier.replace(\n      /^@\\/registry\\/(.+)\\/hooks/,\n      config.aliases.hooks\n    )\n  }\n\n  return moduleSpecifier.replace(\n    /^@\\/registry\\/[^/]+/,\n    config.aliases.components\n  )\n}\n","import { type Transformer } from \"@/src/utils/transformers\"\nimport { transformFromAstSync } from \"@babel/core\"\nimport { ParserOptions, parse } from \"@babel/parser\"\n// @ts-ignore\nimport transformTypescript from \"@babel/plugin-transform-typescript\"\nimport * as recast from \"recast\"\n\n// TODO.\n// I'm using recast for the AST here.\n// Figure out if ts-morph AST is compatible with Babel.\n\n// This is a copy of the babel options from recast/parser.\n// The goal here is to tolerate as much syntax as possible.\n// We want to be able to parse any valid tsx code.\n// See https://github.com/benjamn/recast/blob/master/parsers/_babel_options.ts.\nconst PARSE_OPTIONS: ParserOptions = {\n  sourceType: \"module\",\n  allowImportExportEverywhere: true,\n  allowReturnOutsideFunction: true,\n  startLine: 1,\n  tokens: true,\n  plugins: [\n    \"asyncGenerators\",\n    \"bigInt\",\n    \"classPrivateMethods\",\n    \"classPrivateProperties\",\n    \"classProperties\",\n    \"classStaticBlock\",\n    \"decimal\",\n    \"decorators-legacy\",\n    \"doExpressions\",\n    \"dynamicImport\",\n    \"exportDefaultFrom\",\n    \"exportNamespaceFrom\",\n    \"functionBind\",\n    \"functionSent\",\n    \"importAssertions\",\n    \"importMeta\",\n    \"nullishCoalescingOperator\",\n    \"numericSeparator\",\n    \"objectRestSpread\",\n    \"optionalCatchBinding\",\n    \"optionalChaining\",\n    [\n      \"pipelineOperator\",\n      {\n        proposal: \"minimal\",\n      },\n    ],\n    [\n      \"recordAndTuple\",\n      {\n        syntaxType: \"hash\",\n      },\n    ],\n    \"throwExpressions\",\n    \"topLevelAwait\",\n    \"v8intrinsic\",\n    \"typescript\",\n    \"jsx\",\n  ],\n}\n\nexport const transformJsx: Transformer<string> = async ({\n  sourceFile,\n  config,\n}) => {\n  const output = sourceFile.getFullText()\n\n  if (config.tsx) {\n    return output\n  }\n\n  const ast = recast.parse(output, {\n    parser: {\n      parse: (code: string) => {\n        return parse(code, PARSE_OPTIONS)\n      },\n    },\n  })\n\n  const result = transformFromAstSync(ast, output, {\n    cloneInputAst: false,\n    code: false,\n    ast: true,\n    plugins: [transformTypescript],\n    configFile: false,\n  })\n\n  if (!result || !result.ast) {\n    throw new Error(\"Failed to transform JSX\")\n  }\n\n  return recast.print(result.ast).code\n}\n","import { Transformer } from \"@/src/utils/transformers\"\nimport { SyntaxKind } from \"ts-morph\"\n\nconst directiveRegex = /^[\"']use client[\"']$/g\n\nexport const transformRsc: Transformer = async ({ sourceFile, config }) => {\n  if (config.rsc) {\n    return sourceFile\n  }\n\n  // Remove \"use client\" from the top of the file.\n  const first = sourceFile.getFirstChildByKind(SyntaxKind.ExpressionStatement)\n  if (first && directiveRegex.test(first.getText())) {\n    first.remove()\n  }\n\n  return sourceFile\n}\n","import { Transformer } from \"@/src/utils/transformers\"\nimport {\n  NoSubstitutionTemplateLiteral,\n  Node,\n  Project,\n  ScriptKind,\n  SourceFile,\n  StringLiteral,\n  SyntaxKind,\n} from \"ts-morph\"\n\n// Regex to match cn-* marker classes (e.g., cn-rtl-flip, cn-logical-sides).\nconst CN_MARKER_REGEX = /\\bcn-[a-z-]+\\b/\nconst CN_MARKER_REGEX_GLOBAL = /\\bcn-[a-z-]+\\b/g\n\n// Helper to strip all cn-* marker classes from a className string.\nexport function stripCnMarkers(className: string) {\n  return className\n    .replace(CN_MARKER_REGEX_GLOBAL, \"\")\n    .replace(/\\s+/g, \" \")\n    .trim()\n}\n\ntype StringLikeLiteral = StringLiteral | NoSubstitutionTemplateLiteral\n\n// Processes a string-like literal and strips cn-* markers.\nfunction processStringLiteral(node: StringLikeLiteral) {\n  const currentValue = node.getLiteralValue()\n  if (!CN_MARKER_REGEX.test(currentValue)) {\n    return\n  }\n\n  const newValue = stripCnMarkers(currentValue)\n  if (newValue !== currentValue) {\n    node.setLiteralValue(newValue)\n  }\n}\n\nfunction processStringLiterals(node: Node) {\n  for (const stringLit of node.getDescendantsOfKind(SyntaxKind.StringLiteral)) {\n    processStringLiteral(stringLit)\n  }\n\n  for (const templateLit of node.getDescendantsOfKind(\n    SyntaxKind.NoSubstitutionTemplateLiteral\n  )) {\n    processStringLiteral(templateLit)\n  }\n}\n\n// Apply cleanup to a SourceFile directly (used by transformDirection).\nexport function applyCleanup(sourceFile: SourceFile) {\n  // Collect attributes to remove (can't remove while iterating).\n  const attributesToRemove: ReturnType<\n    typeof sourceFile.getDescendantsOfKind<typeof SyntaxKind.JsxAttribute>\n  > = []\n\n  // Process all JSX className attributes.\n  for (const attr of sourceFile.getDescendantsOfKind(SyntaxKind.JsxAttribute)) {\n    const attrName = attr.getNameNode().getText()\n    if (attrName !== \"className\" && attrName !== \"classNames\") {\n      continue\n    }\n\n    const initializer = attr.getInitializer()\n\n    // className=\"...\"\n    if (initializer?.isKind(SyntaxKind.StringLiteral)) {\n      const currentValue = initializer.getLiteralValue()\n      if (CN_MARKER_REGEX.test(currentValue)) {\n        const newValue = stripCnMarkers(currentValue)\n        if (newValue === \"\") {\n          // Remove the entire attribute if className becomes empty.\n          attributesToRemove.push(attr)\n        } else if (newValue !== currentValue) {\n          initializer.setLiteralValue(newValue)\n        }\n      }\n    }\n\n    // className={...} or classNames={{...}}\n    if (initializer?.isKind(SyntaxKind.JsxExpression)) {\n      processStringLiterals(initializer)\n    }\n  }\n\n  // Remove empty className attributes.\n  for (const attr of attributesToRemove) {\n    attr.remove()\n  }\n\n  // Process cva() calls.\n  for (const call of sourceFile.getDescendantsOfKind(\n    SyntaxKind.CallExpression\n  )) {\n    if (call.getExpression().getText() !== \"cva\") {\n      continue\n    }\n\n    for (const arg of call.getArguments()) {\n      if (arg.isKind(SyntaxKind.StringLiteral)) {\n        processStringLiteral(arg)\n        continue\n      }\n      if (arg.isKind(SyntaxKind.NoSubstitutionTemplateLiteral)) {\n        processStringLiteral(arg)\n        continue\n      }\n      // Handle object arguments (variants).\n      processStringLiterals(arg)\n    }\n  }\n\n  // Process mergeProps() calls.\n  for (const call of sourceFile.getDescendantsOfKind(\n    SyntaxKind.CallExpression\n  )) {\n    if (call.getExpression().getText() !== \"mergeProps\") {\n      continue\n    }\n\n    processStringLiterals(call)\n  }\n}\n\nexport const transformCleanup: Transformer = async ({ sourceFile }) => {\n  applyCleanup(sourceFile)\n  return sourceFile\n}\n\n// Standalone function to clean up cn-* markers from source code.\n// This is used by the build script and doesn't require a config object.\nexport async function cleanupMarkers(source: string) {\n  const project = new Project({\n    useInMemoryFileSystem: true,\n  })\n\n  const sourceFile = project.createSourceFile(\"component.tsx\", source, {\n    scriptKind: ScriptKind.TSX,\n    overwrite: true,\n  })\n\n  applyCleanup(sourceFile)\n\n  return sourceFile.getText()\n}\n","import { Transformer } from \"@/src/utils/transformers\"\nimport { SyntaxKind } from \"ts-morph\"\n\nimport {\n  TailwindVersion,\n  getProjectTailwindVersionFromConfig,\n} from \"../get-project-info\"\nimport { splitClassName } from \"./transform-css-vars\"\n\nexport const transformTwPrefixes: Transformer = async ({\n  sourceFile,\n  config,\n}) => {\n  if (!config.tailwind?.prefix) {\n    return sourceFile\n  }\n  const tailwindVersion = await getProjectTailwindVersionFromConfig(config)\n\n  // Find the cva function calls.\n  sourceFile\n    .getDescendantsOfKind(SyntaxKind.CallExpression)\n    .filter((node) => node.getExpression().getText() === \"cva\")\n    .forEach((node) => {\n      // cva(base, ...)\n      if (node.getArguments()[0]?.isKind(SyntaxKind.StringLiteral)) {\n        const defaultClassNames = node.getArguments()[0]\n        if (defaultClassNames) {\n          defaultClassNames.replaceWithText(\n            `\"${applyPrefix(\n              defaultClassNames.getText()?.replace(/\"|'/g, \"\"),\n              config.tailwind.prefix,\n              tailwindVersion\n            )}\"`\n          )\n        }\n      }\n\n      // cva(..., { variants: { ... } })\n      if (node.getArguments()[1]?.isKind(SyntaxKind.ObjectLiteralExpression)) {\n        node\n          .getArguments()[1]\n          ?.getDescendantsOfKind(SyntaxKind.PropertyAssignment)\n          .find((node) => node.getName() === \"variants\")\n          ?.getDescendantsOfKind(SyntaxKind.PropertyAssignment)\n          .forEach((node) => {\n            node\n              .getDescendantsOfKind(SyntaxKind.PropertyAssignment)\n              .forEach((node) => {\n                const classNames = node.getInitializerIfKind(\n                  SyntaxKind.StringLiteral\n                )\n                if (classNames) {\n                  classNames?.replaceWithText(\n                    `\"${applyPrefix(\n                      classNames.getText()?.replace(/\"|'/g, \"\"),\n                      config.tailwind.prefix,\n                      tailwindVersion\n                    )}\"`\n                  )\n                }\n              })\n          })\n      }\n    })\n\n  // Find all jsx attributes with the name className.\n  sourceFile.getDescendantsOfKind(SyntaxKind.JsxAttribute).forEach((node) => {\n    if (node.getNameNode().getText() === \"className\") {\n      // className=\"...\"\n      if (node.getInitializer()?.isKind(SyntaxKind.StringLiteral)) {\n        const value = node.getInitializer()\n        if (value) {\n          value.replaceWithText(\n            `\"${applyPrefix(\n              value.getText()?.replace(/\"|'/g, \"\"),\n              config.tailwind.prefix,\n              tailwindVersion\n            )}\"`\n          )\n        }\n      }\n\n      // className={...}\n      if (node.getInitializer()?.isKind(SyntaxKind.JsxExpression)) {\n        // Check if it's a call to cn().\n        const callExpression = node\n          .getInitializer()\n          ?.getDescendantsOfKind(SyntaxKind.CallExpression)\n          .find((node) => node.getExpression().getText() === \"cn\")\n        if (callExpression) {\n          // Loop through the arguments.\n          callExpression.getArguments().forEach((node) => {\n            if (\n              node.isKind(SyntaxKind.ConditionalExpression) ||\n              node.isKind(SyntaxKind.BinaryExpression)\n            ) {\n              node\n                .getChildrenOfKind(SyntaxKind.StringLiteral)\n                .forEach((node) => {\n                  node.replaceWithText(\n                    `\"${applyPrefix(\n                      node.getText()?.replace(/\"|'/g, \"\"),\n                      config.tailwind.prefix,\n                      tailwindVersion\n                    )}\"`\n                  )\n                })\n            }\n\n            if (node.isKind(SyntaxKind.StringLiteral)) {\n              node.replaceWithText(\n                `\"${applyPrefix(\n                  node.getText()?.replace(/\"|'/g, \"\"),\n                  config.tailwind.prefix,\n                  tailwindVersion\n                )}\"`\n              )\n            }\n          })\n        }\n      }\n    }\n\n    // classNames={...}\n    if (node.getNameNode().getText() === \"classNames\") {\n      if (node.getInitializer()?.isKind(SyntaxKind.JsxExpression)) {\n        node\n          .getDescendantsOfKind(SyntaxKind.PropertyAssignment)\n          .forEach((node) => {\n            if (node.getInitializer()?.isKind(SyntaxKind.CallExpression)) {\n              const callExpression = node.getInitializerIfKind(\n                SyntaxKind.CallExpression\n              )\n              if (callExpression) {\n                // Loop through the arguments.\n                callExpression.getArguments().forEach((arg) => {\n                  if (arg.isKind(SyntaxKind.ConditionalExpression)) {\n                    arg\n                      .getChildrenOfKind(SyntaxKind.StringLiteral)\n                      .forEach((node) => {\n                        node.replaceWithText(\n                          `\"${applyPrefix(\n                            node.getText()?.replace(/\"|'/g, \"\"),\n                            config.tailwind.prefix,\n                            tailwindVersion\n                          )}\"`\n                        )\n                      })\n                  }\n\n                  if (arg.isKind(SyntaxKind.StringLiteral)) {\n                    arg.replaceWithText(\n                      `\"${applyPrefix(\n                        arg.getText()?.replace(/\"|'/g, \"\"),\n                        config.tailwind.prefix,\n                        tailwindVersion\n                      )}\"`\n                    )\n                  }\n                })\n              }\n            }\n\n            if (node.getInitializer()?.isKind(SyntaxKind.StringLiteral)) {\n              if (node.getNameNode().getText() !== \"variant\") {\n                const classNames = node.getInitializer()\n                if (classNames) {\n                  classNames.replaceWithText(\n                    `\"${applyPrefix(\n                      classNames.getText()?.replace(/\"|'/g, \"\"),\n                      config.tailwind.prefix,\n                      tailwindVersion\n                    )}\"`\n                  )\n                }\n              }\n            }\n          })\n      }\n    }\n  })\n\n  return sourceFile\n}\n\nexport function applyPrefix(\n  input: string,\n  prefix: string = \"\",\n  tailwindVersion: TailwindVersion\n) {\n  if (tailwindVersion === \"v3\") {\n    return input\n      .split(\" \")\n      .map((className) => {\n        const [variant, value, modifier] = splitClassName(className)\n        if (variant) {\n          return modifier\n            ? `${variant}:${prefix}${value}/${modifier}`\n            : `${variant}:${prefix}${value}`\n        } else {\n          return modifier\n            ? `${prefix}${value}/${modifier}`\n            : `${prefix}${value}`\n        }\n      })\n      .join(\" \")\n  }\n\n  return input\n    .split(\" \")\n    .map((className) =>\n      className.indexOf(`${prefix}:`) === 0\n        ? className\n        : `${prefix}:${className.trim()}`\n    )\n    .join(\" \")\n}\n\nexport function applyPrefixesCss(\n  css: string,\n  prefix: string,\n  tailwindVersion: TailwindVersion\n) {\n  const lines = css.split(\"\\n\")\n  for (let line of lines) {\n    if (line.includes(\"@apply\")) {\n      const originalTWCls = line.replace(\"@apply\", \"\").trim()\n      const prefixedTwCls = applyPrefix(originalTWCls, prefix, tailwindVersion)\n      css = css.replace(originalTWCls, prefixedTwCls)\n    }\n  }\n  return css\n}\n","import { promises as fs } from \"fs\"\nimport { tmpdir } from \"os\"\nimport path from \"path\"\nimport { registryBaseColorSchema } from \"@/src/schema\"\nimport { Config } from \"@/src/utils/get-config\"\nimport { transformCssVars } from \"@/src/utils/transformers/transform-css-vars\"\nimport { transformIcons } from \"@/src/utils/transformers/transform-icons\"\nimport { transformImport } from \"@/src/utils/transformers/transform-import\"\nimport { transformJsx } from \"@/src/utils/transformers/transform-jsx\"\nimport { transformRsc } from \"@/src/utils/transformers/transform-rsc\"\nimport { Project, ScriptKind, type SourceFile } from \"ts-morph\"\nimport { z } from \"zod\"\n\nimport { transformCleanup } from \"./transform-cleanup\"\nimport { transformRtl } from \"./transform-rtl\"\nimport { transformTwPrefixes } from \"./transform-tw-prefix\"\n\nexport type TransformOpts = {\n  filename: string\n  raw: string\n  config: Config\n  baseColor?: z.infer<typeof registryBaseColorSchema>\n  transformJsx?: boolean\n  isRemote?: boolean\n}\n\nexport type Transformer<Output = SourceFile> = (\n  opts: TransformOpts & {\n    sourceFile: SourceFile\n  }\n) => Promise<Output>\n\nconst project = new Project({\n  compilerOptions: {},\n})\n\nasync function createTempSourceFile(filename: string) {\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"shadcn-\"))\n  return path.join(dir, filename)\n}\n\nexport async function transform(\n  opts: TransformOpts,\n  transformers: Transformer[] = [\n    transformImport,\n    transformRsc,\n    transformCssVars,\n    transformTwPrefixes,\n    transformRtl,\n    transformIcons,\n    transformCleanup,\n  ]\n) {\n  const tempFile = await createTempSourceFile(opts.filename)\n  const sourceFile = project.createSourceFile(tempFile, opts.raw, {\n    scriptKind: ScriptKind.TSX,\n  })\n\n  for (const transformer of transformers) {\n    await transformer({ sourceFile, ...opts })\n  }\n\n  if (opts.transformJsx) {\n    return await transformJsx({\n      sourceFile,\n      ...opts,\n    })\n  }\n\n  return sourceFile.getText()\n}\n","import { Transformer } from \"@/src/utils/transformers\"\nimport { JsxElement, SyntaxKind } from \"ts-morph\"\n\n// Elements that require nativeButton={false} when used as render prop.\n// These are non-button elements that don't have native button semantics.\nconst ELEMENTS_REQUIRING_NATIVE_BUTTON_FALSE = [\n  \"a\",\n  \"span\",\n  \"div\",\n  \"Link\",\n  \"label\",\n  \"Label\",\n]\n\ninterface TransformInfo {\n  parentElement: JsxElement\n  parentTagName: string\n  childTagName: string\n  childProps: string\n  childChildren: string\n  needsNativeButton: boolean\n}\n\nexport const transformAsChild: Transformer = async ({ sourceFile, config }) => {\n  // Only run for base- styles.\n  if (!config.style?.startsWith(\"base-\")) {\n    return sourceFile\n  }\n\n  // Process asChild elements iteratively, starting from leaf-level elements.\n  // Each iteration transforms only elements with no asChild descendants,\n  // ensuring inner transforms complete before outer ones read the tree.\n  const MAX_ITERATIONS = 10\n  for (let i = 0; i < MAX_ITERATIONS; i++) {\n    const jsxElements = sourceFile.getDescendantsOfKind(SyntaxKind.JsxElement)\n\n    // Find all JSX elements with asChild attribute.\n    const asChildElements = jsxElements.filter((el) =>\n      el.getOpeningElement().getAttribute(\"asChild\")\n    )\n\n    if (asChildElements.length === 0) {\n      break\n    }\n\n    // Filter to leaf-only: elements with no asChild descendants.\n    const leafElements = asChildElements.filter((el) => {\n      const descendants = el.getDescendantsOfKind(SyntaxKind.JsxElement)\n      return !descendants.some((d) =>\n        d.getOpeningElement().getAttribute(\"asChild\")\n      )\n    })\n\n    // Collect all transformations first, then apply them in reverse order.\n    // This prevents issues with invalidated nodes when modifying the tree.\n    const transformations: TransformInfo[] = []\n\n    for (const jsxElement of leafElements) {\n      const openingElement = jsxElement.getOpeningElement()\n      const asChildAttr = openingElement.getAttribute(\"asChild\")\n\n      if (!asChildAttr) {\n        continue\n      }\n\n      const parentTagName = openingElement.getTagNameNode().getText()\n      const children = jsxElement.getJsxChildren()\n\n      // Find the first JSX element child (skip whitespace/text).\n      const childElement = children.find(\n        (child) =>\n          child.getKind() === SyntaxKind.JsxElement ||\n          child.getKind() === SyntaxKind.JsxSelfClosingElement\n      )\n\n      if (!childElement) {\n        // No child element found, just remove asChild.\n        asChildAttr.remove()\n        continue\n      }\n\n      // Get child element info.\n      let childTagName: string\n      let childProps: string\n      let childChildren: string\n\n      if (childElement.getKind() === SyntaxKind.JsxSelfClosingElement) {\n        const selfClosing = childElement.asKindOrThrow(\n          SyntaxKind.JsxSelfClosingElement\n        )\n        childTagName = selfClosing.getTagNameNode().getText()\n        childProps = selfClosing\n          .getAttributes()\n          .map((attr) => attr.getText())\n          .join(\" \")\n        childChildren = \"\"\n      } else {\n        const jsxChild = childElement.asKindOrThrow(SyntaxKind.JsxElement)\n        const openingEl = jsxChild.getOpeningElement()\n        childTagName = openingEl.getTagNameNode().getText()\n        childProps = openingEl\n          .getAttributes()\n          .map((attr) => attr.getText())\n          .join(\" \")\n        // Get the children's text content.\n        childChildren = jsxChild\n          .getJsxChildren()\n          .map((c) => c.getText())\n          .join(\"\")\n      }\n\n      // Determine if we need nativeButton={false}.\n      // Only add it on Button when the child is a non-button element.\n      const needsNativeButton =\n        parentTagName === \"Button\" &&\n        ELEMENTS_REQUIRING_NATIVE_BUTTON_FALSE.includes(childTagName)\n\n      transformations.push({\n        parentElement: jsxElement,\n        parentTagName,\n        childTagName,\n        childProps,\n        childChildren,\n        needsNativeButton,\n      })\n    }\n\n    // Apply transformations in reverse order to preserve node validity.\n    for (const info of transformations.reverse()) {\n      const openingElement = info.parentElement.getOpeningElement()\n\n      // Get existing attributes (excluding asChild).\n      const existingAttrs = openingElement\n        .getAttributes()\n        .filter((attr) => {\n          if (attr.getKind() === SyntaxKind.JsxAttribute) {\n            const jsxAttr = attr.asKindOrThrow(SyntaxKind.JsxAttribute)\n            return jsxAttr.getNameNode().getText() !== \"asChild\"\n          }\n          return true\n        })\n        .map((attr) => attr.getText())\n        .join(\" \")\n\n      // Build the render prop value.\n      const renderValue = info.childProps\n        ? `{<${info.childTagName} ${info.childProps} />}`\n        : `{<${info.childTagName} />}`\n\n      // Build new attributes.\n      let newAttrs = existingAttrs ? `${existingAttrs} ` : \"\"\n      newAttrs += `render=${renderValue}`\n      if (info.needsNativeButton) {\n        newAttrs += ` nativeButton={false}`\n      }\n\n      // Build the new element text.\n      const newChildren = info.childChildren.trim()\n        ? `${info.childChildren}`\n        : \"\"\n\n      const newElementText = `<${info.parentTagName} ${newAttrs}>${newChildren}</${info.parentTagName}>`\n\n      info.parentElement.replaceWithText(newElementText)\n    }\n  }\n\n  return sourceFile\n}\n","import { Transformer } from \"@/src/utils/transformers\"\n\nexport const transformNext: Transformer = async ({ sourceFile }) => {\n  // export function middleware.\n  sourceFile.getFunctions().forEach((func) => {\n    if (func.getName() === \"middleware\") {\n      func.rename(\"proxy\")\n    }\n  })\n\n  // export const middleware.\n  sourceFile.getVariableDeclarations().forEach((variable) => {\n    if (variable.getName() === \"middleware\") {\n      variable.rename(\"proxy\")\n    }\n  })\n\n  // export { handler as middleware }.\n  sourceFile.getExportDeclarations().forEach((exportDecl) => {\n    const namedExports = exportDecl.getNamedExports()\n    namedExports.forEach((namedExport) => {\n      if (namedExport.getName() === \"middleware\") {\n        namedExport.setName(\"proxy\")\n      }\n      const aliasNode = namedExport.getAliasNode()\n      if (aliasNode?.getText() === \"middleware\") {\n        namedExport.setAlias(\"proxy\")\n      }\n    })\n  })\n\n  return sourceFile\n}\n","import { existsSync, promises as fs, statSync } from \"fs\"\nimport { tmpdir } from \"os\"\nimport path, { basename } from \"path\"\nimport { getRegistryBaseColor } from \"@/src/registry/api\"\nimport { RegistryItem, registryItemFileSchema } from \"@/src/schema\"\nimport { isContentSame } from \"@/src/utils/compare\"\nimport {\n  findExistingEnvFile,\n  getNewEnvKeys,\n  isEnvFile,\n  mergeEnvContent,\n  parseEnvContent,\n} from \"@/src/utils/env-helpers\"\nimport { Config } from \"@/src/utils/get-config\"\nimport { ProjectInfo, getProjectInfo } from \"@/src/utils/get-project-info\"\nimport { highlighter } from \"@/src/utils/highlighter\"\nimport { logger } from \"@/src/utils/logger\"\nimport { resolveImport } from \"@/src/utils/resolve-import\"\nimport { spinner } from \"@/src/utils/spinner\"\nimport { transform } from \"@/src/utils/transformers\"\nimport { transformAsChild } from \"@/src/utils/transformers/transform-aschild\"\nimport { transformCleanup } from \"@/src/utils/transformers/transform-cleanup\"\nimport { transformCssVars } from \"@/src/utils/transformers/transform-css-vars\"\nimport { transformIcons } from \"@/src/utils/transformers/transform-icons\"\nimport { transformImport } from \"@/src/utils/transformers/transform-import\"\nimport { transformMenu } from \"@/src/utils/transformers/transform-menu\"\nimport { transformNext } from \"@/src/utils/transformers/transform-next\"\nimport { transformRsc } from \"@/src/utils/transformers/transform-rsc\"\nimport { transformRtl } from \"@/src/utils/transformers/transform-rtl\"\nimport { transformTwPrefixes } from \"@/src/utils/transformers/transform-tw-prefix\"\nimport prompts from \"prompts\"\nimport { Project, ScriptKind } from \"ts-morph\"\nimport { loadConfig } from \"tsconfig-paths\"\nimport { z } from \"zod\"\n\nexport async function updateFiles(\n  files: RegistryItem[\"files\"],\n  config: Config,\n  options: {\n    overwrite?: boolean\n    force?: boolean\n    silent?: boolean\n    rootSpinner?: ReturnType<typeof spinner>\n    isRemote?: boolean\n    isWorkspace?: boolean\n    path?: string\n  }\n) {\n  if (!files?.length) {\n    return {\n      filesCreated: [],\n      filesUpdated: [],\n      filesSkipped: [],\n    }\n  }\n  options = {\n    overwrite: false,\n    force: false,\n    silent: false,\n    isRemote: false,\n    isWorkspace: false,\n    ...options,\n  }\n  const filesCreatedSpinner = spinner(`Updating files.`, {\n    silent: options.silent,\n  })?.start()\n\n  const [projectInfo, baseColor] = await Promise.all([\n    getProjectInfo(config.resolvedPaths.cwd),\n    config.tailwind.baseColor\n      ? getRegistryBaseColor(config.tailwind.baseColor)\n      : Promise.resolve(undefined),\n  ])\n\n  let filesCreated: string[] = []\n  let filesUpdated: string[] = []\n  let filesSkipped: string[] = []\n  let envVarsAdded: string[] = []\n  let envFile: string | null = null\n\n  for (let index = 0; index < files.length; index++) {\n    const file = files[index]\n    if (!file.content) {\n      continue\n    }\n\n    let filePath = resolveFilePath(file, config, {\n      isSrcDir: projectInfo?.isSrcDir,\n      framework: projectInfo?.framework.name,\n      commonRoot: findCommonRoot(\n        files.map((f) => f.path),\n        file.path\n      ),\n      path: options.path,\n      fileIndex: index,\n    })\n\n    if (!filePath) {\n      continue\n    }\n\n    const fileName = basename(file.path)\n    const targetDir = path.dirname(filePath)\n\n    if (!config.tsx) {\n      filePath = filePath.replace(/\\.tsx?$/, (match) =>\n        match === \".tsx\" ? \".jsx\" : \".js\"\n      )\n    }\n\n    if (isEnvFile(filePath) && !existsSync(filePath)) {\n      const alternativeEnvFile = findExistingEnvFile(targetDir)\n      if (alternativeEnvFile) {\n        filePath = alternativeEnvFile\n      }\n    }\n\n    const existingFile = existsSync(filePath)\n\n    // Check if the path exists and is a directory - we can't write to directories.\n    if (existingFile && statSync(filePath).isDirectory()) {\n      throw new Error(\n        `Cannot write to ${filePath}: path exists and is a directory. Please provide a file path instead.`\n      )\n    }\n\n    // Run our transformers.\n    // Skip transformers for .env files to preserve exact content\n    // Skip transformers for universal item files (registry:file and registry:item)\n    // to preserve their original content as they're meant to be framework-agnostic\n    const isUniversalItemFile =\n      file.type === \"registry:file\" || file.type === \"registry:item\"\n    const content =\n      isEnvFile(filePath) || isUniversalItemFile\n        ? file.content\n        : await transform(\n            {\n              filename: file.path,\n              raw: file.content,\n              config,\n              baseColor,\n              transformJsx: !config.tsx,\n              isRemote: options.isRemote,\n            },\n            [\n              transformImport,\n              transformRsc,\n              transformCssVars,\n              transformTwPrefixes,\n              transformIcons,\n              transformMenu,\n              transformAsChild,\n              transformRtl,\n              ...(_isNext16Middleware(filePath, projectInfo, config)\n                ? [transformNext]\n                : []),\n              transformCleanup,\n            ]\n          )\n\n    // Skip the file if it already exists and the content is the same.\n    // Exception: Don't skip .env files as we merge content instead of replacing\n    if (existingFile && !isEnvFile(filePath)) {\n      const existingFileContent = await fs.readFile(filePath, \"utf-8\")\n\n      if (\n        isContentSame(existingFileContent, content, {\n          // Ignore import differences for workspace components.\n          // TODO: figure out if we always want this.\n          ignoreImports: options.isWorkspace,\n        })\n      ) {\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\n        continue\n      }\n    }\n\n    // Skip overwrite prompt for .env files - we'll handle them specially\n    if (existingFile && !options.overwrite && !isEnvFile(filePath)) {\n      filesCreatedSpinner.stop()\n      if (options.rootSpinner) {\n        options.rootSpinner.stop()\n      }\n      const { overwrite } = await prompts({\n        type: \"confirm\",\n        name: \"overwrite\",\n        message: `The file ${highlighter.info(\n          fileName\n        )} already exists. Would you like to overwrite?`,\n        initial: false,\n      })\n\n      if (!overwrite) {\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\n        if (options.rootSpinner) {\n          options.rootSpinner.start()\n        }\n        continue\n      }\n      filesCreatedSpinner?.start()\n      if (options.rootSpinner) {\n        options.rootSpinner.start()\n      }\n    }\n\n    // Rename middleware.ts to proxy.ts for Next.js 16+.\n    if (_isNext16Middleware(filePath, projectInfo, config)) {\n      filePath = filePath.replace(/middleware\\.(ts|js)$/, \"proxy.$1\")\n    }\n\n    // Create the target directory if it doesn't exist.\n    if (!existsSync(targetDir)) {\n      await fs.mkdir(targetDir, { recursive: true })\n    }\n\n    // Special handling for .env files - append only new keys\n    if (isEnvFile(filePath) && existingFile) {\n      const existingFileContent = await fs.readFile(filePath, \"utf-8\")\n      const mergedContent = mergeEnvContent(existingFileContent, content)\n      envVarsAdded = getNewEnvKeys(existingFileContent, content)\n      envFile = path.relative(config.resolvedPaths.cwd, filePath)\n\n      if (!envVarsAdded.length) {\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\n        continue\n      }\n\n      await fs.writeFile(filePath, mergedContent, \"utf-8\")\n      filesUpdated.push(path.relative(config.resolvedPaths.cwd, filePath))\n      continue\n    }\n\n    await fs.writeFile(filePath, content, \"utf-8\")\n\n    // Handle file creation logging\n    if (!existingFile) {\n      filesCreated.push(path.relative(config.resolvedPaths.cwd, filePath))\n\n      if (isEnvFile(filePath)) {\n        envVarsAdded = Object.keys(parseEnvContent(content))\n        envFile = path.relative(config.resolvedPaths.cwd, filePath)\n      }\n    } else {\n      filesUpdated.push(path.relative(config.resolvedPaths.cwd, filePath))\n    }\n  }\n\n  const allFiles = [...filesCreated, ...filesUpdated, ...filesSkipped]\n  const updatedFiles = await resolveImports(allFiles, config)\n\n  // Let's update filesUpdated with the updated files.\n  filesUpdated.push(...updatedFiles)\n\n  // If a file is in filesCreated and filesUpdated, we should remove it from filesUpdated.\n  filesUpdated = filesUpdated.filter((file) => !filesCreated.includes(file))\n\n  const hasUpdatedFiles = filesCreated.length || filesUpdated.length\n  if (!hasUpdatedFiles && !filesSkipped.length) {\n    filesCreatedSpinner?.info(\"No files updated.\")\n  }\n\n  // Remove duplicates.\n  filesCreated = Array.from(new Set(filesCreated))\n  filesUpdated = Array.from(new Set(filesUpdated))\n  filesSkipped = Array.from(new Set(filesSkipped))\n\n  if (filesCreated.length) {\n    filesCreatedSpinner?.succeed(\n      `Created ${filesCreated.length} ${\n        filesCreated.length === 1 ? \"file\" : \"files\"\n      }:`\n    )\n    if (!options.silent) {\n      for (const file of filesCreated) {\n        logger.log(`  - ${file}`)\n      }\n    }\n  } else {\n    filesCreatedSpinner?.stop()\n  }\n\n  if (filesUpdated.length) {\n    spinner(\n      `Updated ${filesUpdated.length} ${\n        filesUpdated.length === 1 ? \"file\" : \"files\"\n      }:`,\n      {\n        silent: options.silent,\n      }\n    )?.info()\n    if (!options.silent) {\n      for (const file of filesUpdated) {\n        logger.log(`  - ${file}`)\n      }\n    }\n  }\n\n  if (filesSkipped.length) {\n    spinner(\n      `Skipped ${filesSkipped.length} ${\n        filesUpdated.length === 1 ? \"file\" : \"files\"\n      }: (files might be identical, use --overwrite to overwrite)`,\n      {\n        silent: options.silent,\n      }\n    )?.info()\n    if (!options.silent) {\n      for (const file of filesSkipped) {\n        logger.log(`  - ${file}`)\n      }\n    }\n  }\n\n  if (envVarsAdded.length && envFile) {\n    spinner(\n      `Added the following variables to ${highlighter.info(envFile)}:`\n    )?.info()\n    if (!options.silent) {\n      for (const key of envVarsAdded) {\n        logger.log(`  ${highlighter.success(\"+\")} ${key}`)\n      }\n    }\n  }\n\n  if (!options.silent) {\n    logger.break()\n  }\n\n  return {\n    filesCreated,\n    filesUpdated,\n    filesSkipped,\n  }\n}\n\nexport function resolveFilePath(\n  file: z.infer<typeof registryItemFileSchema>,\n  config: Config,\n  options: {\n    isSrcDir?: boolean\n    commonRoot?: string\n    framework?: ProjectInfo[\"framework\"][\"name\"]\n    path?: string\n    fileIndex?: number\n  }\n) {\n  // Handle custom path if provided.\n  if (options.path) {\n    const resolvedPath = path.isAbsolute(options.path)\n      ? options.path\n      : path.join(config.resolvedPaths.cwd, options.path)\n\n    const isFilePath = /\\.[^/\\\\]+$/.test(resolvedPath)\n\n    if (isFilePath) {\n      // We'll only use the custom path for the first file.\n      // This is for registry items with multiple files.\n      if (options.fileIndex === 0) {\n        return resolvedPath\n      }\n    } else {\n      // If the custom path is a directory,\n      // We'll place all files in the directory.\n      const fileName = path.basename(file.path)\n      return path.join(resolvedPath, fileName)\n    }\n  }\n\n  if (file.target) {\n    if (file.target.startsWith(\"~/\")) {\n      return path.join(config.resolvedPaths.cwd, file.target.replace(\"~/\", \"\"))\n    }\n\n    let target = file.target\n\n    if (file.type === \"registry:page\") {\n      target = resolvePageTarget(target, options.framework)\n      if (!target) {\n        return \"\"\n      }\n    }\n\n    return options.isSrcDir\n      ? path.join(config.resolvedPaths.cwd, \"src\", target.replace(\"src/\", \"\"))\n      : path.join(config.resolvedPaths.cwd, target.replace(\"src/\", \"\"))\n  }\n\n  const targetDir = resolveFileTargetDirectory(file, config)\n\n  const relativePath = resolveNestedFilePath(file.path, targetDir)\n  return path.join(targetDir, relativePath)\n}\n\nfunction resolveFileTargetDirectory(\n  file: z.infer<typeof registryItemFileSchema>,\n  config: Config\n) {\n  if (file.type === \"registry:ui\") {\n    return config.resolvedPaths.ui\n  }\n\n  if (file.type === \"registry:lib\") {\n    return config.resolvedPaths.lib\n  }\n\n  if (file.type === \"registry:block\" || file.type === \"registry:component\") {\n    return config.resolvedPaths.components\n  }\n\n  if (file.type === \"registry:hook\") {\n    return config.resolvedPaths.hooks\n  }\n\n  return config.resolvedPaths.components\n}\n\nexport function findCommonRoot(paths: string[], needle: string): string {\n  // Remove leading slashes for consistent handling\n  const normalizedPaths = paths.map((p) => p.replace(/^\\//, \"\"))\n  const normalizedNeedle = needle.replace(/^\\//, \"\")\n\n  // Get the directory path of the needle by removing the file name\n  const needleDir = normalizedNeedle.split(\"/\").slice(0, -1).join(\"/\")\n\n  // If needle is at root level, return empty string\n  if (!needleDir) {\n    return \"\"\n  }\n\n  // Split the needle directory into segments\n  const needleSegments = needleDir.split(\"/\")\n\n  // Start from the full path and work backwards\n  for (let i = needleSegments.length; i > 0; i--) {\n    const testPath = needleSegments.slice(0, i).join(\"/\")\n    // Check if this is a common root by verifying if any other paths start with it\n    const hasRelatedPaths = normalizedPaths.some(\n      (path) => path !== normalizedNeedle && path.startsWith(testPath + \"/\")\n    )\n    if (hasRelatedPaths) {\n      return \"/\" + testPath // Add leading slash back for the result\n    }\n  }\n\n  // If no common root found with other files, return the parent directory of the needle\n  return \"/\" + needleDir // Add leading slash back for the result\n}\n\nexport function resolveNestedFilePath(\n  filePath: string,\n  targetDir: string\n): string {\n  // Normalize paths by removing leading/trailing slashes\n  const normalizedFilePath = filePath.replace(/^\\/|\\/$/g, \"\")\n  const normalizedTargetDir = targetDir.replace(/^\\/|\\/$/g, \"\")\n\n  // Split paths into segments\n  const fileSegments = normalizedFilePath.split(\"/\")\n  const targetSegments = normalizedTargetDir.split(\"/\")\n\n  // Find the last matching segment from targetDir in filePath\n  const lastTargetSegment = targetSegments[targetSegments.length - 1]\n  const commonDirIndex = fileSegments.findIndex(\n    (segment) => segment === lastTargetSegment\n  )\n\n  if (commonDirIndex === -1) {\n    // Return just the filename if no common directory is found\n    return fileSegments[fileSegments.length - 1]\n  }\n\n  // Return everything after the common directory\n  return fileSegments.slice(commonDirIndex + 1).join(\"/\")\n}\n\nexport function resolvePageTarget(\n  target: string,\n  framework?: ProjectInfo[\"framework\"][\"name\"]\n) {\n  if (!framework) {\n    return \"\"\n  }\n\n  if (framework === \"next-app\") {\n    return target\n  }\n\n  if (framework === \"next-pages\") {\n    let result = target.replace(/^app\\//, \"pages/\")\n    result = result.replace(/\\/page(\\.[jt]sx?)$/, \"$1\")\n\n    return result\n  }\n\n  if (framework === \"react-router\") {\n    let result = target.replace(/^app\\//, \"app/routes/\")\n    result = result.replace(/\\/page(\\.[jt]sx?)$/, \"$1\")\n\n    return result\n  }\n\n  if (framework === \"laravel\") {\n    let result = target.replace(/^app\\//, \"resources/js/pages/\")\n    result = result.replace(/\\/page(\\.[jt]sx?)$/, \"$1\")\n\n    return result\n  }\n\n  return \"\"\n}\n\nasync function resolveImports(filePaths: string[], config: Config) {\n  const project = new Project({\n    compilerOptions: {},\n  })\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\n  const tsConfig = loadConfig(config.resolvedPaths.cwd)\n  const updatedFiles = []\n\n  if (!projectInfo || tsConfig.resultType === \"failed\") {\n    return []\n  }\n\n  for (const filepath of filePaths) {\n    const resolvedPath = path.resolve(config.resolvedPaths.cwd, filepath)\n\n    // Check if the file exists.\n    if (!existsSync(resolvedPath)) {\n      continue\n    }\n\n    const content = await fs.readFile(resolvedPath, \"utf-8\")\n\n    const dir = await fs.mkdtemp(path.join(tmpdir(), \"shadcn-\"))\n    const sourceFile = project.createSourceFile(\n      path.join(dir, basename(resolvedPath)),\n      content,\n      {\n        scriptKind: ScriptKind.TSX,\n      }\n    )\n\n    // Skip if the file extension is not one of the supported extensions.\n    if (![\".tsx\", \".ts\", \".jsx\", \".js\"].includes(sourceFile.getExtension())) {\n      continue\n    }\n\n    const importDeclarations = sourceFile.getImportDeclarations()\n    for (const importDeclaration of importDeclarations) {\n      const moduleSpecifier = importDeclaration.getModuleSpecifierValue()\n\n      // Filter out non-local imports.\n      if (\n        projectInfo?.aliasPrefix &&\n        !moduleSpecifier.startsWith(`${projectInfo.aliasPrefix}/`)\n      ) {\n        continue\n      }\n\n      // Find the probable import file path.\n      // This is where we expect to find the file on disk.\n      const probableImportFilePath = await resolveImport(\n        moduleSpecifier,\n        tsConfig\n      )\n\n      if (!probableImportFilePath) {\n        continue\n      }\n\n      // Find the actual import file path.\n      // This is the path where the file has been installed.\n      const resolvedImportFilePath = resolveModuleByProbablePath(\n        probableImportFilePath,\n        filePaths,\n        config\n      )\n\n      if (!resolvedImportFilePath) {\n        continue\n      }\n\n      // Convert the resolved import file path to an aliased import.\n      const newImport = toAliasedImport(\n        resolvedImportFilePath,\n        config,\n        projectInfo\n      )\n\n      if (!newImport || newImport === moduleSpecifier) {\n        continue\n      }\n\n      importDeclaration.setModuleSpecifier(newImport)\n\n      // Write the updated content to the file.\n      await fs.writeFile(resolvedPath, sourceFile.getFullText(), \"utf-8\")\n\n      // Track the updated file.\n      updatedFiles.push(filepath)\n    }\n  }\n\n  return updatedFiles\n}\n\n/**\n * Given an absolute \"probable\" import path (no ext),\n * plus an array of absolute file paths you already know about,\n * return 0N matches (best match first), and also check disk for any missing ones.\n */\nexport function resolveModuleByProbablePath(\n  probableImportFilePath: string,\n  files: string[],\n  config: Config,\n  extensions: string[] = [\".tsx\", \".ts\", \".js\", \".jsx\", \".css\"]\n) {\n  const cwd = path.normalize(config.resolvedPaths.cwd)\n\n  // 1) Build a set of POSIX-normalized, project-relative files\n  const relativeFiles = files.map((f) => f.split(path.sep).join(path.posix.sep))\n  const fileSet = new Set(relativeFiles)\n\n  // 2) Strip any existing extension off the absolute base path\n  const extInPath = path.extname(probableImportFilePath)\n  const hasExt = extInPath !== \"\"\n  const absBase = hasExt\n    ? probableImportFilePath.slice(0, -extInPath.length)\n    : probableImportFilePath\n\n  // 3) Compute the project-relative \"base\" directory for strong matching\n  const relBaseRaw = path.relative(cwd, absBase)\n  const relBase = relBaseRaw.split(path.sep).join(path.posix.sep)\n\n  // 4) Decide which extensions to try\n  const tryExts = hasExt ? [extInPath] : extensions\n\n  // 5) Collect candidates\n  const candidates = new Set<string>()\n\n  // 5a) Fastpath: [base + ext] and [base/index + ext]\n  for (const e of tryExts) {\n    const absCand = absBase + e\n    const relCand = path.posix.normalize(path.relative(cwd, absCand))\n    if (fileSet.has(relCand) || existsSync(absCand)) {\n      candidates.add(relCand)\n    }\n\n    const absIdx = path.join(absBase, `index${e}`)\n    const relIdx = path.posix.normalize(path.relative(cwd, absIdx))\n    if (fileSet.has(relIdx) || existsSync(absIdx)) {\n      candidates.add(relIdx)\n    }\n  }\n\n  // 5b) Fallback: scan known files by basename\n  const name = path.basename(absBase)\n  for (const f of relativeFiles) {\n    if (tryExts.some((e) => f.endsWith(`/${name}${e}`))) {\n      candidates.add(f)\n    }\n  }\n\n  // 6) If no matches, bail\n  if (candidates.size === 0) return null\n\n  // 7) Sort by (1) extension priority, then (2) \"strong\" base match\n  const sorted = Array.from(candidates).sort((a, b) => {\n    // a) extension order\n    const aExt = path.posix.extname(a)\n    const bExt = path.posix.extname(b)\n    const ord = tryExts.indexOf(aExt) - tryExts.indexOf(bExt)\n    if (ord !== 0) return ord\n    // b) strong match if path starts with relBase\n    const aStrong = relBase && a.startsWith(relBase) ? -1 : 1\n    const bStrong = relBase && b.startsWith(relBase) ? -1 : 1\n    return aStrong - bStrong\n  })\n\n  // 8) Return the first (best) candidate\n  return sorted[0]\n}\n\nexport function toAliasedImport(\n  filePath: string,\n  config: Config,\n  projectInfo: ProjectInfo\n): string | null {\n  const abs = path.normalize(path.join(config.resolvedPaths.cwd, filePath))\n\n  // 1 Find the longest matching alias root in resolvedPaths\n  //    e.g. key=\"ui\", root=\"//components/ui\" beats key=\"components\"\n  const matches = Object.entries(config.resolvedPaths)\n    .filter(\n      ([, root]) => root && abs.startsWith(path.normalize(root + path.sep))\n    )\n    .sort((a, b) => b[1].length - a[1].length)\n\n  if (matches.length === 0) {\n    return null\n  }\n  const [aliasKey, rootDir] = matches[0]\n\n  // 2 Compute the path UNDER that root\n  let rel = path.relative(rootDir, abs)\n  // force POSIX-style separators\n  rel = rel.split(path.sep).join(\"/\") // e.g. \"button/index.tsx\"\n\n  // 3 Strip code-file extensions, keep others (css, json, etc.)\n  const ext = path.posix.extname(rel)\n  const codeExts = [\".ts\", \".tsx\", \".js\", \".jsx\"]\n  const keepExt = codeExts.includes(ext) ? \"\" : ext\n  let noExt = rel.slice(0, rel.length - ext.length)\n\n  // 4 Collapse \"/index\" to its directory\n  if (noExt.endsWith(\"/index\")) {\n    noExt = noExt.slice(0, -\"/index\".length)\n  }\n\n  // 5 Build the aliased path\n  //    config.aliases[aliasKey] is e.g. \"@/components/ui\"\n  const aliasBase =\n    aliasKey === \"cwd\"\n      ? projectInfo.aliasPrefix\n      : config.aliases[aliasKey as keyof typeof config.aliases]\n  if (!aliasBase) {\n    return null\n  }\n  // if noExt is empty (i.e. file was exactly at the root), we import the root\n  let suffix = noExt === \"\" ? \"\" : `/${noExt}`\n\n  // Remove /src from suffix.\n  // Alias will handle this.\n  suffix = suffix.replace(\"/src\", \"\")\n\n  // 6 Prepend the prefix from projectInfo (e.g. \"@\") if needed\n  //    but usually config.aliases already include it.\n  return `${aliasBase}${suffix}${keepExt}`\n}\n\nfunction _isNext16Middleware(\n  filePath: string,\n  projectInfo: ProjectInfo | null,\n  config: Config\n) {\n  const isRootMiddleware =\n    filePath === path.join(config.resolvedPaths.cwd, \"middleware.ts\") ||\n    filePath === path.join(config.resolvedPaths.cwd, \"middleware.js\")\n\n  const isNextJs =\n    projectInfo?.framework.name === \"next-app\" ||\n    projectInfo?.framework.name === \"next-pages\"\n\n  if (!isRootMiddleware || !isNextJs || !projectInfo?.frameworkVersion) {\n    return false\n  }\n\n  const majorVersion = parseInt(projectInfo.frameworkVersion.split(\".\")[0])\n  const isNext16Plus = !isNaN(majorVersion) && majorVersion >= 16\n\n  return isNext16Plus\n}\n","import * as fs from \"fs/promises\"\nimport { tmpdir } from \"os\"\nimport * as path from \"path\"\nimport {\n  configSchema,\n  registryItemFileSchema,\n  registryItemSchema,\n} from \"@/src/schema\"\nimport { Config } from \"@/src/utils/get-config\"\nimport { ProjectInfo, getProjectInfo } from \"@/src/utils/get-project-info\"\nimport { resolveImport } from \"@/src/utils/resolve-import\"\nimport {\n  findCommonRoot,\n  resolveFilePath,\n} from \"@/src/utils/updaters/update-files\"\nimport { Project, ScriptKind } from \"ts-morph\"\nimport { loadConfig } from \"tsconfig-paths\"\nimport { z } from \"zod\"\n\nconst FILE_EXTENSIONS_FOR_LOOKUP = [\".tsx\", \".ts\", \".jsx\", \".js\", \".css\"]\nconst FILE_PATH_SKIP_LIST = [\"lib/utils.ts\"]\nconst DEPENDENCY_SKIP_LIST = [\n  /^(react|react-dom|next)(\\/.*)?$/, // Matches react, react-dom, next and their submodules\n  /^(node|jsr|npm):.*$/, // Matches node:, jsr:, and npm: prefixed modules\n]\n\nconst project = new Project({\n  compilerOptions: {},\n})\n\n// This returns the dependency from the module specifier.\n// Here dependency means an npm package.\nexport function getDependencyFromModuleSpecifier(\n  moduleSpecifier: string\n): string | null {\n  // Skip if the dependency matches any pattern in the skip list\n  if (DEPENDENCY_SKIP_LIST.some((pattern) => pattern.test(moduleSpecifier))) {\n    return null\n  }\n\n  // If the module specifier does not start with `@` and has a /, add the dependency first part only.\n  // E.g. `foo/bar` -> `foo`\n  if (!moduleSpecifier.startsWith(\"@\") && moduleSpecifier.includes(\"/\")) {\n    moduleSpecifier = moduleSpecifier.split(\"/\")[0]\n  }\n\n  // For scoped packages, we want to keep the first two parts\n  // E.g. `@types/react/dom` -> `@types/react`\n  if (moduleSpecifier.startsWith(\"@\")) {\n    const parts = moduleSpecifier.split(\"/\")\n    if (parts.length > 2) {\n      moduleSpecifier = parts.slice(0, 2).join(\"/\")\n    }\n  }\n\n  return moduleSpecifier\n}\n\nexport async function recursivelyResolveFileImports(\n  filePath: string,\n  config: z.infer<typeof configSchema>,\n  projectInfo: ProjectInfo,\n  processedFiles: Set<string> = new Set()\n): Promise<Pick<z.infer<typeof registryItemSchema>, \"files\" | \"dependencies\">> {\n  const resolvedFilePath = path.resolve(config.resolvedPaths.cwd, filePath)\n  const relativeRegistryFilePath = path.relative(\n    config.resolvedPaths.cwd,\n    resolvedFilePath\n  )\n\n  // Skip if the file is in the skip list\n  if (FILE_PATH_SKIP_LIST.includes(relativeRegistryFilePath)) {\n    return { dependencies: [], files: [] }\n  }\n\n  // Skip if the file extension is not one of the supported extensions\n  const fileExtension = path.extname(filePath)\n  if (!FILE_EXTENSIONS_FOR_LOOKUP.includes(fileExtension)) {\n    return { dependencies: [], files: [] }\n  }\n\n  // Prevent infinite loop: skip if already processed\n  if (processedFiles.has(relativeRegistryFilePath)) {\n    return { dependencies: [], files: [] }\n  }\n  processedFiles.add(relativeRegistryFilePath)\n\n  const stat = await fs.stat(resolvedFilePath)\n  if (!stat.isFile()) {\n    // Optionally log or handle this case\n    return { dependencies: [], files: [] }\n  }\n\n  const content = await fs.readFile(resolvedFilePath, \"utf-8\")\n  const tempFile = await createTempSourceFile(path.basename(resolvedFilePath))\n  const sourceFile = project.createSourceFile(tempFile, content, {\n    scriptKind: ScriptKind.TSX,\n  })\n  const tsConfig = await loadConfig(config.resolvedPaths.cwd)\n  if (tsConfig.resultType === \"failed\") {\n    return { dependencies: [], files: [] }\n  }\n\n  const files: z.infer<typeof registryItemSchema>[\"files\"] = []\n  const dependencies = new Set<string>()\n\n  // Add the original file first\n  const fileType = determineFileType(filePath)\n  const originalFile = {\n    path: relativeRegistryFilePath,\n    type: fileType,\n    target: \"\",\n  }\n  files.push(originalFile)\n\n  // 1. Find all import statements in the file.\n  const importStatements = sourceFile.getImportDeclarations()\n  for (const importStatement of importStatements) {\n    const moduleSpecifier = importStatement.getModuleSpecifierValue()\n\n    const isRelativeImport = moduleSpecifier.startsWith(\".\")\n    const isAliasImport = moduleSpecifier.startsWith(\n      `${projectInfo.aliasPrefix}/`\n    )\n\n    // If not a local import, add to the dependencies array.\n    if (!isAliasImport && !isRelativeImport) {\n      const dependency = getDependencyFromModuleSpecifier(moduleSpecifier)\n      if (dependency) {\n        dependencies.add(dependency)\n      }\n      continue\n    }\n\n    let probableImportFilePath = await resolveImport(moduleSpecifier, tsConfig)\n\n    if (isRelativeImport) {\n      probableImportFilePath = path.resolve(\n        path.dirname(resolvedFilePath),\n        moduleSpecifier\n      )\n    }\n\n    if (!probableImportFilePath) {\n      continue\n    }\n\n    // Check if the probable import path has a file extension.\n    // Try each extension until we find a file that exists.\n    const hasExtension = path.extname(probableImportFilePath)\n    if (!hasExtension) {\n      for (const ext of FILE_EXTENSIONS_FOR_LOOKUP) {\n        const pathWithExt: string = `${probableImportFilePath}${ext}`\n        try {\n          await fs.access(pathWithExt)\n          probableImportFilePath = pathWithExt\n          break\n        } catch {\n          continue\n        }\n      }\n    }\n\n    const nestedRelativeRegistryFilePath = path.relative(\n      config.resolvedPaths.cwd,\n      probableImportFilePath\n    )\n\n    // Skip if we've already processed this file or if it's in the skip list\n    if (\n      processedFiles.has(nestedRelativeRegistryFilePath) ||\n      FILE_PATH_SKIP_LIST.includes(nestedRelativeRegistryFilePath)\n    ) {\n      continue\n    }\n\n    const fileType = determineFileType(moduleSpecifier)\n    const file = {\n      path: nestedRelativeRegistryFilePath,\n      type: fileType,\n      target: \"\",\n    }\n\n    // TODO (shadcn): fix this.\n    if (fileType === \"registry:page\" || fileType === \"registry:file\") {\n      file.target = moduleSpecifier\n    }\n\n    files.push(file)\n\n    // Recursively process the imported file, passing the shared processedFiles set\n    const nestedResults = await recursivelyResolveFileImports(\n      nestedRelativeRegistryFilePath,\n      config,\n      projectInfo,\n      processedFiles\n    )\n\n    if (nestedResults.files) {\n      // Only add files that haven't been processed yet\n      for (const file of nestedResults.files) {\n        if (!processedFiles.has(file.path)) {\n          processedFiles.add(file.path)\n          files.push(file)\n        }\n      }\n    }\n\n    if (nestedResults.dependencies) {\n      nestedResults.dependencies.forEach((dep) => dependencies.add(dep))\n    }\n  }\n\n  // Deduplicate files by path\n  const uniqueFiles = Array.from(\n    new Map(files.map((file) => [file.path, file])).values()\n  )\n\n  return {\n    dependencies: Array.from(dependencies),\n    files: uniqueFiles,\n  }\n}\n\nasync function createTempSourceFile(filename: string) {\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"shadcn-\"))\n  return path.join(dir, filename)\n}\n\n// This is a bit tricky to accurately determine.\n// For now we'll use the module specifier to determine the type.\nfunction determineFileType(\n  moduleSpecifier: string\n): z.infer<typeof registryItemSchema>[\"type\"] {\n  if (moduleSpecifier.includes(\"/ui/\")) {\n    return \"registry:ui\"\n  }\n\n  if (moduleSpecifier.includes(\"/lib/\")) {\n    return \"registry:lib\"\n  }\n\n  if (moduleSpecifier.includes(\"/hooks/\")) {\n    return \"registry:hook\"\n  }\n\n  if (moduleSpecifier.includes(\"/components/\")) {\n    return \"registry:component\"\n  }\n\n  return \"registry:component\"\n}\n\n// Additional utility functions for local file support\nexport function isUrl(path: string) {\n  try {\n    new URL(path)\n    return true\n  } catch (error) {\n    return false\n  }\n}\n\nexport function isLocalFile(path: string) {\n  return path.endsWith(\".json\") && !isUrl(path)\n}\n\n/**\n * Check if a registry item is universal (framework-agnostic).\n * A universal registry item must:\n * 1. Have type \"registry:item\" or \"registry:file\"\n * 2. If it has files, all files must have explicit targets and be type \"registry:file\" or \"registry:item\"\n * It can be installed without framework detection or components.json.\n */\nexport function isUniversalRegistryItem(\n  registryItem:\n    | Pick<z.infer<typeof registryItemSchema>, \"files\" | \"type\">\n    | null\n    | undefined\n): boolean {\n  if (!registryItem) {\n    return false\n  }\n\n  if (\n    registryItem.type !== \"registry:item\" &&\n    registryItem.type !== \"registry:file\"\n  ) {\n    return false\n  }\n\n  const files = registryItem.files ?? []\n\n  // If there are files, all must have targets and be of type registry:file or registry:item.\n  return files.every(\n    (file) =>\n      !!file.target &&\n      (file.type === \"registry:file\" || file.type === \"registry:item\")\n  )\n}\n\n// Deduplicates files based on their resolved target paths.\n// When multiple files resolve to the same target path, the last one wins.\nexport async function deduplicateFilesByTarget(\n  filesArrays: Array<z.infer<typeof registryItemFileSchema>[] | undefined>,\n  config: Config\n) {\n  // Fallback to simple concatenation when we don't have complete config.\n  if (!canDeduplicateFiles(config)) {\n    return z\n      .array(registryItemFileSchema)\n      .parse(filesArrays.flat().filter(Boolean))\n  }\n\n  // Get project info for file resolution.\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\n  const targetMap = new Map<string, z.infer<typeof registryItemFileSchema>>()\n  const allFiles = z\n    .array(registryItemFileSchema)\n    .parse(filesArrays.flat().filter(Boolean))\n\n  allFiles.forEach((file) => {\n    const resolvedPath = resolveFilePath(file, config, {\n      isSrcDir: projectInfo?.isSrcDir,\n      framework: projectInfo?.framework.name,\n      commonRoot: findCommonRoot(\n        allFiles.map((f) => f.path),\n        file.path\n      ),\n    })\n\n    if (resolvedPath) {\n      // Last one wins - overwrites previous entry.\n      targetMap.set(resolvedPath, file)\n    }\n  })\n\n  return Array.from(targetMap.values())\n}\n\n// Checks if the config has the minimum required paths for file deduplication.\nexport function canDeduplicateFiles(config: Config) {\n  return !!(\n    config?.resolvedPaths?.cwd &&\n    (config?.resolvedPaths?.ui ||\n      config?.resolvedPaths?.lib ||\n      config?.resolvedPaths?.components ||\n      config?.resolvedPaths?.hooks)\n  )\n}\n","import { BUILTIN_REGISTRIES, FALLBACK_STYLE } from \"@/src/registry/constants\"\nimport { configSchema } from \"@/src/schema\"\nimport { Config, DeepPartial, createConfig } from \"@/src/utils/get-config\"\nimport deepmerge from \"deepmerge\"\n\nfunction resolveStyleFromConfig(config: DeepPartial<Config>) {\n  if (!config.style) {\n    return FALLBACK_STYLE\n  }\n\n  // Check if we should use new-york-v4 for Tailwind v4.\n  // We assume that if tailwind.config is empty, we're using Tailwind v4.\n  if (config.style === \"new-york\" && config.tailwind?.config === \"\") {\n    return FALLBACK_STYLE\n  }\n\n  return config.style\n}\n\nexport function configWithDefaults(config?: DeepPartial<Config>) {\n  const baseConfig = createConfig({\n    style: FALLBACK_STYLE,\n    registries: BUILTIN_REGISTRIES,\n  })\n\n  if (!config) {\n    return baseConfig\n  }\n\n  return configSchema.parse(\n    deepmerge(baseConfig, {\n      ...config,\n      style: resolveStyleFromConfig(config),\n      registries: { ...BUILTIN_REGISTRIES, ...config.registries },\n    })\n  )\n}\n","interface RegistryContext {\n  headers: Record<string, Record<string, string>>\n}\n\nlet context: RegistryContext = {\n  headers: {},\n}\n\nexport function setRegistryHeaders(\n  headers: Record<string, Record<string, string>>\n) {\n  // Merge new headers with existing ones to preserve headers for nested dependencies\n  context.headers = { ...context.headers, ...headers }\n}\n\nexport function getRegistryHeadersFromContext(\n  url: string\n): Record<string, string> {\n  return context.headers[url] || {}\n}\n\nexport function clearRegistryContext() {\n  context.headers = {}\n}\n","import { buildUrlAndHeadersForRegistryItem } from \"@/src/registry/builder\"\nimport { configWithDefaults } from \"@/src/registry/config\"\nimport { clearRegistryContext } from \"@/src/registry/context\"\nimport { extractEnvVars } from \"@/src/registry/env\"\nimport { RegistryMissingEnvironmentVariablesError } from \"@/src/registry/errors\"\nimport { registryConfigItemSchema } from \"@/src/schema\"\nimport { Config } from \"@/src/utils/get-config\"\nimport { z } from \"zod\"\n\nexport function extractEnvVarsFromRegistryConfig(\n  config: z.infer<typeof registryConfigItemSchema>\n): string[] {\n  const vars = new Set<string>()\n\n  if (typeof config === \"string\") {\n    extractEnvVars(config).forEach((v) => vars.add(v))\n  } else {\n    extractEnvVars(config.url).forEach((v) => vars.add(v))\n\n    if (config.params) {\n      Object.values(config.params).forEach((value) => {\n        extractEnvVars(value).forEach((v) => vars.add(v))\n      })\n    }\n\n    if (config.headers) {\n      Object.values(config.headers).forEach((value) => {\n        extractEnvVars(value).forEach((v) => vars.add(v))\n      })\n    }\n  }\n\n  return Array.from(vars)\n}\n\nexport function validateRegistryConfig(\n  registryName: string,\n  config: z.infer<typeof registryConfigItemSchema>\n): void {\n  const requiredVars = extractEnvVarsFromRegistryConfig(config)\n  const missing = requiredVars.filter((v) => !process.env[v])\n\n  if (missing.length > 0) {\n    throw new RegistryMissingEnvironmentVariablesError(registryName, missing)\n  }\n}\n\nexport function validateRegistryConfigForItems(\n  items: string[],\n  config?: Config\n): void {\n  for (const item of items) {\n    buildUrlAndHeadersForRegistryItem(item, configWithDefaults(config))\n  }\n\n  // Clear the registry context after validation.\n  clearRegistryContext()\n}\n","import { BUILTIN_REGISTRIES, REGISTRY_URL } from \"@/src/registry/constants\"\nimport { expandEnvVars } from \"@/src/registry/env\"\nimport { RegistryNotConfiguredError } from \"@/src/registry/errors\"\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\nimport { isLocalFile, isUrl } from \"@/src/registry/utils\"\nimport { validateRegistryConfig } from \"@/src/registry/validator\"\nimport { registryConfigItemSchema } from \"@/src/schema\"\nimport { Config } from \"@/src/utils/get-config\"\nimport { z } from \"zod\"\n\nconst NAME_PLACEHOLDER = \"{name}\"\nconst STYLE_PLACEHOLDER = \"{style}\"\nconst ENV_VAR_PATTERN = /\\${(\\w+)}/g\nconst QUERY_PARAM_SEPARATOR = \"?\"\nconst QUERY_PARAM_DELIMITER = \"&\"\n\nfunction isLocalPath(path: string) {\n  return path.startsWith(\"./\") || path.startsWith(\"/\")\n}\n\nexport function buildUrlAndHeadersForRegistryItem(\n  name: string,\n  config?: Config\n) {\n  let { registry, item } = parseRegistryAndItemFromString(name)\n\n  // If no registry prefix, check if it's a URL or local path.\n  // These should be handled directly, not through a registry.\n  if (!registry) {\n    if (isUrl(name) || isLocalFile(name) || isLocalPath(name)) {\n      return null\n    }\n    registry = \"@shadcn\"\n  }\n\n  const registries = { ...BUILTIN_REGISTRIES, ...config?.registries }\n  const registryConfig = registries[registry]\n  if (!registryConfig) {\n    throw new RegistryNotConfiguredError(registry)\n  }\n\n  // TODO: I don't like this here.\n  // But this will do for now.\n  validateRegistryConfig(registry, registryConfig)\n\n  return {\n    url: buildUrlFromRegistryConfig(item, registryConfig, config),\n    headers: buildHeadersFromRegistryConfig(registryConfig),\n  }\n}\n\nexport function buildUrlFromRegistryConfig(\n  item: string,\n  registryConfig: z.infer<typeof registryConfigItemSchema>,\n  config?: Config\n) {\n  if (typeof registryConfig === \"string\") {\n    let url = registryConfig.replace(NAME_PLACEHOLDER, item)\n    if (config?.style && url.includes(STYLE_PLACEHOLDER)) {\n      url = url.replace(STYLE_PLACEHOLDER, config.style)\n    }\n    return expandEnvVars(url)\n  }\n\n  let baseUrl = registryConfig.url.replace(NAME_PLACEHOLDER, item)\n  if (config?.style && baseUrl.includes(STYLE_PLACEHOLDER)) {\n    baseUrl = baseUrl.replace(STYLE_PLACEHOLDER, config.style)\n  }\n  baseUrl = expandEnvVars(baseUrl)\n\n  if (!registryConfig.params) {\n    return baseUrl\n  }\n\n  return appendQueryParams(baseUrl, registryConfig.params)\n}\n\nexport function buildHeadersFromRegistryConfig(\n  config: z.infer<typeof registryConfigItemSchema>\n) {\n  if (typeof config === \"string\" || !config.headers) {\n    return {}\n  }\n\n  const headers: Record<string, string> = {}\n\n  for (const [key, value] of Object.entries(config.headers)) {\n    const expandedValue = expandEnvVars(value)\n\n    if (shouldIncludeHeader(value, expandedValue)) {\n      headers[key] = expandedValue\n    }\n  }\n\n  return headers\n}\n\nfunction appendQueryParams(baseUrl: string, params: Record<string, string>) {\n  const urlParams = new URLSearchParams()\n\n  for (const [key, value] of Object.entries(params)) {\n    const expandedValue = expandEnvVars(value)\n    if (expandedValue) {\n      urlParams.append(key, expandedValue)\n    }\n  }\n\n  const queryString = urlParams.toString()\n  if (!queryString) {\n    return baseUrl\n  }\n\n  const separator = baseUrl.includes(QUERY_PARAM_SEPARATOR)\n    ? QUERY_PARAM_DELIMITER\n    : QUERY_PARAM_SEPARATOR\n\n  return `${baseUrl}${separator}${queryString}`\n}\n\nfunction shouldIncludeHeader(originalValue: string, expandedValue: string) {\n  const trimmedExpanded = expandedValue.trim()\n\n  if (!trimmedExpanded) {\n    return false\n  }\n\n  // If the original value contains valid env vars, only include if expansion changed the value.\n  if (originalValue.includes(\"${\")) {\n    // Check if there are actual env vars in the string\n    const envVars = originalValue.match(ENV_VAR_PATTERN)\n    if (envVars) {\n      const templateWithoutVars = originalValue\n        .replace(ENV_VAR_PATTERN, \"\")\n        .trim()\n      return trimmedExpanded !== templateWithoutVars\n    }\n  }\n\n  return true\n}\n\n/**\n * Resolves a registry URL from a path or URL string.\n * Handles special cases like v0 registry URLs that need /json suffix.\n *\n * @param pathOrUrl - Either a relative path or a full URL\n * @returns The resolved registry URL\n */\nexport function resolveRegistryUrl(pathOrUrl: string) {\n  if (isUrl(pathOrUrl)) {\n    // If the url contains /chat/b/, we assume it's the v0 registry.\n    // We need to add the /json suffix if it's missing.\n    const url = new URL(pathOrUrl)\n    if (url.pathname.match(/\\/chat\\/b\\//) && !url.pathname.endsWith(\"/json\")) {\n      url.pathname = `${url.pathname}/json`\n    }\n\n    return url.toString()\n  }\n\n  return `${REGISTRY_URL}/${pathOrUrl}`\n}\n","import { promises as fs } from \"fs\"\nimport { homedir } from \"os\"\nimport path from \"path\"\nimport { resolveRegistryUrl } from \"@/src/registry/builder\"\nimport { getRegistryHeadersFromContext } from \"@/src/registry/context\"\nimport {\n  RegistryFetchError,\n  RegistryForbiddenError,\n  RegistryLocalFileError,\n  RegistryNotFoundError,\n  RegistryParseError,\n  RegistryUnauthorizedError,\n} from \"@/src/registry/errors\"\nimport { registryItemSchema } from \"@/src/schema\"\nimport { HttpsProxyAgent } from \"https-proxy-agent\"\nimport fetch from \"node-fetch\"\nimport { z } from \"zod\"\n\nconst agent = process.env.https_proxy\n  ? new HttpsProxyAgent(process.env.https_proxy)\n  : undefined\n\nconst registryCache = new Map<string, Promise<any>>()\n\nexport function clearRegistryCache() {\n  registryCache.clear()\n}\n\nexport async function fetchRegistry(\n  paths: string[],\n  options: { useCache?: boolean } = {}\n) {\n  options = {\n    useCache: true,\n    ...options,\n  }\n\n  try {\n    const results = await Promise.all(\n      paths.map(async (path) => {\n        const url = resolveRegistryUrl(path)\n\n        // Check cache first if caching is enabled\n        if (options.useCache && registryCache.has(url)) {\n          return registryCache.get(url)\n        }\n\n        // Store the promise in the cache before awaiting if caching is enabled.\n        const fetchPromise = (async () => {\n          // Get headers from context for this URL.\n          const headers = getRegistryHeadersFromContext(url)\n\n          const response = await fetch(url, {\n            agent,\n            headers: {\n              ...headers,\n            },\n          })\n\n          if (!response.ok) {\n            let messageFromServer = undefined\n\n            if (\n              response.headers.get(\"content-type\")?.includes(\"application/json\")\n            ) {\n              const json = await response.json()\n              const parsed = z\n                .object({\n                  // RFC 7807.\n                  detail: z.string().optional(),\n                  title: z.string().optional(),\n                  // Standard error response.\n                  message: z.string().optional(),\n                  error: z.string().optional(),\n                })\n                .safeParse(json)\n\n              if (parsed.success) {\n                // Prefer RFC 7807 detail field, then message field.\n                messageFromServer = parsed.data.detail || parsed.data.message\n\n                if (parsed.data.error) {\n                  messageFromServer = `[${parsed.data.error}] ${messageFromServer}`\n                }\n              }\n            }\n\n            if (response.status === 401) {\n              throw new RegistryUnauthorizedError(url, messageFromServer)\n            }\n\n            if (response.status === 404) {\n              throw new RegistryNotFoundError(url, messageFromServer)\n            }\n\n            if (response.status === 403) {\n              throw new RegistryForbiddenError(url, messageFromServer)\n            }\n\n            throw new RegistryFetchError(\n              url,\n              response.status,\n              messageFromServer\n            )\n          }\n\n          return response.json()\n        })()\n\n        if (options.useCache) {\n          registryCache.set(url, fetchPromise)\n        }\n        return fetchPromise\n      })\n    )\n\n    return results\n  } catch (error) {\n    throw error\n  }\n}\n\nexport async function fetchRegistryLocal(filePath: string) {\n  try {\n    // Handle tilde expansion for home directory\n    let expandedPath = filePath\n    if (filePath.startsWith(\"~/\")) {\n      expandedPath = path.join(homedir(), filePath.slice(2))\n    }\n\n    const resolvedPath = path.resolve(expandedPath)\n    const content = await fs.readFile(resolvedPath, \"utf8\")\n    const parsed = JSON.parse(content)\n\n    try {\n      return registryItemSchema.parse(parsed)\n    } catch (error) {\n      throw new RegistryParseError(filePath, error)\n    }\n  } catch (error) {\n    // Check if this is a file not found error\n    if (\n      error instanceof Error &&\n      (error.message.includes(\"ENOENT\") ||\n        error.message.includes(\"no such file\"))\n    ) {\n      throw new RegistryLocalFileError(filePath, error)\n    }\n    // Re-throw parse errors as-is\n    if (error instanceof RegistryParseError) {\n      throw error\n    }\n    // For other errors (like JSON parse errors), throw as local file error\n    throw new RegistryLocalFileError(filePath, error)\n  }\n}\n","import { promises as fs } from \"fs\"\nimport { tmpdir } from \"os\"\nimport path from \"path\"\nimport {\n  registryItemCssVarsSchema,\n  registryItemTailwindSchema,\n} from \"@/src/schema\"\nimport { Config } from \"@/src/utils/get-config\"\nimport { TailwindVersion } from \"@/src/utils/get-project-info\"\nimport { highlighter } from \"@/src/utils/highlighter\"\nimport { spinner } from \"@/src/utils/spinner\"\nimport deepmerge from \"deepmerge\"\nimport objectToString from \"stringify-object\"\nimport { type Config as TailwindConfig } from \"tailwindcss\"\nimport {\n  ArrayLiteralExpression,\n  ObjectLiteralExpression,\n  Project,\n  PropertyAssignment,\n  QuoteKind,\n  ScriptKind,\n  SyntaxKind,\n  VariableStatement,\n} from \"ts-morph\"\nimport { z } from \"zod\"\n\nexport type UpdaterTailwindConfig = Omit<TailwindConfig, \"plugins\"> & {\n  // We only want string plugins for now.\n  plugins?: string[]\n}\n\nexport async function updateTailwindConfig(\n  tailwindConfig:\n    | z.infer<typeof registryItemTailwindSchema>[\"config\"]\n    | undefined,\n  config: Config,\n  options: {\n    silent?: boolean\n    tailwindVersion?: TailwindVersion\n  }\n) {\n  if (!tailwindConfig) {\n    return\n  }\n\n  options = {\n    silent: false,\n    tailwindVersion: \"v3\",\n    ...options,\n  }\n\n  // No tailwind config in v4.\n  if (options.tailwindVersion === \"v4\") {\n    return\n  }\n\n  const tailwindFileRelativePath = path.relative(\n    config.resolvedPaths.cwd,\n    config.resolvedPaths.tailwindConfig\n  )\n  const tailwindSpinner = spinner(\n    `Updating ${highlighter.info(tailwindFileRelativePath)}`,\n    {\n      silent: options.silent,\n    }\n  ).start()\n  const raw = await fs.readFile(config.resolvedPaths.tailwindConfig, \"utf8\")\n  const output = await transformTailwindConfig(raw, tailwindConfig, config)\n  await fs.writeFile(config.resolvedPaths.tailwindConfig, output, \"utf8\")\n  tailwindSpinner?.succeed()\n}\n\nexport async function transformTailwindConfig(\n  input: string,\n  tailwindConfig: UpdaterTailwindConfig,\n  config: Config\n) {\n  const sourceFile = await _createSourceFile(input, config)\n  // Find the object with content property.\n  // This is faster than traversing the default export.\n  // TODO: maybe we do need to traverse the default export?\n  const configObject = sourceFile\n    .getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression)\n    .find((node) =>\n      node\n        .getProperties()\n        .some(\n          (property) =>\n            property.isKind(SyntaxKind.PropertyAssignment) &&\n            property.getName() === \"content\"\n        )\n    )\n\n  // We couldn't find the config object, so we return the input as is.\n  if (!configObject) {\n    return input\n  }\n\n  const quoteChar = _getQuoteChar(configObject)\n\n  // Add darkMode.\n  addTailwindConfigProperty(\n    configObject,\n    {\n      name: \"darkMode\",\n      value: \"class\",\n    },\n    { quoteChar }\n  )\n\n  // Add Tailwind config plugins.\n  tailwindConfig.plugins?.forEach((plugin) => {\n    addTailwindConfigPlugin(configObject, plugin)\n  })\n\n  // Add Tailwind config theme.\n  if (tailwindConfig.theme) {\n    await addTailwindConfigTheme(configObject, tailwindConfig.theme)\n  }\n\n  return sourceFile.getFullText()\n}\n\nfunction addTailwindConfigProperty(\n  configObject: ObjectLiteralExpression,\n  property: {\n    name: string\n    value: string\n  },\n  {\n    quoteChar,\n  }: {\n    quoteChar: string\n  }\n) {\n  const existingProperty = configObject.getProperty(\"darkMode\")\n\n  if (!existingProperty) {\n    const newProperty = {\n      name: property.name,\n      initializer: `[${quoteChar}${property.value}${quoteChar}]`,\n    }\n\n    // We need to add darkMode as the first property.\n    if (property.name === \"darkMode\") {\n      configObject.insertPropertyAssignment(0, newProperty)\n      return configObject\n    }\n\n    configObject.addPropertyAssignment(newProperty)\n\n    return configObject\n  }\n\n  if (existingProperty.isKind(SyntaxKind.PropertyAssignment)) {\n    const initializer = existingProperty.getInitializer()\n    const newValue = `${quoteChar}${property.value}${quoteChar}`\n\n    // If property is a string, change it to an array and append.\n    if (initializer?.isKind(SyntaxKind.StringLiteral)) {\n      const initializerText = initializer.getText()\n      initializer.replaceWithText(`[${initializerText}, ${newValue}]`)\n      return configObject\n    }\n\n    // If property is an array, append.\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\n      // Check if the array already contains the value.\n      if (\n        initializer\n          .getElements()\n          .map((element) => element.getText())\n          .includes(newValue)\n      ) {\n        return configObject\n      }\n      initializer.addElement(newValue)\n    }\n\n    return configObject\n  }\n\n  return configObject\n}\n\nasync function addTailwindConfigTheme(\n  configObject: ObjectLiteralExpression,\n  theme: UpdaterTailwindConfig[\"theme\"]\n) {\n  // Ensure there is a theme property.\n  if (!configObject.getProperty(\"theme\")) {\n    configObject.addPropertyAssignment({\n      name: \"theme\",\n      initializer: \"{}\",\n    })\n  }\n\n  // Nest all spread properties.\n  nestSpreadProperties(configObject)\n\n  const themeProperty = configObject\n    .getPropertyOrThrow(\"theme\")\n    ?.asKindOrThrow(SyntaxKind.PropertyAssignment)\n\n  const themeInitializer = themeProperty.getInitializer()\n  if (themeInitializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\n    const themeObjectString = themeInitializer.getText()\n    const themeObject = await parseObjectLiteral(themeObjectString)\n    const result = deepmerge(themeObject, theme, {\n      arrayMerge: (dst, src) => src,\n    })\n    const resultString = objectToString(result)\n      .replace(/\\'\\.\\.\\.(.*)\\'/g, \"...$1\") // Remove quote around spread element\n      .replace(/\\'\\\"/g, \"'\") // Replace `\\\" with \"\n      .replace(/\\\"\\'/g, \"'\") // Replace `\\\" with \"\n      .replace(/\\'\\[/g, \"[\") // Replace `[ with [\n      .replace(/\\]\\'/g, \"]\") // Replace `] with ]\n      .replace(/\\'\\\\\\'/g, \"'\") // Replace `\\' with '\n      .replace(/\\\\\\'/g, \"'\") // Replace \\' with '\n      .replace(/\\\\\\'\\'/g, \"'\")\n      .replace(/\\'\\'/g, \"'\")\n    themeInitializer.replaceWithText(resultString)\n  }\n\n  // Unnest all spread properties.\n  unnestSpreadProperties(configObject)\n}\n\nfunction addTailwindConfigPlugin(\n  configObject: ObjectLiteralExpression,\n  plugin: string\n) {\n  const existingPlugins = configObject.getProperty(\"plugins\")\n\n  if (!existingPlugins) {\n    configObject.addPropertyAssignment({\n      name: \"plugins\",\n      initializer: `[${plugin}]`,\n    })\n\n    return configObject\n  }\n\n  if (existingPlugins.isKind(SyntaxKind.PropertyAssignment)) {\n    const initializer = existingPlugins.getInitializer()\n\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\n      if (\n        initializer\n          .getElements()\n          .map((element) => {\n            return element.getText().replace(/[\"']/g, \"\")\n          })\n          .includes(plugin.replace(/[\"']/g, \"\"))\n      ) {\n        return configObject\n      }\n      initializer.addElement(plugin)\n    }\n\n    return configObject\n  }\n\n  return configObject\n}\n\nexport async function _createSourceFile(input: string, config: Config | null) {\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"shadcn-\"))\n  const resolvedPath =\n    config?.resolvedPaths?.tailwindConfig || \"tailwind.config.ts\"\n  const tempFile = path.join(dir, `shadcn-${path.basename(resolvedPath)}`)\n\n  const project = new Project({\n    compilerOptions: {},\n  })\n  const sourceFile = project.createSourceFile(tempFile, input, {\n    // Note: .js and .mjs can still be valid for TS projects.\n    // We can't infer TypeScript from config.tsx.\n    scriptKind:\n      path.extname(resolvedPath) === \".ts\" ? ScriptKind.TS : ScriptKind.JS,\n  })\n\n  return sourceFile\n}\n\nexport function _getQuoteChar(configObject: ObjectLiteralExpression) {\n  return configObject\n    .getFirstDescendantByKind(SyntaxKind.StringLiteral)\n    ?.getQuoteKind() === QuoteKind.Single\n    ? \"'\"\n    : '\"'\n}\n\nexport function nestSpreadProperties(obj: ObjectLiteralExpression) {\n  const properties = obj.getProperties()\n\n  for (let i = 0; i < properties.length; i++) {\n    const prop = properties[i]\n    if (prop.isKind(SyntaxKind.SpreadAssignment)) {\n      const spreadAssignment = prop.asKindOrThrow(SyntaxKind.SpreadAssignment)\n      const spreadText = spreadAssignment.getExpression().getText()\n\n      // Replace spread with a property assignment\n      obj.insertPropertyAssignment(i, {\n        // Need to escape the name with \" so that deepmerge doesn't mishandle the key\n        name: `\"___${spreadText.replace(/^\\.\\.\\./, \"\")}\"`,\n        initializer: `\"...${spreadText.replace(/^\\.\\.\\./, \"\")}\"`,\n      })\n\n      // Remove the original spread assignment\n      spreadAssignment.remove()\n    } else if (prop.isKind(SyntaxKind.PropertyAssignment)) {\n      const propAssignment = prop.asKindOrThrow(SyntaxKind.PropertyAssignment)\n      const initializer = propAssignment.getInitializer()\n\n      if (\n        initializer &&\n        initializer.isKind(SyntaxKind.ObjectLiteralExpression)\n      ) {\n        // Recursively process nested object literals\n        nestSpreadProperties(\n          initializer.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\n        )\n      } else if (\n        initializer &&\n        initializer.isKind(SyntaxKind.ArrayLiteralExpression)\n      ) {\n        nestSpreadElements(\n          initializer.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\n        )\n      }\n    }\n  }\n}\n\nexport function nestSpreadElements(arr: ArrayLiteralExpression) {\n  const elements = arr.getElements()\n  for (let j = 0; j < elements.length; j++) {\n    const element = elements[j]\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\n      // Recursive check on objects within arrays\n      nestSpreadProperties(\n        element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\n      )\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\n      // Recursive check on nested arrays\n      nestSpreadElements(\n        element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\n      )\n    } else if (element.isKind(SyntaxKind.SpreadElement)) {\n      const spreadText = element.getText()\n      // Spread element within an array\n      arr.removeElement(j)\n      arr.insertElement(j, `\"${spreadText}\"`)\n    }\n  }\n}\n\nexport function unnestSpreadProperties(obj: ObjectLiteralExpression) {\n  const properties = obj.getProperties()\n\n  for (let i = 0; i < properties.length; i++) {\n    const prop = properties[i]\n    if (prop.isKind(SyntaxKind.PropertyAssignment)) {\n      const propAssignment = prop as PropertyAssignment\n      const initializer = propAssignment.getInitializer()\n\n      if (initializer && initializer.isKind(SyntaxKind.StringLiteral)) {\n        const value = initializer\n          .asKindOrThrow(SyntaxKind.StringLiteral)\n          .getLiteralValue()\n        if (value.startsWith(\"...\")) {\n          obj.insertSpreadAssignment(i, { expression: value.slice(3) })\n          propAssignment.remove()\n        }\n      } else if (initializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\n        unnestSpreadProperties(initializer as ObjectLiteralExpression)\n      } else if (\n        initializer &&\n        initializer.isKind(SyntaxKind.ArrayLiteralExpression)\n      ) {\n        unsetSpreadElements(\n          initializer.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\n        )\n      }\n    }\n  }\n}\n\nexport function unsetSpreadElements(arr: ArrayLiteralExpression) {\n  const elements = arr.getElements()\n  for (let j = 0; j < elements.length; j++) {\n    const element = elements[j]\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\n      // Recursive check on objects within arrays\n      unnestSpreadProperties(\n        element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\n      )\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\n      // Recursive check on nested arrays\n      unsetSpreadElements(\n        element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\n      )\n    } else if (element.isKind(SyntaxKind.StringLiteral)) {\n      const spreadText = element.getText()\n      // check if spread element\n      const spreadTest = /(?:^['\"])(\\.\\.\\..*)(?:['\"]$)/g\n      if (spreadTest.test(spreadText)) {\n        arr.removeElement(j)\n        arr.insertElement(j, spreadText.replace(spreadTest, \"$1\"))\n      }\n    }\n  }\n}\n\nasync function parseObjectLiteral(objectLiteralString: string): Promise<any> {\n  const sourceFile = await _createSourceFile(\n    `const theme = ${objectLiteralString}`,\n    null\n  )\n\n  const statement = sourceFile.getStatements()[0]\n  if (statement?.getKind() === SyntaxKind.VariableStatement) {\n    const declaration = (statement as VariableStatement)\n      .getDeclarationList()\n      ?.getDeclarations()[0]\n    const initializer = declaration.getInitializer()\n    if (initializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\n      return await parseObjectLiteralExpression(initializer)\n    }\n  }\n\n  throw new Error(\"Invalid input: not an object literal\")\n}\n\nfunction parseObjectLiteralExpression(node: ObjectLiteralExpression): any {\n  const result: any = {}\n  for (const property of node.getProperties()) {\n    if (property.isKind(SyntaxKind.PropertyAssignment)) {\n      const name = property.getName().replace(/\\'/g, \"\")\n      if (\n        property.getInitializer()?.isKind(SyntaxKind.ObjectLiteralExpression)\n      ) {\n        result[name] = parseObjectLiteralExpression(\n          property.getInitializer() as ObjectLiteralExpression\n        )\n      } else if (\n        property.getInitializer()?.isKind(SyntaxKind.ArrayLiteralExpression)\n      ) {\n        result[name] = parseArrayLiteralExpression(\n          property.getInitializer() as ArrayLiteralExpression\n        )\n      } else {\n        result[name] = parseValue(property.getInitializer())\n      }\n    }\n  }\n  return result\n}\n\nfunction parseArrayLiteralExpression(node: ArrayLiteralExpression): any[] {\n  const result: any[] = []\n  for (const element of node.getElements()) {\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\n      result.push(\n        parseObjectLiteralExpression(\n          element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\n        )\n      )\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\n      result.push(\n        parseArrayLiteralExpression(\n          element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\n        )\n      )\n    } else {\n      result.push(parseValue(element))\n    }\n  }\n  return result\n}\n\nfunction parseValue(node: any): any {\n  switch (node.getKind()) {\n    case SyntaxKind.StringLiteral:\n      return node.getText()\n    case SyntaxKind.NumericLiteral:\n      return Number(node.getText())\n    case SyntaxKind.TrueKeyword:\n      return true\n    case SyntaxKind.FalseKeyword:\n      return false\n    case SyntaxKind.NullKeyword:\n      return null\n    case SyntaxKind.ArrayLiteralExpression:\n      return node.getElements().map(parseValue)\n    case SyntaxKind.ObjectLiteralExpression:\n      return parseObjectLiteralExpression(node)\n    default:\n      return node.getText()\n  }\n}\n\nexport function buildTailwindThemeColorsFromCssVars(\n  cssVars: z.infer<typeof registryItemCssVarsSchema>\n) {\n  const result: Record<string, any> = {}\n\n  for (const key of Object.keys(cssVars)) {\n    const parts = key.split(\"-\")\n    const colorName = parts[0]\n    const subType = parts.slice(1).join(\"-\")\n\n    if (subType === \"\") {\n      if (typeof result[colorName] === \"object\") {\n        result[colorName].DEFAULT = `hsl(var(--${key}))`\n      } else {\n        result[colorName] = `hsl(var(--${key}))`\n      }\n    } else {\n      if (typeof result[colorName] !== \"object\") {\n        result[colorName] = { DEFAULT: `hsl(var(--${colorName}))` }\n      }\n      result[colorName][subType] = `hsl(var(--${key}))`\n    }\n  }\n\n  // Remove DEFAULT if it's not in the original cssVars\n  for (const [colorName, value] of Object.entries(result)) {\n    if (\n      typeof value === \"object\" &&\n      value.DEFAULT === `hsl(var(--${colorName}))` &&\n      !(colorName in cssVars)\n    ) {\n      delete value.DEFAULT\n    }\n  }\n\n  return result\n}\n","import { createHash } from \"crypto\"\nimport path from \"path\"\nimport {\n  getRegistryBaseColor,\n  getShadcnRegistryIndex,\n} from \"@/src/registry/api\"\nimport {\n  buildUrlAndHeadersForRegistryItem,\n  resolveRegistryUrl,\n} from \"@/src/registry/builder\"\nimport { setRegistryHeaders } from \"@/src/registry/context\"\nimport {\n  RegistryNotConfiguredError,\n  RegistryParseError,\n} from \"@/src/registry/errors\"\nimport { fetchRegistry, fetchRegistryLocal } from \"@/src/registry/fetcher\"\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\nimport {\n  deduplicateFilesByTarget,\n  isLocalFile,\n  isUrl,\n} from \"@/src/registry/utils\"\nimport {\n  RegistryFontItem,\n  registryItemCommonSchema,\n  registryItemFontSchema,\n  registryItemSchema,\n  registryItemTypeSchema,\n  registryResolvedItemsTreeSchema,\n} from \"@/src/schema\"\nimport { Config, getTargetStyleFromConfig } from \"@/src/utils/get-config\"\nimport { getProjectTailwindVersionFromConfig } from \"@/src/utils/get-project-info\"\nimport { buildTailwindThemeColorsFromCssVars } from \"@/src/utils/updaters/update-tailwind-config\"\nimport deepmerge from \"deepmerge\"\nimport { z } from \"zod\"\n\nexport function resolveRegistryItemsFromRegistries(\n  items: string[],\n  config: Config\n) {\n  const registryHeaders: Record<string, Record<string, string>> = {}\n  const resolvedItems = [...items]\n\n  if (!config?.registries) {\n    setRegistryHeaders({})\n    return resolvedItems\n  }\n\n  for (let i = 0; i < resolvedItems.length; i++) {\n    const resolved = buildUrlAndHeadersForRegistryItem(resolvedItems[i], config)\n\n    if (resolved) {\n      resolvedItems[i] = resolved.url\n\n      if (Object.keys(resolved.headers).length > 0) {\n        registryHeaders[resolved.url] = resolved.headers\n      }\n    }\n  }\n\n  setRegistryHeaders(registryHeaders)\n\n  return resolvedItems\n}\n\n// Internal function that fetches registry items without clearing context.\n// This is used for recursive dependency resolution.\nexport async function fetchRegistryItems(\n  items: string[],\n  config: Config,\n  options: { useCache?: boolean } = {}\n) {\n  const results = await Promise.all(\n    items.map(async (item) => {\n      if (isLocalFile(item)) {\n        return fetchRegistryLocal(item)\n      }\n\n      if (isUrl(item)) {\n        const [result] = await fetchRegistry([item], options)\n        try {\n          return registryItemSchema.parse(result)\n        } catch (error) {\n          throw new RegistryParseError(item, error)\n        }\n      }\n\n      if (item.startsWith(\"@\") && config?.registries) {\n        const paths = resolveRegistryItemsFromRegistries([item], config)\n        const [result] = await fetchRegistry(paths, options)\n        try {\n          return registryItemSchema.parse(result)\n        } catch (error) {\n          throw new RegistryParseError(item, error)\n        }\n      }\n\n      const path = `styles/${config?.style ?? \"new-york-v4\"}/${item}.json`\n      const [result] = await fetchRegistry([path], options)\n      try {\n        return registryItemSchema.parse(result)\n      } catch (error) {\n        throw new RegistryParseError(item, error)\n      }\n    })\n  )\n\n  return results\n}\n\n// Helper schema for items with source tracking.\nconst registryItemWithSourceSchema = registryItemCommonSchema\n  .extend({\n    type: registryItemTypeSchema,\n    _source: z.string().optional(),\n    // Optional fields for specific item types.\n    font: registryItemFontSchema.optional(),\n    config: z.any().optional(),\n  })\n  .passthrough()\n\n// Resolves a list of registry items with all their dependencies and returns\n// a complete installation bundle with merged configuration.\nexport async function resolveRegistryTree(\n  names: z.infer<typeof registryItemSchema>[\"name\"][],\n  config: Config,\n  options: { useCache?: boolean } = {}\n) {\n  options = {\n    useCache: true,\n    ...options,\n  }\n\n  let payload: z.infer<typeof registryItemWithSourceSchema>[] = []\n  let allDependencyItems: z.infer<typeof registryItemWithSourceSchema>[] = []\n  let allDependencyRegistryNames: string[] = []\n\n  const uniqueNames = Array.from(new Set(names))\n\n  const results = await fetchRegistryItems(uniqueNames, config, options)\n\n  const resultMap = new Map<string, z.infer<typeof registryItemSchema>>()\n  for (let i = 0; i < results.length; i++) {\n    if (results[i]) {\n      resultMap.set(uniqueNames[i], results[i])\n    }\n  }\n\n  for (const [sourceName, item] of Array.from(resultMap.entries())) {\n    // Add source tracking\n    const itemWithSource: z.infer<typeof registryItemWithSourceSchema> = {\n      ...item,\n      _source: sourceName,\n    }\n    payload.push(itemWithSource)\n\n    if (item.registryDependencies) {\n      // Resolve namespace syntax and set headers for dependencies\n      let resolvedDependencies = item.registryDependencies\n\n      // Check for namespaced dependencies when no registries are configured\n      if (!config?.registries) {\n        const namespacedDeps = item.registryDependencies.filter((dep: string) =>\n          dep.startsWith(\"@\")\n        )\n        if (namespacedDeps.length > 0) {\n          const { registry } = parseRegistryAndItemFromString(namespacedDeps[0])\n          throw new RegistryNotConfiguredError(registry)\n        }\n      } else {\n        resolvedDependencies = resolveRegistryItemsFromRegistries(\n          item.registryDependencies,\n          config\n        )\n      }\n\n      const { items, registryNames } = await resolveDependenciesRecursively(\n        resolvedDependencies,\n        config,\n        options,\n        new Set(uniqueNames)\n      )\n      allDependencyItems.push(...items)\n      allDependencyRegistryNames.push(...registryNames)\n    }\n  }\n\n  payload.push(...allDependencyItems)\n\n  // Handle any remaining registry names that need index resolution\n  if (allDependencyRegistryNames.length > 0) {\n    // Remove duplicates from registry names\n    const uniqueRegistryNames = Array.from(new Set(allDependencyRegistryNames))\n\n    // Separate namespaced and non-namespaced items\n    const nonNamespacedItems = uniqueRegistryNames.filter(\n      (name) => !name.startsWith(\"@\")\n    )\n    const namespacedDepItems = uniqueRegistryNames.filter((name) =>\n      name.startsWith(\"@\")\n    )\n\n    // Handle namespaced dependency items\n    if (namespacedDepItems.length > 0) {\n      // This will now throw specific errors on failure\n      const depResults = await fetchRegistryItems(\n        namespacedDepItems,\n        config,\n        options\n      )\n\n      for (let i = 0; i < depResults.length; i++) {\n        const item = depResults[i]\n        const itemWithSource: z.infer<typeof registryItemWithSourceSchema> = {\n          ...item,\n          _source: namespacedDepItems[i],\n        }\n        payload.push(itemWithSource)\n      }\n    }\n\n    // For non-namespaced items, we need the index and style resolution\n    if (nonNamespacedItems.length > 0) {\n      const index = await getShadcnRegistryIndex()\n      if (!index && payload.length === 0) {\n        return null\n      }\n\n      if (index) {\n        // If we're resolving the index, we want it to go first\n        if (nonNamespacedItems.includes(\"index\")) {\n          nonNamespacedItems.unshift(\"index\")\n        }\n\n        // Resolve non-namespaced items through the existing flow\n        // Get URLs for all registry items including their dependencies\n        const registryUrls: string[] = []\n        for (const name of nonNamespacedItems) {\n          const itemDependencies = await resolveRegistryDependencies(\n            name,\n            config,\n            options\n          )\n          registryUrls.push(...itemDependencies)\n        }\n\n        // Deduplicate URLs\n        const uniqueUrls = Array.from(new Set(registryUrls))\n        let result = await fetchRegistry(uniqueUrls, options)\n        const registryPayload = z.array(registryItemSchema).parse(result)\n        payload.push(...registryPayload)\n      }\n    }\n  }\n\n  if (!payload.length) {\n    return null\n  }\n\n  // No deduplication - we want to support multiple items with the same name from different sources\n\n  // If we're resolving the index, we want to fetch\n  // the theme item if a base color is provided.\n  // We do this for index only.\n  // Other components will ship with their theme tokens.\n  if (\n    uniqueNames.includes(\"index\") ||\n    allDependencyRegistryNames.includes(\"index\")\n  ) {\n    if (config.tailwind.baseColor) {\n      const theme = await registryGetTheme(config.tailwind.baseColor, config)\n      if (theme) {\n        payload.unshift(theme)\n      }\n    }\n  }\n\n  // Build source map for topological sort.\n  const sourceMap = new Map<\n    z.infer<typeof registryItemWithSourceSchema>,\n    string\n  >()\n  payload.forEach((item) => {\n    // Use the _source property if it was added, otherwise use the name.\n    const source = item._source || item.name\n    sourceMap.set(item, source)\n  })\n\n  // Apply topological sort to ensure dependencies come before dependents.\n  payload = topologicalSortRegistryItems(payload, sourceMap)\n\n  // Sort the payload so that registry:theme items come first,\n  // while maintaining the relative order of all items.\n  payload.sort((a, b) => {\n    if (a.type === \"registry:theme\" && b.type !== \"registry:theme\") {\n      return -1\n    }\n    if (a.type !== \"registry:theme\" && b.type === \"registry:theme\") {\n      return 1\n    }\n    return 0\n  })\n\n  let tailwind = {}\n  payload.forEach((item) => {\n    tailwind = deepmerge(tailwind, item.tailwind ?? {})\n  })\n\n  let cssVars = {}\n  payload.forEach((item) => {\n    cssVars = deepmerge(cssVars, item.cssVars ?? {})\n  })\n\n  let css = {}\n  payload.forEach((item) => {\n    css = deepmerge(css, item.css ?? {})\n  })\n\n  let docs = \"\"\n  payload.forEach((item) => {\n    if (item.docs) {\n      docs += `${item.docs}\\n`\n    }\n  })\n\n  let envVars = {}\n  payload.forEach((item) => {\n    envVars = deepmerge(envVars, item.envVars ?? {})\n  })\n\n  // Deduplicate files based on resolved target paths.\n  const deduplicatedFiles = await deduplicateFilesByTarget(\n    payload.map((item) => item.files ?? []),\n    config\n  )\n\n  // Collect font items.\n  const fonts: RegistryFontItem[] = payload\n    .filter((item) => item.type === \"registry:font\" && item.font)\n    .map((item) => ({\n      ...item,\n      type: \"registry:font\" as const,\n      font: item.font!,\n    }))\n\n  const parsed = registryResolvedItemsTreeSchema.parse({\n    dependencies: deepmerge.all(payload.map((item) => item.dependencies ?? [])),\n    devDependencies: deepmerge.all(\n      payload.map((item) => item.devDependencies ?? [])\n    ),\n    files: deduplicatedFiles,\n    tailwind,\n    cssVars,\n    css,\n    docs,\n    fonts: fonts.length > 0 ? fonts : undefined,\n  })\n\n  if (Object.keys(envVars).length > 0) {\n    parsed.envVars = envVars\n  }\n\n  return parsed\n}\n\nasync function resolveDependenciesRecursively(\n  dependencies: string[],\n  config: Config,\n  options: { useCache?: boolean } = {},\n  visited: Set<string> = new Set()\n) {\n  const items: z.infer<typeof registryItemSchema>[] = []\n  const registryNames: string[] = []\n\n  for (const dep of dependencies) {\n    if (visited.has(dep)) {\n      continue\n    }\n    visited.add(dep)\n\n    // Handle URLs and local files directly.\n    if (isUrl(dep) || isLocalFile(dep)) {\n      const [item] = await fetchRegistryItems([dep], config, options)\n      if (item) {\n        items.push(item)\n        if (item.registryDependencies) {\n          // Resolve namespaced dependencies to set proper headers.\n          const resolvedDeps = config?.registries\n            ? resolveRegistryItemsFromRegistries(\n                item.registryDependencies,\n                config\n              )\n            : item.registryDependencies\n\n          const nested = await resolveDependenciesRecursively(\n            resolvedDeps,\n            config,\n            options,\n            visited\n          )\n          items.push(...nested.items)\n          registryNames.push(...nested.registryNames)\n        }\n      }\n    }\n    // Handle namespaced items (e.g., @one/foo, @two/bar).\n    else if (dep.startsWith(\"@\") && config?.registries) {\n      // Check if the registry exists.\n      const { registry } = parseRegistryAndItemFromString(dep)\n      if (registry && !(registry in config.registries)) {\n        throw new RegistryNotConfiguredError(registry)\n      }\n\n      // Let getRegistryItem handle the namespaced item with config\n      // This ensures proper authentication headers are used\n      const [item] = await fetchRegistryItems([dep], config, options)\n      if (item) {\n        items.push(item)\n        if (item.registryDependencies) {\n          // Resolve namespaced dependencies to set proper headers.\n          const resolvedDeps = config?.registries\n            ? resolveRegistryItemsFromRegistries(\n                item.registryDependencies,\n                config\n              )\n            : item.registryDependencies\n\n          const nested = await resolveDependenciesRecursively(\n            resolvedDeps,\n            config,\n            options,\n            visited\n          )\n          items.push(...nested.items)\n          registryNames.push(...nested.registryNames)\n        }\n      }\n    }\n    // Handle regular component names.\n    else {\n      registryNames.push(dep)\n\n      if (config) {\n        try {\n          const [item] = await fetchRegistryItems([dep], config, options)\n          if (item && item.registryDependencies) {\n            // Resolve namespaced dependencies to set proper headers.\n            const resolvedDeps = config?.registries\n              ? resolveRegistryItemsFromRegistries(\n                  item.registryDependencies,\n                  config\n                )\n              : item.registryDependencies\n\n            const nested = await resolveDependenciesRecursively(\n              resolvedDeps,\n              config,\n              options,\n              visited\n            )\n            items.push(...nested.items)\n            registryNames.push(...nested.registryNames)\n          }\n        } catch (error) {\n          // If we can't fetch the registry item, that's okay - we'll still\n          // include the name.\n        }\n      }\n    }\n  }\n\n  return { items, registryNames }\n}\n\nasync function resolveRegistryDependencies(\n  url: string,\n  config: Config,\n  options: { useCache?: boolean } = {}\n) {\n  if (isUrl(url)) {\n    return [url]\n  }\n\n  const { registryNames } = await resolveDependenciesRecursively(\n    [url],\n    config,\n    options,\n    new Set()\n  )\n\n  const style = config.resolvedPaths?.cwd\n    ? await getTargetStyleFromConfig(config.resolvedPaths.cwd, config.style)\n    : config.style\n\n  const urls = registryNames.map((name) =>\n    resolveRegistryUrl(isUrl(name) ? name : `styles/${style}/${name}.json`)\n  )\n\n  return Array.from(new Set(urls))\n}\n\nasync function registryGetTheme(name: string, config: Config) {\n  const [baseColor, tailwindVersion] = await Promise.all([\n    getRegistryBaseColor(name),\n    getProjectTailwindVersionFromConfig(config),\n  ])\n  if (!baseColor) {\n    return null\n  }\n\n  // TODO: Move this to the registry i.e registry:theme.\n  const theme = {\n    name,\n    type: \"registry:theme\",\n    tailwind: {\n      config: {\n        theme: {\n          extend: {\n            borderRadius: {\n              lg: \"var(--radius)\",\n              md: \"calc(var(--radius) - 2px)\",\n              sm: \"calc(var(--radius) - 4px)\",\n            },\n            colors: {},\n          },\n        },\n      },\n    },\n    cssVars: {\n      theme: {},\n      light: {\n        radius: \"0.5rem\",\n      },\n      dark: {},\n    },\n  } satisfies z.infer<typeof registryItemSchema>\n\n  if (config.tailwind.cssVariables) {\n    theme.tailwind.config.theme.extend.colors = {\n      ...theme.tailwind.config.theme.extend.colors,\n      ...buildTailwindThemeColorsFromCssVars(baseColor.cssVars.dark ?? {}),\n    }\n    theme.cssVars = {\n      theme: {\n        ...baseColor.cssVars.theme,\n        ...theme.cssVars.theme,\n      },\n      light: {\n        ...baseColor.cssVars.light,\n        ...theme.cssVars.light,\n      },\n      dark: {\n        ...baseColor.cssVars.dark,\n        ...theme.cssVars.dark,\n      },\n    }\n\n    if (tailwindVersion === \"v4\" && baseColor.cssVarsV4) {\n      theme.cssVars = {\n        theme: {\n          ...baseColor.cssVarsV4.theme,\n          ...theme.cssVars.theme,\n        },\n        light: {\n          radius: \"0.625rem\",\n          ...baseColor.cssVarsV4.light,\n        },\n        dark: {\n          ...baseColor.cssVarsV4.dark,\n        },\n      }\n    }\n  }\n\n  return theme\n}\n\nfunction computeItemHash(\n  item: Pick<z.infer<typeof registryItemSchema>, \"name\">,\n  source?: string\n) {\n  const identifier = source || item.name\n\n  const hash = createHash(\"sha256\")\n    .update(identifier)\n    .digest(\"hex\")\n    .substring(0, 8)\n\n  return `${item.name}::${hash}`\n}\n\nfunction extractItemIdentifierFromDependency(dependency: string) {\n  if (isUrl(dependency)) {\n    const url = new URL(dependency)\n    const pathname = url.pathname\n    const match = pathname.match(/\\/([^/]+)\\.json$/)\n    const name = match ? match[1] : path.basename(pathname, \".json\")\n\n    return {\n      name,\n      hash: computeItemHash({ name }, dependency),\n    }\n  }\n\n  if (isLocalFile(dependency)) {\n    const match = dependency.match(/\\/([^/]+)\\.json$/)\n    const name = match ? match[1] : path.basename(dependency, \".json\")\n\n    return {\n      name,\n      hash: computeItemHash({ name }, dependency),\n    }\n  }\n\n  const { item } = parseRegistryAndItemFromString(dependency)\n  return {\n    name: item,\n    hash: computeItemHash({ name: item }, dependency),\n  }\n}\n\nfunction topologicalSortRegistryItems(\n  items: z.infer<typeof registryItemWithSourceSchema>[],\n  sourceMap: Map<z.infer<typeof registryItemWithSourceSchema>, string>\n) {\n  const itemMap = new Map<\n    string,\n    z.infer<typeof registryItemWithSourceSchema>\n  >()\n  const hashToItem = new Map<\n    string,\n    z.infer<typeof registryItemWithSourceSchema>\n  >()\n  const inDegree = new Map<string, number>()\n  const adjacencyList = new Map<string, string[]>()\n\n  items.forEach((item) => {\n    const source = sourceMap.get(item) || item.name\n    const hash = computeItemHash(item, source)\n\n    itemMap.set(hash, item)\n    hashToItem.set(hash, item)\n    inDegree.set(hash, 0)\n    adjacencyList.set(hash, [])\n  })\n\n  // Build a map of dependency to possible items.\n  const depToHashes = new Map<string, string[]>()\n  items.forEach((item) => {\n    const source = sourceMap.get(item) || item.name\n    const hash = computeItemHash(item, source)\n\n    if (!depToHashes.has(item.name)) {\n      depToHashes.set(item.name, [])\n    }\n    depToHashes.get(item.name)!.push(hash)\n\n    if (source !== item.name) {\n      if (!depToHashes.has(source)) {\n        depToHashes.set(source, [])\n      }\n      depToHashes.get(source)!.push(hash)\n    }\n  })\n\n  items.forEach((item) => {\n    const itemSource = sourceMap.get(item) || item.name\n    const itemHash = computeItemHash(item, itemSource)\n\n    if (item.registryDependencies) {\n      item.registryDependencies.forEach((dep) => {\n        let depHash: string | undefined\n\n        const exactMatches = depToHashes.get(dep) || []\n        if (exactMatches.length === 1) {\n          depHash = exactMatches[0]\n        } else if (exactMatches.length > 1) {\n          // Multiple matches - try to disambiguate.\n          // For now, just use the first one and warn.\n          depHash = exactMatches[0]\n        } else {\n          const { name } = extractItemIdentifierFromDependency(dep)\n          const nameMatches = depToHashes.get(name) || []\n          if (nameMatches.length > 0) {\n            depHash = nameMatches[0]\n          }\n        }\n\n        if (depHash && itemMap.has(depHash)) {\n          adjacencyList.get(depHash)!.push(itemHash)\n          inDegree.set(itemHash, inDegree.get(itemHash)! + 1)\n        }\n      })\n    }\n  })\n\n  // Implements Kahn's algorithm.\n  const queue: string[] = []\n  const sorted: z.infer<typeof registryItemWithSourceSchema>[] = []\n\n  inDegree.forEach((degree, hash) => {\n    if (degree === 0) {\n      queue.push(hash)\n    }\n  })\n\n  while (queue.length > 0) {\n    const currentHash = queue.shift()!\n    const item = itemMap.get(currentHash)!\n    sorted.push(item)\n\n    adjacencyList.get(currentHash)!.forEach((dependentHash) => {\n      const newDegree = inDegree.get(dependentHash)! - 1\n      inDegree.set(dependentHash, newDegree)\n\n      if (newDegree === 0) {\n        queue.push(dependentHash)\n      }\n    })\n  }\n\n  if (sorted.length !== items.length) {\n    console.warn(\"Circular dependency detected in registry items\")\n    // Return all items even if there are circular dependencies\n    // Items not in sorted are part of circular dependencies\n    const sortedHashes = new Set(\n      sorted.map((item) => {\n        const source = sourceMap.get(item) || item.name\n        return computeItemHash(item, source)\n      })\n    )\n\n    items.forEach((item) => {\n      const source = sourceMap.get(item) || item.name\n      const hash = computeItemHash(item, source)\n      if (!sortedHashes.has(hash)) {\n        sorted.push(item)\n      }\n    })\n  }\n\n  return sorted\n}\n","import { RegistryError } from \"@/src/registry/errors\"\nimport { highlighter } from \"@/src/utils/highlighter\"\nimport { logger } from \"@/src/utils/logger\"\nimport { z } from \"zod\"\n\nexport function handleError(error: unknown) {\n  logger.break()\n  logger.error(\n    `Something went wrong. Please check the error below for more details.`\n  )\n  logger.error(`If the problem persists, please open an issue on GitHub.`)\n  logger.error(\"\")\n  if (typeof error === \"string\") {\n    logger.error(error)\n    logger.break()\n    process.exit(1)\n  }\n\n  if (error instanceof RegistryError) {\n    if (error.message) {\n      logger.error(error.cause ? \"Error:\" : \"Message:\")\n      logger.error(error.message)\n    }\n\n    if (error.cause) {\n      logger.error(\"\\nMessage:\")\n      logger.error(error.cause)\n    }\n\n    if (error.suggestion) {\n      logger.error(\"\\nSuggestion:\")\n      logger.error(error.suggestion)\n    }\n    logger.break()\n    process.exit(1)\n  }\n\n  if (error instanceof z.ZodError) {\n    logger.error(\"Validation failed:\")\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\n      logger.error(`- ${highlighter.info(key)}: ${value}`)\n    }\n    logger.break()\n    process.exit(1)\n  }\n\n  if (error instanceof Error) {\n    logger.error(error.message)\n    logger.break()\n    process.exit(1)\n  }\n\n  logger.break()\n  process.exit(1)\n}\n","import path from \"path\"\nimport { buildUrlAndHeadersForRegistryItem } from \"@/src/registry/builder\"\nimport { configWithDefaults } from \"@/src/registry/config\"\nimport {\n  BASE_COLORS,\n  BUILTIN_REGISTRIES,\n  REGISTRY_URL,\n} from \"@/src/registry/constants\"\nimport {\n  clearRegistryContext,\n  setRegistryHeaders,\n} from \"@/src/registry/context\"\nimport {\n  ConfigParseError,\n  RegistriesIndexParseError,\n  RegistryInvalidNamespaceError,\n  RegistryNotFoundError,\n  RegistryParseError,\n} from \"@/src/registry/errors\"\nimport { fetchRegistry } from \"@/src/registry/fetcher\"\nimport {\n  fetchRegistryItems,\n  resolveRegistryTree,\n} from \"@/src/registry/resolver\"\nimport { isUrl } from \"@/src/registry/utils\"\nimport {\n  configJsonSchema,\n  iconsSchema,\n  registriesIndexSchema,\n  registriesSchema,\n  registryBaseColorSchema,\n  registryConfigSchema,\n  registryIndexSchema,\n  registryItemSchema,\n  registrySchema,\n  stylesSchema,\n} from \"@/src/schema\"\nimport { Config, explorer } from \"@/src/utils/get-config\"\nimport { handleError } from \"@/src/utils/handle-error\"\nimport { logger } from \"@/src/utils/logger\"\nimport { z } from \"zod\"\n\nexport async function getRegistry(\n  name: string,\n  options?: {\n    config?: Partial<Config>\n    useCache?: boolean\n  }\n) {\n  const { config, useCache } = options || {}\n\n  if (isUrl(name)) {\n    const [result] = await fetchRegistry([name], { useCache })\n    try {\n      return registrySchema.parse(result)\n    } catch (error) {\n      throw new RegistryParseError(name, error)\n    }\n  }\n\n  if (!name.startsWith(\"@\")) {\n    throw new RegistryInvalidNamespaceError(name)\n  }\n\n  let registryName = name\n  if (!registryName.endsWith(\"/registry\")) {\n    registryName = `${registryName}/registry`\n  }\n\n  const urlAndHeaders = buildUrlAndHeadersForRegistryItem(\n    registryName as `@${string}`,\n    configWithDefaults(config)\n  )\n\n  if (!urlAndHeaders?.url) {\n    throw new RegistryNotFoundError(registryName)\n  }\n\n  if (urlAndHeaders.headers && Object.keys(urlAndHeaders.headers).length > 0) {\n    setRegistryHeaders({\n      [urlAndHeaders.url]: urlAndHeaders.headers,\n    })\n  }\n\n  const [result] = await fetchRegistry([urlAndHeaders.url], { useCache })\n\n  try {\n    return registrySchema.parse(result)\n  } catch (error) {\n    throw new RegistryParseError(registryName, error)\n  }\n}\n\nexport async function getRegistryItems(\n  items: string[],\n  options?: {\n    config?: Partial<Config>\n    useCache?: boolean\n  }\n) {\n  const { config, useCache = false } = options || {}\n\n  clearRegistryContext()\n\n  return fetchRegistryItems(items, configWithDefaults(config), { useCache })\n}\n\nexport async function resolveRegistryItems(\n  items: string[],\n  options?: {\n    config?: Partial<Config>\n    useCache?: boolean\n  }\n) {\n  const { config, useCache = false } = options || {}\n\n  clearRegistryContext()\n  return resolveRegistryTree(items, configWithDefaults(config), { useCache })\n}\n\nexport async function getRegistriesConfig(\n  cwd: string,\n  options?: { useCache?: boolean }\n) {\n  const { useCache = true } = options || {}\n\n  // Clear cache if requested\n  if (!useCache) {\n    explorer.clearCaches()\n  }\n\n  const configResult = await explorer.search(cwd)\n\n  if (!configResult) {\n    // Do not throw an error if the config is missing.\n    // We still have access to the built-in registries.\n    return {\n      registries: BUILTIN_REGISTRIES,\n    }\n  }\n\n  // Parse just the registries field from the config\n  const registriesConfig = z\n    .object({\n      registries: registryConfigSchema.optional(),\n    })\n    .safeParse(configResult.config)\n\n  if (!registriesConfig.success) {\n    throw new ConfigParseError(cwd, registriesConfig.error)\n  }\n\n  // Merge built-in registries with user registries\n  return {\n    registries: {\n      ...BUILTIN_REGISTRIES,\n      ...(registriesConfig.data.registries || {}),\n    },\n  }\n}\n\nexport async function getShadcnRegistryIndex() {\n  try {\n    const [result] = await fetchRegistry([\"index.json\"])\n\n    return registryIndexSchema.parse(result)\n  } catch (error) {\n    logger.error(\"\\n\")\n    handleError(error)\n  }\n}\n\nexport async function getRegistryStyles() {\n  try {\n    const [result] = await fetchRegistry([\"styles/index.json\"])\n\n    return stylesSchema.parse(result)\n  } catch (error) {\n    logger.error(\"\\n\")\n    handleError(error)\n    return []\n  }\n}\n\nexport async function getRegistryIcons() {\n  try {\n    const [result] = await fetchRegistry([\"icons/index.json\"])\n    return iconsSchema.parse(result)\n  } catch (error) {\n    handleError(error)\n    return {}\n  }\n}\n\nexport async function getRegistryBaseColors() {\n  return BASE_COLORS\n}\n\nexport async function getRegistryBaseColor(baseColor: string) {\n  try {\n    const [result] = await fetchRegistry([`colors/${baseColor}.json`])\n\n    return registryBaseColorSchema.parse(result)\n  } catch (error) {\n    handleError(error)\n  }\n}\n\n/**\n * @deprecated This function is deprecated and will be removed in a future version.\n */\nexport async function resolveTree(\n  index: z.infer<typeof registryIndexSchema>,\n  names: string[]\n) {\n  const tree: z.infer<typeof registryIndexSchema> = []\n\n  for (const name of names) {\n    const entry = index.find((entry) => entry.name === name)\n\n    if (!entry) {\n      continue\n    }\n\n    tree.push(entry)\n\n    if (entry.registryDependencies) {\n      const dependencies = await resolveTree(index, entry.registryDependencies)\n      tree.push(...dependencies)\n    }\n  }\n\n  return tree.filter(\n    (component, index, self) =>\n      self.findIndex((c) => c.name === component.name) === index\n  )\n}\n\n/**\n * @deprecated This function is deprecated and will be removed in a future version.\n */\nexport async function fetchTree(\n  style: string,\n  tree: z.infer<typeof registryIndexSchema>\n) {\n  try {\n    const paths = tree.map((item) => `styles/${style}/${item.name}.json`)\n    const results = await fetchRegistry(paths)\n    return results.map((result) => registryItemSchema.parse(result))\n  } catch (error) {\n    handleError(error)\n    return []\n  }\n}\n\n/**\n * @deprecated This function is deprecated and will be removed in a future version.\n */\nexport async function getItemTargetPath(\n  config: Config,\n  item: Pick<z.infer<typeof registryItemSchema>, \"type\">,\n  override?: string\n) {\n  if (override) {\n    return override\n  }\n\n  if (item.type === \"registry:ui\") {\n    return config.resolvedPaths.ui ?? config.resolvedPaths.components\n  }\n\n  const [parent, type] = item.type?.split(\":\") ?? []\n  if (!(parent in config.resolvedPaths)) {\n    return null\n  }\n\n  return path.join(\n    config.resolvedPaths[parent as keyof typeof config.resolvedPaths],\n    type\n  )\n}\n\n// Fetch registries with new schema (array of objects with name, homepage, url, featured).\nexport async function getRegistries(options?: { useCache?: boolean }) {\n  options = {\n    useCache: true,\n    ...options,\n  }\n\n  const url = `${REGISTRY_URL}/registries.json`\n  const [data] = await fetchRegistry([url], {\n    useCache: options.useCache,\n  })\n\n  try {\n    return registriesSchema.parse(data)\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      throw new RegistriesIndexParseError(error)\n    }\n\n    throw error\n  }\n}\n\n/**\n * @deprecated Use getRegistries() instead.\n */\nexport async function getRegistriesIndex(options?: { useCache?: boolean }) {\n  // Fetch new format and transform to old Record<string, string> for backward compatibility.\n  const registries = await getRegistries(options)\n  if (!registries) return null\n  return Object.fromEntries(registries.map((r) => [r.name, r.url])) as z.infer<\n    typeof registriesIndexSchema\n  >\n}\n\nexport async function getPresets(options?: { useCache?: boolean }) {\n  options = {\n    useCache: true,\n    ...options,\n  }\n\n  const url = `${REGISTRY_URL}/config.json`\n  const [data] = await fetchRegistry([url], {\n    useCache: options.useCache,\n  })\n\n  const result = configJsonSchema.parse(data)\n  return result.presets\n}\n\nexport async function getPreset(\n  name: string,\n  options?: { useCache?: boolean }\n) {\n  const presets = await getPresets(options)\n  return (\n    presets.find(\n      (preset) => preset.name.toLowerCase() === name.toLowerCase()\n    ) ?? null\n  )\n}\n","import { searchResultItemSchema, searchResultsSchema } from \"@/src/schema\"\nimport { Config } from \"@/src/utils/get-config\"\nimport fuzzysort from \"fuzzysort\"\nimport { z } from \"zod\"\n\nimport { getRegistry } from \"./api\"\n\nexport async function searchRegistries(\n  registries: string[],\n  options?: {\n    query?: string\n    limit?: number\n    offset?: number\n    config?: Partial<Config>\n    useCache?: boolean\n  }\n) {\n  const { query, limit, offset, config, useCache } = options || {}\n\n  let allItems: z.infer<typeof searchResultItemSchema>[] = []\n\n  for (const registry of registries) {\n    const registryData = await getRegistry(registry, { config, useCache })\n\n    const itemsWithRegistry = (registryData.items || []).map((item) => ({\n      name: item.name,\n      type: item.type,\n      description: item.description,\n      registry: registry,\n      addCommandArgument: buildRegistryItemNameFromRegistry(\n        item.name,\n        registry\n      ),\n    }))\n\n    allItems = allItems.concat(itemsWithRegistry)\n  }\n\n  if (query) {\n    allItems = searchItems(allItems, {\n      query,\n      limit: allItems.length,\n      keys: [\"name\", \"description\"],\n    }) as z.infer<typeof searchResultItemSchema>[]\n  }\n\n  const paginationOffset = offset || 0\n  const paginationLimit = limit || allItems.length\n  const totalItems = allItems.length\n\n  const result: z.infer<typeof searchResultsSchema> = {\n    pagination: {\n      total: totalItems,\n      offset: paginationOffset,\n      limit: paginationLimit,\n      hasMore: paginationOffset + paginationLimit < totalItems,\n    },\n    items: allItems.slice(paginationOffset, paginationOffset + paginationLimit),\n  }\n\n  return searchResultsSchema.parse(result)\n}\n\nconst searchableItemSchema = z\n  .object({\n    name: z.string(),\n    type: z.string().optional(),\n    description: z.string().optional(),\n    registry: z.string().optional(),\n    addCommandArgument: z.string().optional(),\n  })\n  .passthrough()\n\ntype SearchableItem = z.infer<typeof searchableItemSchema>\n\nfunction searchItems<\n  T extends {\n    name: string\n    type?: string\n    description?: string\n    addCommandArgument?: string\n    [key: string]: any\n  } = SearchableItem\n>(\n  items: T[],\n  options: {\n    query: string\n  } & Pick<Parameters<typeof fuzzysort.go>[2], \"keys\" | \"threshold\" | \"limit\">\n) {\n  options = {\n    limit: 100,\n    threshold: -10000,\n    ...options,\n  }\n\n  const searchResults = fuzzysort.go(options.query, items, {\n    keys: options.keys,\n    threshold: options.threshold,\n    limit: options.limit,\n  })\n\n  const results = searchResults.map((result) => result.obj)\n\n  return z.array(searchableItemSchema).parse(results)\n}\n\nfunction isUrl(string: string): boolean {\n  try {\n    new URL(string)\n    return true\n  } catch {\n    return false\n  }\n}\n\n// Builds the registry item name for the add command.\n// For namespaced registries, returns \"registry/item\".\n// For URL registries, replaces \"registry\" with the item name in the URL.\nexport function buildRegistryItemNameFromRegistry(\n  name: string,\n  registry: string\n) {\n  // If registry is not a URL, return namespace format.\n  if (!isUrl(registry)) {\n    return `${registry}/${name}`\n  }\n\n  // Find where the host part ends in the original string.\n  const protocolEnd = registry.indexOf(\"://\") + 3\n  const hostEnd = registry.indexOf(\"/\", protocolEnd)\n\n  if (hostEnd === -1) {\n    // No path, check for query params.\n    const queryStart = registry.indexOf(\"?\", protocolEnd)\n    if (queryStart !== -1) {\n      // Has query params but no path.\n      const beforeQuery = registry.substring(0, queryStart)\n      const queryAndAfter = registry.substring(queryStart)\n      // Replace \"registry\" with itemName in query params only.\n      const updatedQuery = queryAndAfter.replace(/\\bregistry\\b/g, name)\n      return beforeQuery + updatedQuery\n    }\n    // No path or query, return as is.\n    return registry\n  }\n\n  // Split at host boundary.\n  const hostPart = registry.substring(0, hostEnd)\n  const pathAndQuery = registry.substring(hostEnd)\n\n  // Find all occurrences of \"registry\" in path and query.\n  // Replace only the last occurrence in the path segment.\n  const pathEnd =\n    pathAndQuery.indexOf(\"?\") !== -1\n      ? pathAndQuery.indexOf(\"?\")\n      : pathAndQuery.length\n  const pathOnly = pathAndQuery.substring(0, pathEnd)\n  const queryAndAfter = pathAndQuery.substring(pathEnd)\n\n  // Replace the last occurrence of \"registry\" in the path.\n  const lastIndex = pathOnly.lastIndexOf(\"registry\")\n  let updatedPath = pathOnly\n  if (lastIndex !== -1) {\n    updatedPath =\n      pathOnly.substring(0, lastIndex) +\n      name +\n      pathOnly.substring(lastIndex + \"registry\".length)\n  }\n\n  // Replace all occurrences of \"registry\" in query params.\n  const updatedQuery = queryAndAfter.replace(/\\bregistry\\b/g, name)\n\n  return hostPart + updatedPath + updatedQuery\n}\n"]}